<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2024-2025/Adinolfi-Mathis/mon/temps-2.1/"><meta name="description" content="L&#39;objectif de ce MON est de pr√©senter comment j&#39;ai r√©alis√© un planning automatique via Google Sheets et App Script."><meta property="og:description" content="L&#39;objectif de ce MON est de pr√©senter comment j&#39;ai r√©alis√© un planning automatique via Google Sheets et App Script."><meta name="twitter:description" content="L&#39;objectif de ce MON est de pr√©senter comment j&#39;ai r√©alis√© un planning automatique via Google Sheets et App Script."><meta name="author" content="ADINOLFI Mathis"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, App Script, Google, Planning, Vert"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="Cr√©ation d&#39;un EDT automatique avec Sheet et Appscript"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Adinolfi-Mathis/mon/temps-2.1/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="Cr√©ation d&#39;un EDT automatique avec Sheet et Appscript"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Adinolfi-Mathis/mon/temps-2.1/"><title>Cr√©ation d&#39;un EDT automatique avec Sheet et Appscript</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">Cr√©ation d&#39;un EDT automatique avec Sheet et Appscript</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">App Script</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Google</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Planning</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Vert</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">ADINOLFI Mathis</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2024-2025</span></div></div><p class="mb-4 text-lg">L'objectif de ce MON est de pr√©senter comment j'ai r√©alis√© un planning automatique via Google Sheets et App Script.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2024-2025/Adinolfi-Mathis/">ADINOLFI Mathis</a><span class="px-1">/</span><a href="/promos/2024-2025/Adinolfi-Mathis/mon/">MON de ADINOLFI Mathis</a><span class="px-1">/</span><a href="/promos/2024-2025/Adinolfi-Mathis/mon/temps-2.1/">Cr√©ation d&#39;un EDT automatique avec Sheet et Appscript</a></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100 dark:border-emerald-800 dark:bg-emerald-950"><svg class="absolute w-6 h-6 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-emerald-500 dark:stroke-emerald-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Liens</b></p></div><div class="pl-8 mr-8"><ul><li><a href="https://docs.google.com/spreadsheets/d/1ZDfEpIXLgIXsJeGU5F7v9NztJjGoHtkYlqHFdQQd0kI/edit?usp=sharing">Google Sheet du projet</a></li></ul></div></div><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>‚åõ Horodatage</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><table><thead><tr><th>Date</th><th>Heures pass√©es</th><th>Indications</th></tr></thead><tbody><tr><td>Samedi 9/11</td><td>1H</td><td>Prise en main de App Script</td></tr><tr><td>Samedi 16/11</td><td>4H</td><td>Interface + App Script</td></tr><tr><td>Dimache 17/11</td><td>4H</td><td>App Script + D√©bogage</td></tr><tr><td>lundi 18/11</td><td>1H</td><td>R√©daction MON</td></tr><tr><td></td><td></td><td></td></tr><tr><td>Total</td><td>10H</td><td></td></tr></tbody></table></div></details></div><h2 id="%E2%9C%94%EF%B8%8F-objectifs-de-ce-mon" tabindex="-1"><a class="header-anchor" href="#%E2%9C%94%EF%B8%8F-objectifs-de-ce-mon"></a> ‚úîÔ∏è Objectifs de ce MON</h2><p>Lors de p√©riodes de r√©vision ou de p√©riodes charg√©es, j'ai l'habitude de r√©aliser un planning afin de mieux optimiser mon temps de travail. La r√©alisation de ce planning me prend du temps, c'est pourquoi j'ai essay√© d'automatiser cette t√¢che via les applications de Google afin de pouvoir directement impl√©menter le planning dans mon calendrier.</p><ul><li>[x] Cr√©er une interface permettant de plannifier mes devoirs.</li><li>[x] Automatiser la planification des t√¢ches simples.</li><li>[ ] Automatiser la planification des r√©visions selon la m√©thode des J.</li></ul><h2 id="%F0%9F%93%84-partie-1-%3A-cr%C3%A9ation-d'une-interface-sur-google-sheet" tabindex="-1"><a class="header-anchor" href="#%F0%9F%93%84-partie-1-%3A-cr%C3%A9ation-d'une-interface-sur-google-sheet"></a> üìÑ Partie 1 : Cr√©ation d'une interface sur Google Sheet</h2><p>Dans l'id√©e de pouvoir automatiser la planification d'√©v√©nements, il faut tout de m√™me avoir une interface permettant de d√©finir les caract√©ristiques de ces √©v√©nements. Selon moi, les caract√©ristiques d√©finissant une t√¢che sont :</p><ul><li>Le nom</li><li>Le nombre d'heures estim√©s</li><li>La date de d√©but</li><li>La date limite</li></ul><p>On met en forme cela sous forme de tableau et on obtient notre interface !</p><div style="text-align:center"><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Adinolfi-Mathis/mon/temps-2.1/Interface.PNG" width="800"><br><u>Image 1 : Interface Planning</u></div><h2 id="%F0%9F%92%BB-partie-2-%3A-automatisation-de-la-plannification-avec-app-script" tabindex="-1"><a class="header-anchor" href="#%F0%9F%92%BB-partie-2-%3A-automatisation-de-la-plannification-avec-app-script"></a> üíª Partie 2 : Automatisation de la plannification avec App Script</h2><p>Afin d'automatiser la cr√©ation de planning dans mon calendrier Google, j'ai utilis√© l'API de Google Calendar via App Script. J'ai d√©compos√© mon code en 9 fonctions :</p><ol><li><strong>Nbr_lignes</strong> : C'est une fonction tr√®s simple qui retourne la derni√®re ligne compl√®te dans mon interface.</li><li><strong>Nbr_heures_dispo</strong> : C'est une fonction qui trouve le nombre d'heures disponibles sur une plage donn√©e.</li><li><strong>Nbr_heure_dispo_jour</strong> : C'est une fonction qui prend en entr√©e un jour et retourne le nombre d'heures disponibles dans la journ√©e, une journ√©e √©tant de 8h √† 12h et de 14h √† 22h.</li><li><strong>Nbr_heure_dispo_intervale</strong> : C'est une fonction qui prend en entr√©e un jour de d√©part et le nombre de jours suivants, et retourne le nombre d'heures disponibles sur cette plage horaire.</li><li><strong>Trouve_creneau_jour</strong> : C'est une fonction qui prend en entr√©e un jour et retourne le premier cr√©neau de 4h de la journ√©e disponible.</li><li><strong>Test_taches_realisable</strong> : C'est un test qui prend en entr√©e une ligne de notre interface et v√©rifie si nous avons suffisamment de temps pour r√©aliser la t√¢che associ√©e.</li><li><strong>Plannifie_ligne</strong> : C'est une fonction qui prend une ligne de notre interface en entr√©e et la planifie dans le calendrier selon la r√®gle suivante : sur la plage de temps possible, on essaie de r√©partir le travail en blocs de 4h espac√©s au maximum entre eux.</li><li><strong>Plannifier</strong> : C'est une fonction qui parcourt toute la liste de notre interface, effectue les tests et planifie les t√¢ches planifiables.</li><li><strong>MAJ</strong> : C'est une fonction qui trie par ordre croissant de date limite (DL) et lance la fonction Plannifier.</li></ol><p>Une fois ces fonctions cod√©es, il ne reste plus qu'√† cr√©er un bouton qui ex√©cute la fonction MAJ lorsqu'on clique dessus. On lance et on obtient :</p><div style="text-align:center"><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Adinolfi-Mathis/mon/temps-2.1/Resultat.PNG" width="800"><br><u>Image 2 : R√©sultat dans Calendar</u></div><h2 id="%E2%9D%8C-difficult%C3%A9s-rencontr%C3%A9es" tabindex="-1"><a class="header-anchor" href="#%E2%9D%8C-difficult%C3%A9s-rencontr%C3%A9es"></a> ‚ùå Difficult√©s rencontr√©es</h2><p>Je n'ai pas r√©ussi √† r√©aliser l'ensemble des objectifs que je me suis fix√©s. En effet, je n'ai pas eu le temps de coder la fonction qui planifie les apprentissages selon la m√©thode des J. Plusieurs raisons expliquent cela :</p><ol><li>D√©couverte de App Script et du JavaScript : La phase de prise en main de cette plateforme n'a pas √©t√© imm√©diate. √âtant un grand habitu√© d'Excel et du VBA, j'ai √©t√© √©tonn√© de rencontrer certains bugs dus √† la fa√ßon dont est structur√© mon code, qui √©tait adapt√© pour VBA mais pas pour App Script.</li><li>Gros bug caus√© par une mauvaise gestion des autorisations qui m'a oblig√© √† reprendre tout mon code pour rien. :/</li><li></li></ol><p>Finalement, ce projet m'a permis de d√©couvrir le potentiel de Sheets par rapport √† Excel et d'explorer les diff√©rents outils propos√©s par Google.</p></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>