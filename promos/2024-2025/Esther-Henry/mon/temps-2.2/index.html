<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2024-2025/Esther-Henry/mon/temps-2.2/"><meta name="description" content="L‚Äôobjectif de ce MON est de se former au langage VBA, puis de s‚Äôexercer sur un cas simple de mise en forme de donn√©es."><meta property="og:description" content="L‚Äôobjectif de ce MON est de se former au langage VBA, puis de s‚Äôexercer sur un cas simple de mise en forme de donn√©es."><meta name="twitter:description" content="L‚Äôobjectif de ce MON est de se former au langage VBA, puis de s‚Äôexercer sur un cas simple de mise en forme de donn√©es."><meta name="author" content="Esther Henry"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, ‚Äúvert‚Äù, ‚ÄúVBA‚Äù"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="D√©couvrir les bases du VBA pour la mise en forme de donn√©es"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Esther-Henry/mon/temps-2.2/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="D√©couvrir les bases du VBA pour la mise en forme de donn√©es"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Esther-Henry/mon/temps-2.2/"><title>D√©couvrir les bases du VBA pour la mise en forme de donn√©es</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">D√©couvrir les bases du VBA pour la mise en forme de donn√©es</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">‚Äúvert‚Äù</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">‚ÄúVBA‚Äù</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Esther Henry</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2024-2025</span></div></div><p class="mb-4 text-lg">L‚Äôobjectif de ce MON est de se former au langage VBA, puis de s‚Äôexercer sur un cas simple de mise en forme de donn√©es.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2024-2025/Esther-Henry/">Esther Henry</a><span class="px-1">/</span><a href="/promos/2024-2025/Esther-Henry/mon/">MON de Esther Henry</a><span class="px-1">/</span><a href="/promos/2024-2025/Esther-Henry/mon/temps-2.2/">D√©couvrir les bases du VBA pour la mise en forme de donn√©es</a></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Pr√©requis</b></p></div><div class="pl-8 mr-8"><p>Aucun pr√©requis</p></div></div><h2 id="d%C3%A9couvrir-vba" tabindex="-1"><a class="header-anchor" href="#d%C3%A9couvrir-vba"></a> D√©couvrir VBA</h2><h3 id="contexte" tabindex="-1"><a class="header-anchor" href="#contexte"></a> Contexte</h3><p>Lors de mon pr√©c√©dent stage, afin d‚Äôoptimiser un outil de travail sur Excel, j‚Äôai d√ª cr√©er une macro. N'ayant aucune connaissance en VBA, je l‚Äôai r√©alis√©e en utilisant l‚Äôenregistrement automatique, ce qui complique la modification et la maintenance ult√©rieures.</p><p>Aussi, dans mes missions en alternance, je suis amen√©e √† traiter un fichier Excel de donn√©es assez complexe, et je suis convaincue qu‚Äô√† l‚Äôaide de macros simples, ce traitement pourrait se faire de mani√®re beaucoup plus performante.</p><p>J‚Äôaimerais donc apprendre les bases de VBA pour √™tre capable de cr√©er, par exemple, une macro simple permettant de modifier l‚Äôaffichage d‚Äôune page et/ou d‚Äôautomatiser des t√¢ches de mise en forme de donn√©es.</p><h3 id="cours-suivi" tabindex="-1"><a class="header-anchor" href="#cours-suivi"></a> Cours suivi</h3><p>En faisant le tour des diff√©rents MON d√©j√† existants sur le site de Do-It sur le sujet de VBA et des macros, et gr√¢ce aux retours de mes camarades sur les cours qu‚Äôils avaient suivis, j‚Äôai choisi de suivre le cours VBA de <strong>Excel Pratique</strong>, car c‚Äôest celui qui me paraissait le plus complet et le plus adapt√© √† mon mode d‚Äôapprentissage. En plus, j‚Äôavais d√©j√† suivi leur cours sur Excel et je savais qu‚Äôil √©tait bien expliqu√©, surtout pour les d√©butantes comme moi en VBA.</p><p>J‚Äôai alors suivi les 8 premiers modules de formation, en partie par manque de temps, car je voulais avoir le temps de pratiquer ce que j‚Äôavais appris, et parce que, dans un premier temps, je n‚Äôestime pas avoir besoin d‚Äôutiliser des forms. Je m‚Äôy formerai plus tard.</p><h3 id="retour-critique" tabindex="-1"><a class="header-anchor" href="#retour-critique"></a> Retour critique</h3><p>L√† o√π, dans mon MON 2.1, j‚Äôavais trouv√© le cours d‚ÄôExcel Pratique parfois un peu superficiel sur certaines notions (du moins √† mon niveau), j‚Äôai trouv√© que leur cours de VBA est vraiment complet et permet aux d√©butantes comme moi de bien comprendre les diff√©rents concepts et de les manipuler simplement sur de petits exemples.</p><p>Je recommande donc ce cours pour les personnes comme moi, n‚Äô√©tant pas des pros de l‚Äôinformatique, mais ma√Ætrisant d√©j√† bien les fondamentaux d‚ÄôExcel.</p><h2 id="s%E2%80%99entra%C3%AEner-sur-un-exemple-professionnalisant" tabindex="-1"><a class="header-anchor" href="#s%E2%80%99entra%C3%AEner-sur-un-exemple-professionnalisant"></a> S‚Äôentra√Æner sur un exemple professionnalisant</h2><h3 id="consignes" tabindex="-1"><a class="header-anchor" href="#consignes"></a> Consignes</h3><p>Mon objectif pour ce MON √©tait √† la fois de d√©couvrir les bases du VBA, mais aussi de pouvoir les appliquer √† un cas simple auquel j‚Äôai √©t√© plusieurs fois confront√©e dans le monde professionnel : j‚Äôaimerais savoir automatiser des t√¢ches afin de faciliter le traitement de certaines donn√©es sur Excel, notamment pour faire passer des donn√©es d‚Äôun logiciel √† un autre.</p><p>Cependant, dans l‚Äôoptique de pouvoir pr√©senter mon travail sur le site, je ne pouvais pas le faire sur des donn√©es r√©elles de mon entreprise. J‚Äôai alors choisi de demander √† ChatGPT de me fournir un exercice pratique via le prompt suivant :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/Prompt.png" alt="Prompt"></p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-orange-500 bg-orange-100 dark:border-orange-800 dark:bg-orange-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-orange-500 dark:stroke-orange-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Exercice</b></p></div><div class="pl-8 mr-8"><p><strong>Exercice : Mise en forme et traitement des donn√©es pour int√©gration inter-logiciels</strong></p><p><strong>Contexte :</strong> Vous travaillez dans une entreprise qui utilise deux logiciels diff√©rents pour g√©rer les ventes et les stocks. Chaque mois, vous recevez un fichier Excel brut contenant les donn√©es des ventes du mois pr√©c√©dent, qu'il faut pr√©parer pour l'importer dans le logiciel de gestion des stocks.</p><p><strong>Objectif :</strong> √âcrire un programme VBA pour automatiser le traitement des donn√©es brutes et produire un fichier final pr√™t √† √™tre import√©.</p><p><strong>Fichiers fournis :</strong></p><ul><li>Feuille &quot;Donn√©es Brutes&quot;</li><li>Feuille &quot;Produits&quot;</li></ul><p><strong>Consignes :</strong></p><p><strong>1. Cr√©ation d'un module VBA :</strong> Cr√©ez un programme VBA pour automatiser les √©tapes suivantes :</p><ul><li><p>Suppression des colonnes inutiles : Conservez uniquement les colonnes n√©cessaires : Date de commande, R√©f√©rence Produit, Quantit√©.</p></li><li><p>Validation des donn√©es : V√©rifiez que chaque &quot;R√©f√©rence Produit&quot; existe dans la feuille &quot;Produits&quot;. Supprimez les lignes contenant des r√©f√©rences produits non valides.</p></li><li><p>Mise en forme des dates : Convertissez toutes les dates au format JJ/MM/AAAA.</p></li><li><p>Ajout de colonnes calcul√©es : Ajoutez une colonne &quot;Cat√©gorie&quot; en r√©cup√©rant cette information depuis la feuille &quot;Produits&quot;.</p></li></ul><p><strong>2. Exportation des donn√©es :</strong> Une fois le traitement termin√© :</p><ul><li>Cr√©ez une nouvelle feuille &quot;Donn√©es Finales&quot; avec les donn√©es nettoy√©es.</li><li>Enregistrez cette feuille en tant que fichier CSV nomm√© Export_YYYYMM.csv, o√π YYYYMM correspond au mois et √† l'ann√©e des donn√©es.</li></ul><p><strong>3. Documentation :</strong></p><ul><li>Ajoutez des commentaires dans votre code pour expliquer chaque √©tape.</li><li>Fournissez un r√©sum√© dans la feuille &quot;Documentation&quot; d√©crivant le fonctionnement de votre programme.</li></ul></div></div><h3 id="r%C3%A9solution" tabindex="-1"><a class="header-anchor" href="#r%C3%A9solution"></a> R√©solution</h3><p>J‚Äôai r√©solu ce probl√®me par √©tapes :</p><h4 id="suppression-des-colonnes-inutiles-%3A" tabindex="-1"><a class="header-anchor" href="#suppression-des-colonnes-inutiles-%3A"></a> Suppression des colonnes inutiles :</h4><pre class="language-vba line-numbers"><code>

Sub effacer()

'S√©lection des colonnes √† supprimer
Columns("B").Clear
Columns("D:F").Clear
End Sub


</code></pre><p>On passe alors de :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/image001.png" alt="Image 1"></p><p>√Ä :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/image002.png" alt="Image 2"></p><pre class="language-vba line-numbers"><code>

Sub deplacer()

    ' Selectioner et deplacer les colonnes restantes pour les rassembler
    Columns("C").Cut Destination:=Columns("B")
    Columns("G").Cut Destination:=Columns("C")
End Sub


</code></pre><p>On passe alors √† :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/image003.png" alt="Image 3"></p><h4 id="validation-des-donn%C3%A9es-%3A" tabindex="-1"><a class="header-anchor" href="#validation-des-donn%C3%A9es-%3A"></a> Validation des donn√©es :</h4><p>On commence par effacer le contenu de chacune des lignes n'ayant pas une r√©f√©rence existante dans le r√©f√©rentiel produit :</p><pre class="language-vba line-numbers"><code>

Sub reference()

    'V√©rifier que chaque reference produit existe dans le referentiel
    Dim p As Integer, r As Integer
    Dim nbligne As Integer, nbref As Integer
    Dim exist As Boolean
    Dim wsBrutes As Worksheet
    Dim wsProduits As Worksheet

    ' D√©finir les feuilles
    Set wsBrutes = ThisWorkbook.Sheets("Donn√©es Brutes")
    Set wsProduits = Workbooks("Produits_100.xlsx").Sheets("Produits")

    ' Nombre de lignes
    nbligne = wsBrutes.Cells(wsBrutes.Rows.Count, 3).End(xlUp).Row
    nbref = wsProduits.Cells(wsProduits.Rows.Count, 1).End(xlUp).Row

    ' Boucle sur chaque ligne des donn√©es brutes
    For p = 2 To nbligne
    exist = False
        ' V√©rification dans le r√©f√©rentiel
        For r = 2 To nbref
            If wsBrutes.Cells(p, 3).Value = wsProduits.Cells(r, 1).Value Then
                exist = True
            Exit For
            End If
        Next r
        ' Si la r√©f√©rence n'existe pas : effacer le contenu de la ligne
        If Not exist Then
            wsBrutes.Rows(p).Clear        End If
    Next p

    ' Message de fin
    MsgBox "V√©rification termin√©e", vbInformation

End Sub


</code></pre><p>On passe alors √† :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/image004.png" alt="Image 4"></p><p>Puis on vient supprimer les lignes vides :</p><pre class="language-vba line-numbers"><code>

Sub reorganiser()

'V√©rifier que chaque reference produit existe dans le referentiel
    Dim p As Integer
    Dim nbligne As Integer
    Dim wsBrutes As Worksheet

    ' D√©finir les feuilles
    Set wsBrutes = ThisWorkbook.Sheets("Donn√©es Brutes")

    ' Nombre de lignes
    nbligne = wsBrutes.Cells(wsBrutes.Rows.Count, 3).End(xlUp).Row

    ' Parcourir les lignes de bas en haut
    For p = nbligne To 2 Step -1
        If wsBrutes.Cells(p, 1).Value = "" Then
            wsBrutes.Rows(p).Delete
        End If
    Next p


' Message de fin
    MsgBox "Lignes supprim√©es"
End Sub


</code></pre><p>Ce qui donne :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/image005.png" alt="Image 5"></p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Information</b></p></div><div class="pl-8 mr-8"><p>Ici, pour ne pas cr√©er de d√©calage en raison de la suppression des lignes, il est essentiel de commencer par la derni√®re ligne puis de remonter, d'o√π le ‚ÄúStep -1‚Äù dans la boucle For.</p></div></div><h4 id="mise-en-forme-des-dates-%3A" tabindex="-1"><a class="header-anchor" href="#mise-en-forme-des-dates-%3A"></a> Mise en forme des dates :</h4><pre class="language-vba line-numbers"><code>

Sub DateCorrecte()

Dim p As Integer
Dim nbligne As Integer

    Dim wsBrutes As Worksheet

    ' D√©finir les feuilles
    Set wsBrutes = ThisWorkbook.Sheets("Donn√©es Brutes")

    ' Nombre de lignes
    nbligne = wsBrutes.Cells(wsBrutes.Rows.Count, 3).End(xlUp).Row

    'Parcourir la colonne A
    For p = 2 To nbligne
        wsBrutes.Cells(p, 1).Value = Format(wsBrutes.Cells(p, 1).Value, "dd/mm/yyyy")
    Next p

' Message de fin
    MsgBox "Date corrig√©es"
End Sub


</code></pre><p>On passe alors √† :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/image006.png" alt="Image 6"></p><h4 id="ajout-de-colonnes-calcul%C3%A9es-%3A" tabindex="-1"><a class="header-anchor" href="#ajout-de-colonnes-calcul%C3%A9es-%3A"></a> Ajout de colonnes calcul√©es :</h4><pre class="language-vba line-numbers"><code>

Sub AjoutCategories()

    'V√©rifier que chaque reference produit existe dans le referentiel
    Dim p As Integer, r As Integer
    Dim dernierbrut As Long, dernierproduit As Long
    Dim trouve As Boolean
    Dim wsBrutes As Worksheet
    Dim wsProduits As Worksheet

    ' D√©finir les feuilles
    Set wsBrutes = ThisWorkbook.Sheets("Donn√©es Brutes")
    Set wsProduits = Workbooks("Produits_100.xlsx").Sheets("Produits")


    ' Derni√®res lignes dans les deux feuilles
    dernierBrutes = wsBrutes.Cells(wsBrutes.Rows.Count, 3).End(xlUp).Row
    dernierProduits = wsProduits.Cells(wsProduits.Rows.Count, 1).End(xlUp).Row

    ' Ajouter un en-t√™te Cat√©gorie dans la feuille Donn√©es Brutes
    wsBrutes.Cells(1, 4).Value = "Cat√©gorie"

    ' Parcourir chaque r√©f√©rence produit
    For i = 2 To dernierBrutes
    refProduit = wsBrutes.Cells(i, 3).Value
      categorieTrouvee = False
    ' Chercher la cat√©gorie correspondante dans "Produits"
        For j = 2 To dernierProduits

            If wsProduits.Cells(j, 1).Value = refProduit Then
                wsBrutes.Cells(i, 4).Value = wsProduits.Cells(j, 3).Value
                categorieTrouvee = True
                Exit For
            End If
        Next j

        ' G√©rer les cas o√π la cat√©gorie n'existe pas
        If Not categorieTrouvee Then
            wsBrutes.Cells(i, 4).Value = "Inconnue"
        End If
    Next i
' Message de confirmation
MsgBox "Colonne 'Cat√©gorie' ajout√©e avec succ√®s", vbInformation
End Sub


</code></pre><p>On passe alors au r√©sultat final :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Esther-Henry/mon/temps-2.2/images/image007.png" alt="Image 7"></p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Information</b></p></div><div class="pl-8 mr-8"><p>Autant VBA permet d'automatiser pas mal d'op√©rations, mais je pense qu'ici une rechercheV (qu'on aurait pu enregistrer √† la main) aurait s√ªrement √©t√© plus efficace. Le r√©sultat est le m√™me, mais coder en VBA est assez complexe pour une fonction d√©j√† existante sur Excel.</p></div></div><h3 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"></a> Conclusion</h3><p>Je suis contente d‚Äôavoir pu apprendre √† coder en VBA et de m‚Äô√™tre exerc√©e sur un exemple simple mais assez <strong>concret</strong> et similaire √† ce pour quoi VBA pourrait √™tre utile dans ma vie professionnelle.</p><p>J‚Äôai pu balayer les <strong>concepts principaux</strong> et les pratiquer, m√™me si je suis bien consciente qu'il y aurait moyen de rendre cela plus efficace (par exemple, en imbriquant les fonctions pour tout faire en une seule √©tape). Cependant, je suis maintenant <strong>capable d‚Äô√©crire quelques lignes de VBA pour automatiser des t√¢ches r√©p√©titives</strong> du quotidien et surtout de pouvoir maintenir ces programmes en cas de changement de donn√©es.</p><h3 id="horodatage" tabindex="-1"><a class="header-anchor" href="#horodatage"></a> Horodatage</h3><table><thead><tr><th>Date</th><th>Heures pass√©es</th><th>Indications</th></tr></thead><tbody><tr><td>Samedi 30/11</td><td>0h20</td><td>Introduction</td></tr><tr><td>Samedi 30/11</td><td>1h</td><td>Les feuilles et les cellules</td></tr><tr><td>Samedi 30/11</td><td>0h40</td><td>Les variables</td></tr><tr><td>Samedi 30/11</td><td>1h</td><td>Les conditions</td></tr><tr><td>Samedi 30/11</td><td>1h</td><td>Les boucles</td></tr><tr><td>Samedi 30/11</td><td>1h</td><td>Proc√©dures et Fonctions</td></tr><tr><td>Samedi 30/11</td><td>0h30</td><td>MsgBox</td></tr><tr><td>Samedi 30/11</td><td>0h30</td><td>Les √©v√©nements</td></tr><tr><td>Dimanche 01/12</td><td>2h</td><td>Cr√©ation exercice &amp; d√©but r√©solution</td></tr><tr><td>Jeudi 12/12</td><td>2h</td><td>Fin exercice</td></tr></tbody></table><h3 id="bibliographie" tabindex="-1"><a class="header-anchor" href="#bibliographie"></a> Bibliographie</h3><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100 dark:border-emerald-800 dark:bg-emerald-950"><svg class="absolute w-6 h-6 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-emerald-500 dark:stroke-emerald-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Liens</b></p></div><div class="pl-8 mr-8"><p><a href="https://excel-pratique.com/fr/vba">Cours VBA Excel Pratique</a></p></div></div></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>