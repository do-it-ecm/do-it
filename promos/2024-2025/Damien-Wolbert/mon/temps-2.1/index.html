<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-2.1/"><meta name="description" content="L&#39;objectif de ce MON est d&#39;√©tudier les possibilit√©s apport√©es par les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes, pour la maitrise d&#39;Excel. Ces possibilit√©s seront √©tudi√©es par le prisme de leur accessibilit√©."><meta property="og:description" content="L&#39;objectif de ce MON est d&#39;√©tudier les possibilit√©s apport√©es par les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes, pour la maitrise d&#39;Excel. Ces possibilit√©s seront √©tudi√©es par le prisme de leur accessibilit√©."><meta name="twitter:description" content="L&#39;objectif de ce MON est d&#39;√©tudier les possibilit√©s apport√©es par les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes, pour la maitrise d&#39;Excel. Ces possibilit√©s seront √©tudi√©es par le prisme de leur accessibilit√©."><meta name="author" content="Damien WOLBERT"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="Peut-on monter rapidement en comp√©tence sur Excel avec : les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes ?"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-2.1/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="Peut-on monter rapidement en comp√©tence sur Excel avec : les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes ?"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-2.1/"><title>Peut-on monter rapidement en comp√©tence sur Excel avec : les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes ?</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">Peut-on monter rapidement en comp√©tence sur Excel avec : les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes ?</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tag :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Damien WOLBERT</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2024-2025</span></div></div><p class="mb-4 text-lg">L'objectif de ce MON est d'√©tudier les possibilit√©s apport√©es par les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes, pour la maitrise d'Excel. Ces possibilit√©s seront √©tudi√©es par le prisme de leur accessibilit√©.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2024-2025/Damien-Wolbert/">Damien WOLBERT</a><span class="px-1">/</span><a href="/promos/2024-2025/Damien-Wolbert/mon/">MON de Damien WOLBERT</a><span class="px-1">/</span><a href="/promos/2024-2025/Damien-Wolbert/mon/temps-2.1/">Peut-on monter rapidement en comp√©tence sur Excel avec : les requ√™tes relationnelles, les op√©rations sur les strings et les listes d√©roulantes ?</a></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Pr√©requis</b></p></div><div class="pl-8 mr-8"><ul><li>VBA : niveau interm√©diaire</li><li>Excel : niveau interm√©diaire</li></ul></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100 dark:border-emerald-800 dark:bg-emerald-950"><svg class="absolute w-6 h-6 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-emerald-500 dark:stroke-emerald-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Liens</b></p></div><div class="pl-8 mr-8"><ul><li>Mathier, S√©bastien. ¬´ Cours VBA gratuit ¬ª. Excel-Pratique, <a href="https://excel-pratique.com/fr/vba">https://excel-pratique.com/fr/vba</a>.</li><li>Qu‚Äôest-ce que Power Query‚ÄØ? - Power Query. 24 janvier 2024, <a href="https://learn.microsoft.com/fr-fr/power-query/power-query-what-is-power-query">https://learn.microsoft.com/fr-fr/power-query/power-query-what-is-power-query</a>.</li><li><em>Power Query : C'est Quoi et Pourquoi l'utiliser ?!</em>, YouTube. <a href="https://www.youtube.com/watch?v=NknyPRzER4k">https://www.youtube.com/watch?v=NknyPRzER4k</a></li><li>KathleenDollard. Fonctions de cha√Æne - Visual Basic. 2 juin 2023, <a href="https://learn.microsoft.com/fr-fr/dotnet/visual-basic/language-reference/functions/string-functions">https://learn.microsoft.com/fr-fr/dotnet/visual-basic/language-reference/functions/string-functions</a>.</li><li>¬´ VBA Regex ¬ª. Automate Excel, <a href="https://www.automateexcel.com/vba/regex/">https://www.automateexcel.com/vba/regex/</a>.</li></ul></div></div><h2 id="les-requ%C3%AAtes-relationnelles-sur-excel" tabindex="-1"><a class="header-anchor" href="#les-requ%C3%AAtes-relationnelles-sur-excel"></a> Les requ√™tes relationnelles sur Excel</h2><h3 id="objectif" tabindex="-1"><a class="header-anchor" href="#objectif"></a> Objectif</h3><p>Excel pouvant √™tre utilis√© pour stocker et/ou exploiter des bases de donn√©es, il int√©ressant de se demander s'il est possible d'utiliser facilement des requ√™tes relationnelles de type SQL. L'objectif de cette r√©flexion n'est pas de plonger dans chacune des solutions mais de faire un √©tat des lieux de leur accessibilit√©.</p><h3 id="des-possibilit%C3%A9s..." tabindex="-1"><a class="header-anchor" href="#des-possibilit%C3%A9s..."></a> Des possibilit√©s...</h3><p>Afin de lister les diff√©rentes possibilit√©s, j'ai utilis√© <strong>ChatGPT</strong> pour initier mes recherches. Apr√®s plusieurs essais non satisfaisants, j'ai aboutit √† des r√©sultats suffisamment diversifi√©s et pr√©cis gr√¢ce √† la requ√™te suivante : <em><strong>Liste moi les diff√©rentes possibilit√©s pour r√©aliser des requ√™tes relationnelles en excel en s√©parant les solutions passant par VBA et celles sans VBA. Sois exhaustif.</strong></em></p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Aide √† l'utilisation de ChatGPT</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><p>Trouver un requ√™te permettant d'obtenir un point de vue √† la fois large et d√©taill√© a n√©cessit√© des ajustements.</p><table><thead><tr><th>Requ√™te ChatGPT</th><th>Commentaire</th></tr></thead><tbody><tr><td>Comment utiliser SQL avec VBA ?</td><td>Question trop pr√©cise est orient√©e. Emp√™che d'explorer toutes les possibilit√©s. Omets toutes les solutions hors VBA et hors SQL</td></tr><tr><td>Comment utiliser des requ√™tes relationnelles en VBA ?</td><td>Question trop pr√©cise est orient√©e. Emp√™che d'explorer toutes les possibilit√©s. Omets toutes les solutions hors VBA.</td></tr><tr><td>Comment utiliser des requ√™tes relationnelles sur Excel ?</td><td>Question trop large pour obtenir des r√©sum√©s int√©ressants pour r√©aliser des recherches approfondies</td></tr><tr><td>Liste moi les diff√©rentes possibilit√©s pour r√©aliser des requ√™tes relationnelles en excel en s√©parant les solutions passant par VBA et celles sans VBA. Sois exhaustif.</td><td>Meilleure requ√™te r√©alis√©e : permet d'aborder un large pannel de solutions avec suffisamment d'informations pour r√©aliser des recherches par la suite.</td></tr></tbody></table><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Information</b></p></div><div class="pl-8 mr-8"><p>Afin que ChatGPT donne le panorama d'un sujet il faut √©viter de fermer le spectre en imposant certaines m√©thodes, tout en demandant clairement d'expliciter un grand nombre de possibilit√©s (<em>Ex : Sois exhuastif</em>).</p></div></div></div></details></div><p><strong>Deux approches de test des solutions :</strong></p><ol><li>Tests √† partir de la base de donn√©e <em>Base carbone¬Æ V23.4</em>, disponible sur le site de l'Ademe : <a href="https://www.data.gouv.fr/fr/datasets/base-carbone-r-2/">Base carbone</a>.</li><li>Rechercher des vid√©os ou programmes existants afin d'obtenir des exemples : YouTube et documentation Microsoft appuy√©e de ChatGPT pour maximiser la compr√©hension.</li></ol><table><thead><tr><th>Possibilit√©s</th><th>Type</th><th>Description</th><th>Tests</th><th>Avis</th></tr></thead><tbody><tr><td><strong>Power Query</strong></td><td>Manuel</td><td>Power Query permet de mettre en forme les donn√©es en cr√©ant et en automatisant des requ√™tes. Dans ce cas, chaque reque√™te correspond √† une nouvelle feuille Excel.</td><td>Cette <a href="https://www.youtube.com/watch?v=NknyPRzER4k">video</a> permet de comprendre la vraie utilit√© de Power Query, ajout√©e <a href="https://learn.microsoft.com/fr-fr/power-query/power-query-what-is-power-query">la documentation Microsoft</a></td><td><strong>Power Query n'est pas forc√©ment rapide de prise en main. Il est n√©cessaire de se plonger dans sa d√©couverte pour obtenir des r√©sultats satisfaisants.</strong></td></tr><tr><td><strong>Power Query + VBA</strong></td><td>Manuel et programmation</td><td>Il est possible de d'actualiser et d'affiner les requ√™tes avec VBA Power Query.</td><td>Documentation</td><td><strong>D'apr√®s <a href="https://datascientest.com/vba-et-power-query-tout-savoir">cette ressource</a>, on comprend que cette solution est limit√©e √† des requ√™tes simples. Ce qui peut √™tre fait directement en VBA.</strong></td></tr><tr><td><strong>Tableaux dynamiques</strong></td><td>Manuel et Programmation</td><td>Utiliser les outils de tableaux dynamiques d'Excel. Accessible √©galement depuis VBA.</td><td>Avec la <em>Base carbone¬Æ V23.4</em></td><td><strong>M√©thode pouvant √™tre limit√©e pour certaines requ√™tes, notamment celles ne faisant pas intervenir d'op√©ration particli√®res. Tr√®s utiles pour les requ√™tes de type <code>JOIN</code> pour calculer des sommes, moyennes, extrema etcs.. : les commandes sont alors tr√®s intuitives.</strong></td></tr><tr><td><strong>Filtres</strong></td><td>Manuel et Programmation</td><td>Utiliser les fonctions &quot;Filtrer&quot;, √©galement accessible en VBA</td><td>Avec la <em>Base carbone¬Æ V23.4</em></td><td><strong>Bon interm√©diaire entre le VBA et les tableaux dynamiques. Demande une attention particuli√®re concernant l'ordre d'application des filtres ainsi que la supression des filtres √† chaque op√©ration.</strong></td></tr><tr><td><strong>VBA + SQL : Microsoft ActiveX Data Objects Library (ADO)</strong></td><td>Programmation</td><td>Utiliser les fonctionnalit√©s de &quot;ADO&quot; pour pouvoir r√©diger des requ√™tes SQL directement depuis VBA</td><td>Demande d'exemples √† ChatGPT</td><td><strong>La mise en place de ce type de m√©thodes n'est pas facile. La r√©daction de fonctions VBA &quot;classiques&quot; est plus accessible tout demandant la r√©daction de codes de longueurs comparables.</strong></td></tr></tbody></table><h3 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"></a> Conclusion</h3><p>Diff√©rentes solutions permettent de r√©aliser des requ√™tes relationnelles via des lignes de code (avec ou sans VBA) ou en no/low-code (tableaux dynamiques, Power Query). Toutefois, les solutions de type &quot;code&quot; semblent pertinentes sur Excel d√®s lors qu'elles peuvent √™tre int√©gr√©es √† des Macros VBA. Or, ces derni√®res solutions n'apportent pas de plus-value particuli√®re comparativement √† l'√©criture de Macros classiques. <strong>Il semble plus judicieux de d√©penser de l'√©nergie √† l'installation et l'utilisation de logiciels adapt√©s aux requ√™tes relationnelles.</strong> <em>Exemples :</em> <em>SQLite pour utiliser SQL</em>, <em>Librairie pandas de python.</em></p><h2 id="les-listes-d%C3%A9roulantes-d%C3%A9pendantes" tabindex="-1"><a class="header-anchor" href="#les-listes-d%C3%A9roulantes-d%C3%A9pendantes"></a> Les listes d√©roulantes d√©pendantes</h2><h3 id="objectif-1" tabindex="-1"><a class="header-anchor" href="#objectif-1"></a> Objectif</h3><p>L'utilisation et la r√©alisation de documents complexes ou documents de suivi sur Excel engendre souvent le recours √† des listes d√©roulantes. Afin d'affiner leur utilisation, il est int√©ressant de se demander comment r√©aliser des listes d√©roulantes d√©pendantes.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>D√©finitions</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><p>Des listes d√©roulantes d√©pendantes sont des listes d√©roulantes dont les choix possibles d√©pendent d'une autre cellule comme le montre l'image suivante. On le consid√®re ici bas√©e sur un tableau de donn√©e source. <img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-2.1/Exemple%20listes.png" alt="Exemple listes"></p></div></details></div><h3 id="les-possibilit%C3%A9s" tabindex="-1"><a class="header-anchor" href="#les-possibilit%C3%A9s"></a> Les possibilit√©s</h3><p><strong>Id√©es initiales :</strong></p><table><thead><tr><th>Possibilit√©s</th><th>D√©tail</th><th>Inconv√©nient</th><th>Avantages</th></tr></thead><tbody><tr><td>R√©aliser des filtres dans des zones non visibles du tableur</td><td>Filtrer le tableau des donn√©es d'entr√©e et ce dans des cellules non utilis√©es (exemple : colonne GZ, soit la colonne num√©ro 208).</td><td>Peut alt√©rer l'utilisation d'une feuille de calcul en monopolisant des plages de donn√©es.</td><td>M√©thode dynamique permettant de changer le tableau source en int√©grant automatiqument les modification dans les menus d√©roulants sans modifier les cellules contenant ces derniers.</td></tr><tr><td>Utiliser une feuille &quot;Back-end&quot;</td><td>Utiliser une feuille interm√©diaire sur laquelle il serait possible de filtrer le tableau de donn√©es pour chacune des cellules int√©grant une liste d√©roulante.</td><td>Cr√©ation d'une nouvelle page</td><td>Idem</td></tr><tr><td>D√©finir des plages de donn√©es</td><td>Segmenter les diff√©rentes parties du tableau source afin de d√©finir les listes d√©roulantes √† partir de ces plages.</td><td>M√©thode non dynamique : il est n√©cessaire de lancer une modification des plages nomm√©es √† chaque ajout de donn√©es d'entr√©e.</td><td>N'ajoute pas de donn√©es ou de tableaux suppl√©mentaires (pas de feuilles de calcul suppl√©mentiares).</td></tr></tbody></table><p>La solution qui a √©t√© retenue est la <em>solution n¬∞2</em> : la complexit√© de sa programmation √©tant limit√©e et les inconv√©nients des autres solutions trop contraigants.</p><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Il a finalement √©t√© possible de masquer cette page. Le back-end augmente donc le nombre de feuilles et la taille du fichier mais ne pollue pas l'espace de travail de l'utilisateur.</p></div></div><h3 id="m%C3%A9thode-de-programmation" tabindex="-1"><a class="header-anchor" href="#m%C3%A9thode-de-programmation"></a> M√©thode de programmation</h3><p>L'√©l√©ment clef de cette m√©thode est le recours √† un back-end : Si deux cellules, <strong>A1</strong> et <strong>B1</strong> doivent acceuillir des listes d√©roulantes et que la liste de B1 d√©pend de la valeur de A1, alors il faut positionner dans le back-end une version filtr√©e du tableau source en fonction de A1. Supposons que la plage sur laquelle se positionne ce dernier est appel√©e <strong>&quot;Tableau_source&quot;</strong> et que la plage de la premi√®re colonne est nomm√©e <strong>&quot;Categorie&quot;</strong>. Ainsi, dans <strong>une cellule judicieusement choisie du back-end</strong> on tape la commande suivante :</p><pre class="line-numbers"><code>

=FILTRE(Tableau_source;Categorie=A1)


</code></pre><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Attention</b></p></div><div class="pl-8 mr-8"><p>Afin de pouvoir r√©aliser ces t√¢ches automatiquement il faut savoir d√©finir la formule d'une cellule et prendre garde aux correspondances entre formules anglosaxones et fran√ßaise. Pour cela, la formule doit √™tre entr√©e en utilisant :</p><ul><li><code>.Formula2</code> au lieu de <code>.Formula</code></li><li>Le s√©parateur <code>,</code> et pas <code>;</code></li></ul></div></div><pre class="line-numbers"><code>

ligne = 2
colonne = 3
Worksheets("Back-end").Cells(ligne, colonne).Formula2 = FILTER(Tableau_source,Categorie=A1)


</code></pre><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Cellule judicieusement choisie ?</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><p>Pour bien utiliser le back-end :</p><ul><li>Choisir une cellule de num√©rotation en en-t√™te (<em>ex : A1</em>) : Permet de positionner les nouvelles it√©rations du programme.</li><li>La num√©rotation doit permettre de choisir une nouvelle colonne √† chaque it√©ration (incr√©mentation de 2 √† chaque it√©ration) :<ul><li><em>La fonction <code>FILTRE()</code> s'√©tend √† la verticale sur un nombre incertain de lignes en fonction des donn√©es d'entr√©e.</em></li></ul></li></ul></div></details></div><h3 id="conclusion-1" tabindex="-1"><a class="header-anchor" href="#conclusion-1"></a> Conclusion</h3><p>La m√©thode a √©t√© mise en place avec succ√®s comme visible dans le document suivant : <a href="./Listes%20d%C3%A9roulantes%20d%C3%A9pendantes.zip">Fichier excel de test √† t√©l√©charger</a>. Elle pourrait √™tre g√©n√©ralis√©e √† des listes d√©pendantes √† plus de deux niveaux en proc√©dant par r√©curence d'un niveau √† l'autre.</p><h2 id="op%C3%A9rations-sur-les-chaines-de-caract%C3%A8re-en-vba" tabindex="-1"><a class="header-anchor" href="#op%C3%A9rations-sur-les-chaines-de-caract%C3%A8re-en-vba"></a> Op√©rations sur les chaines de caract√®re en VBA</h2><h3 id="objectif-2" tabindex="-1"><a class="header-anchor" href="#objectif-2"></a> Objectif</h3><p>Identifier la structure d'une chaine de caract√®re peut se r√©v√©ler puissant pour analyser et/ou traiter des donn√©es. Demandons-nous comment peut-on traiter les chaines de caract√®re sur Excel : lecture, extraction, segmentation et expressions r√©guli√®res.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Exemple de cas d'utilisation</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><p>Lister, hi√©rarchiser et trier une base de donn√©e contenant les r√©f√©rences et descriptions de diff√©rentes normes de constructions industrilles de l'Afnor. Chaque norme poss√®de un identifiant d'une forme particuli√®re. La manipulation de cette base de donn√©es n√©cessite donc la d√©composition et comparaison des chaines de caract√®res des identifiants de normes.</p></div></details></div><h3 id="les-op%C3%A9rations-de-base" tabindex="-1"><a class="header-anchor" href="#les-op%C3%A9rations-de-base"></a> Les op√©rations de base</h3><p>Un certain nombre de m√©thodes et fonctions permettent de manipuler les chaines de carcat√®re en VBA. Les principales sont pr√©sent√©es et illustr√©es sur la page suivante : <a href="https://learn.microsoft.com/fr-fr/dotnet/visual-basic/language-reference/functions/string-functions">Lien utile</a></p><p>Parmis elles, voici un liste d'op√©rations int√©ressantes pouvant √™tres r√©alis√©es :</p><table><thead><tr><th>Fonction</th><th>Utilisation</th></tr></thead><tbody><tr><td>Format</td><td>Permet de mettre en forme une chaine de caract√®re. <em>Ex : Fomats de date, Format de nombres (s√©parateur des milliers, nombre de d√©cimales...)</em></td></tr><tr><td>InStr</td><td>Permet d'obtenir la position de la premi√®re occurence d'une chaine dans une autre.</td></tr><tr><td>Mid</td><td>Permet d'extraire une partie de chaine en utilisant une position de d√©but et de fin.</td></tr><tr><td>Trim</td><td>Permet d'avoir une copie de chaine de caract√®re sans espace de d√©but et de fin. <em>Fonction utile pour √©viter des erreurs lors de tests et comparaisons.</em></td></tr></tbody></table><h3 id="pour-aller-plus-loin-%3A-les-expressions-r%C3%A9guli%C3%A8res" tabindex="-1"><a class="header-anchor" href="#pour-aller-plus-loin-%3A-les-expressions-r%C3%A9guli%C3%A8res"></a> Pour aller plus loin : les expressions r√©guli√®res</h3><ul><li><strong>Plus-value :</strong> Industrialiser et s√©curiser les op√©rations sur les chaines de caract√®re.</li><li><strong>En VBA ? :</strong> Utiliser l'objet <strong>RegExp</strong> et ses trois m√©thodes principales : <em>Test</em> (recherche de correspondance de motif : True ou False), <em>Replace</em> (rempacement de motifs), <em>Execute</em> (renvoie les correspondances du motifs).</li></ul><p>Le site suivant d√©taille de fa√ßon synth√©tique le fonctionnement de RegExp : <a href="https://www.automateexcel.com/vba/regex/">Lien utile</a>. Il permet de :</p><ul><li>Se familiariser avec la syntaxe des expressions r√©guli√®res.</li><li>Configurer l'√©diteur VBA pour utiliser RegExp.</li><li>Se familiariser aux diff√©rentes m√©thodes de RegExp au travers d'exemples.</li></ul><h3 id="conclusion-2" tabindex="-1"><a class="header-anchor" href="#conclusion-2"></a> Conclusion</h3><p>VBA inclue un grand nombre de fonctions et m√©thodes permettant de r√©aliser rapidement de nombreuses op√©rations sur les chaines. Toutefois, dans un objectif *<em>d'automatisation et d'industrialisation</em> de certaines op√©rations, le recours aux expressions r√©guli√®re semble fournir une plus grande <em>robustesse</em>.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100 dark:border-yellow-800 dark:bg-yellow-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-yellow-500 dark:stroke-yellow-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Faire</b></p></div><div class="pl-8 mr-8"><p><strong>Exemple :</strong> <em>Un programme peut ne pas reconna√Ætre une chaine si certaines lettres sont en majuscule alors que cela n'√©tait pas pr√©vu. Bien que la m√©thode <code>UCase</code> permette de convertir une chaine en majuscule, le recours syst√©matique aux expressions r√©guli√®re semble plus facile d'automatisation.</em></p></div></div><h2 id="conclusions" tabindex="-1"><a class="header-anchor" href="#conclusions"></a> Conclusions</h2><ol><li>La mise en place de requ√™tes relationnelles sur Excel est possible mais n√©cessite du temps. Sans contrainte particuli√®re, il semble plus judicieux de se concentrer sur d'autres logiciels ou outils pour cela.</li><li>La mise en place de listes d√©roulantes d√©pendantes est facile et rapide. Le programme r√©alis√© dans ce MON est reproductible et peut √™tre copi√© d'un document √† l'autre.</li><li>Les chaines de caract√®re peuvent √™tres manipul√©es rapidement en VBA. En outre, l'utilisation des expressions r√©guli√®res peut permettre une plus grande robustesse des Macros r√©alis√©es.</li></ol></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>