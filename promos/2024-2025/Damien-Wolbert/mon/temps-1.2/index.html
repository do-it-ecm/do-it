<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="robots" content="index, follow">

        <link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">

        
        

        <meta name="description" content="Ce MON vise à à construire un socle de connaissances pour s&#39;initier à Google Appscript. De plus, il présente les similitudes entre ce langage et VBA, afin de pouvoir passer de l&#39;un à l&#39;autre pour les fonctionnalités principales.">
        <meta property="og:description" content="Ce MON vise à à construire un socle de connaissances pour s&#39;initier à Google Appscript. De plus, il présente les similitudes entre ce langage et VBA, afin de pouvoir passer de l&#39;un à l&#39;autre pour les fonctionnalités principales.">
        <meta name="twitter:description" content="Ce MON vise à à construire un socle de connaissances pour s&#39;initier à Google Appscript. De plus, il présente les similitudes entre ce langage et VBA, afin de pouvoir passer de l&#39;un à l&#39;autre pour les fonctionnalités principales.">

        
            <meta name="author" content="Damien WOLBERT">
        
        <meta name="keywords" content="do-it, centrale, centrale méditerranée, ecm, MON">

        <link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon">
        <link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png">
        <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png">

        <link href="/assets/stylesheets/main.css" rel="stylesheet">

        <meta property="og:title" content="Google AppScript et son cousin VBA">

        <meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">
        <meta property="og:type" content="website">

        <meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta name="twitter:title" content="Google AppScript et son cousin VBA">
        <meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">

        <title>Google AppScript et son cousin VBA</title>

        <!-- Prismjs imports
                - Prism line numbers
                - Prism toolbar
        -->
        <link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
        <link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <!-- Mermaid import and initialization -->
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js "></script>

        <script defer="">
        // Check if a theme is stored in localStorage. If so, use it, otherwise fallback to the system preference.
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme) {
            document.documentElement.classList.toggle("dark", storedTheme === "dark");
        } else {
            // Use system color scheme if there is no stored theme preference.
            document.documentElement.classList.toggle("dark", window.matchMedia("(prefers-color-scheme: dark)").matches);
        }

        function loadPrismTheme(isDarkMode) {
            const newTheme = isDarkMode ? 'prism-okaidia.min.css' : 'prism-solarizedlight.min.css';
            const newLink = document.createElement('link');
            newLink.rel = 'stylesheet';
            newLink.id = 'prism-theme';
            newLink.href = `https://cdn.jsdelivr.net/npm/prismjs/themes/${newTheme}`;

            newLink.onload = () => {
                // Reapply highlighting after the new theme loads
                Prism.highlightAll();
            };

            const existingLink = document.getElementById('prism-theme');
            if (existingLink) {
                document.head.replaceChild(newLink, existingLink);
            } else {
                document.head.appendChild(newLink);
            }
        }

        function setMermaidTheme(isDarkMode) {
            const theme = isDarkMode ? 'dark' : 'forest';
            mermaid.initialize({
                securityLevel: 'loose',
                theme,
                startOnLoad: true,
            });
        }

        // Toggle dark and light mode and update localStorage accordingly.
        function toggleDarkMode() {
            const dark = document.documentElement.classList.contains("dark");
            const newTheme = dark ? "light" : "dark";
            localStorage.setItem('theme', newTheme);
            document.documentElement.classList.toggle("dark", !dark);
            loadPrismTheme(!dark);
            setMermaidTheme(!dark);
        }

        // On initial load, ensure that Prism and Mermaid are initialized using the current theme.
        const isDark = document.documentElement.classList.contains("dark");
        loadPrismTheme(isDark);
        setMermaidTheme(isDark);
        </script>

    </head>

    <body data-prismjs-copy="📋" data-prismjs-copy-error="❌" data-prismjs-copy-success="✅" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50">
        <header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-between items-center">
                    <a class="mx-2" href="/">Home</a>
                    <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current">
                            <circle cx="12" cy="12" r="5"></circle>
                            <path d="M12 2V4" stroke-linecap="round"></path>
                            <path d="M12 20V22" stroke-linecap="round"></path>
                            <path d="M4 12L2 12" stroke-linecap="round"></path>
                            <path d="M22 12L20 12" stroke-linecap="round"></path>
                            <path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path>
                            <path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path>
                            <path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path>
                            <path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path>
                        </svg>
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block">
                            <path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                    <div class="flex items-center gap-4 sm:gap-6 ">
                        <a class="" href="/cs">CS</a>
                        <a class="" href="/pok">POK</a>
                        <a class="" href="/mon">MON</a>
                        <a class="" href="/projets">Projets</a>
                        <a class="hidden sm:block" href="/promos">Promos</a>
                        <a href="/search">
                            <svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                            </svg>
                        </a>
                        <a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank">
                            <svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Google AppScript et son cousin VBA</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Tag : </div>
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li>
                

            </ul>

            
            <div class="hidden" data-pagefind-meta="Type" aria-hidden="true">
                
                    
                        <span data-pagefind-filter="Type">MON</span>
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteur : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Damien WOLBERT</li>
                
            </ul>
        </div>
    

    
        <div class="absolute top-0 right-0">
            <span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Année">
                2024-2025
            </span>
        </div>
    
</div>

<p class="mb-4 text-lg">Ce MON vise à à construire un socle de connaissances pour s'initier à Google Appscript. De plus, il présente les similitudes entre ce langage et VBA, afin de pouvoir passer de l'un à l'autre pour les fonctionnalités principales.</p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/promos/2024-2025/Damien-Wolbert/">Damien WOLBERT</a><span class="px-1">/</span><a href="/promos/2024-2025/Damien-Wolbert/mon/">MON de Damien WOLBERT</a><span class="px-1">/</span><a href="/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">Google AppScript et son cousin VBA</a>

</div>
</div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Prérequis</b></p>
</div><div class="pl-8 mr-8">
<ul>
<li>Connaissances des bases de VBA</li>
</ul>
</div>
</div>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100 dark:border-emerald-800 dark:bg-emerald-950">
<svg class="absolute w-6 h-6 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-emerald-500 dark:stroke-emerald-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Liens</b></p>
</div><div class="pl-8 mr-8">
<ul>
<li>Site pratique pour commencer en VBA : <a href="https://excel-pratique.com/fr/vba">https://excel-pratique.com/fr/vba</a></li>
<li>Site pratique pour commencer en AppScript : <a href="https://sheets-pratique.com/fr/apps-script">https://sheets-pratique.com/fr/apps-script</a></li>
</ul>
</div>
</div>
<h2 id="contexte" tabindex="-1"><a class="header-anchor" href="#contexte"></a> Contexte</h2>
<p>Ayant dû utiliser Google AppScript pour des projets personnels avant de réaliser ce MON, j'ai préféré ajouter une comparaison à VBA afin qu'il ait une plus-value supplémentaire pour moi et les prochains lecteurs.</p>
<h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"></a> Introduction</h2>
<p>Le langage Google Appscript permet de coder des programmes sur Google Drive et notamment Google Sheet. Il est pour Google Sheet ce que VBA est pour Excel. Toutefois, les syntaxes de ces deux langages sont assez différentes. Ce MON contient un ensemble d'éléments de base pour coder en AppScript ainsi qu'une comparaison avec des éléments de base de VBA.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Note</b></p>
</div><div class="pl-8 mr-8">
<p>ChatGPT peut s'avérer être un véritable allié pour apprendre à coder dans ces langages. Attention toutefois à vérifier tous les résultats proposés : en effet certains ne fonctionnent pas. Une partie de ce MON a été réalisé en s'appuyant sur ChatGPT.</p>
</div>
</div>
<h2 id="comment-utiliser-appscript-%3F" tabindex="-1"><a class="header-anchor" href="#comment-utiliser-appscript-%3F"></a> Comment utiliser AppScript ?</h2>
<h3 id="cr%C3%A9er-un-projet-appscript-depuis-gsheet" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9er-un-projet-appscript-depuis-gsheet"></a> Créer un projet AppScript depuis GSheet</h3>
<p>Pour créer un projet AppScript depuis un fichier GSheet, il suffit de cliquer sur le mneu &quot;Extension&quot; de la barre de tâche, puis sur &quot;Google AppScript&quot;. Une fenêtre s'ouvre avec un projet vierge.</p>
<ul>
<li>Nommer son projet</li>
<li>Nommer son premier fichier (par défaux appelé &quot;<a href="http://Code.gs">Code.gs</a>&quot;)</li>
<li>Créer une fonction de mise en route, par exemple une fonction affichant &quot;Hello World&quot; dans une cellule d'un tableau. Cela permettra de lancer les demandes d'autorisation pour l'accès aux données. Chaque utilisateur des différentes fonctions et programmes que vous créez doivent autoriser vos programmes à acceder à vos données.</li>
</ul>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><strong>ATTENTION !</strong></p>
</div><div class="pl-8 mr-8">
<p>Lorsque vous travaillez avec d'autres collaborateurs, chacun doit réaliser les tâches d'autorisation avant toute automatisation (Utilisation de programmes et/ou d'automatisation créées par d'autres personnes, lancements différés automatiques...).</p>
</div>
</div>
<h3 id="les-choses-%C3%A0-savoir" tabindex="-1"><a class="header-anchor" href="#les-choses-%C3%A0-savoir"></a> Les choses à savoir</h3>
<p>Google AppScript possède un certain nombre de défauts qui n'en sont plus lorsque nous savons qu'ils existent.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>L'enregistrement</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>L'enregistrement est réalisé soit manuellement, soit avant chaque lancement de programme. Il est réalisé sur l'ensemble du projet et indique les erreurs de syntaxe. Cela permet en effet de limiter le risque de perte mais pose un problème majeur : vous ne pouvez pas laisser une fonction en attente ! Si vous lancez un programme vous devez vous assurer que la synthaxe de l'entièreté de votre projet est correcte.
Ainsi, il est pratique <strong>d'enregistrer régulièrement son travail !</strong> et de convertir les blocs &quot;en attente&quot;, en commentaire.</p>
</div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Les droits d'accès</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>Comme évoqué précemment, tout utilisateur d'un nouveau programme doit d'abord autoriser ce dernier à s'exécuter. Pour se faire, il est intéressant de créer une fonction simple, permettant d'accéder ou de modifier la valeur d'une cellule du document GSheet (N'afficher qu'un message dans la boite de dialogue ne fonctionne par exemple pas).</p>
<pre class="line-numbers"><code>

function Hello_world() {
  // Le document actif possède une feuille dont le nom est "Feuille 2"
  feuille = SpreadsheetApp.getActive().getSheetByName("Feuille 2");

  // On inscrit "Hello World" dans la cellule A1 (première ligne, première colonne)
  feuille.getRange(1,1).setValue("Hello World");
}


</code></pre><p>Après avoir cliqué sur le bouton de lancement, un certain nombre de fenêtre vont se succéder.
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%201.png" alt="Autorisation 1">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%202.png" alt="Autorisation 2">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%203.png" alt="Autorisation 3">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%204.png" alt="Autorisation 4"></p>
</div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Les déclencheurs</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>Les déclencheurs permettent de lancer des programmes de manière différentes ou lors d'un évènement.
<strong>Types de déclencheurs :</strong></p>
<ul>
<li>Basé sur une feuille de calcul : Ouverture, modification (modification manuelle d'une cellule), changement (modifications structurelles ou par des programmes : nouvelle feuille, nouvelle colonne...), envoie d'un formulaire.</li>
<li>Horaires : date et heure précise, intervalles de temps (de la minute au mois).</li>
<li>Basé sur un agenda : A la modification d'un google agenda.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Menu%20d%C3%A9clencheurs.png" alt="Menu déclencheurs">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/R%C3%A9glage%20d%C3%A9clencheur.png" alt="Réglage déclencheur"></p>
</div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Journal d'exécution</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>Le journal d'exécution permet de tester ses fonctions et programmes plus facilement, sans avoir à afficher des boites de dialogues nécessitant une action utilisateur. Par exemple, fermer la boite de dialogue pour que le programme puisse continuer.
On utilise donc la commande <strong>console.log()</strong> pour faire appraraïtre des résultats dans le journal</p>
<pre class="line-numbers"><code>

console.log("7");
console.log("8");


</code></pre><p>Résultat :
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Journal_d_execution.png" alt="Journal d'exécution"></p>
</div>
</details>
</div>
<h2 id="syntaxes-appscript-et-vba" tabindex="-1"><a class="header-anchor" href="#syntaxes-appscript-et-vba"></a> Syntaxes AppScript et VBA</h2>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>En Appscript, chaque ligne doit être terminée par <strong>&quot;;&quot;</strong> !!!!</p>
</div>
</div>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Information</b></p>
</div><div class="pl-8 mr-8">
<p>Les commentaires se font :</p>
<ul>
<li><strong>En VBA :</strong> Avec <em><strong>'</strong></em></li>
<li><strong>En AppScript :</strong> Avec <em><strong>//</strong></em></li>
</ul>
</div>
</div>
<h3 id="donn%C3%A9es-de-r%C3%A9f%C3%A9rence-pour-comparaison" tabindex="-1"><a class="header-anchor" href="#donn%C3%A9es-de-r%C3%A9f%C3%A9rence-pour-comparaison"></a> Données de référence pour comparaison</h3>
<p>Considérons les données suivantes :</p>
<ul>
<li>Un fichier (Gsheet ou Excel) nommé &quot;Suivi&quot;</li>
<li>&quot;Suivi&quot; possède deux feuilles : &quot;Page de garde&quot; et &quot;KPI&quot; telles que suit :</li>
</ul>
<h3 id="variables" tabindex="-1"><a class="header-anchor" href="#variables"></a> Variables</h3>
<h4 id="d%C3%A9clarer-des-variables" tabindex="-1"><a class="header-anchor" href="#d%C3%A9clarer-des-variables"></a> Déclarer des variables</h4>
<p>En VBA ou en AppScript il n'est pas nécessaire de déclarer les variables que l'on utilise. Cela reste tout de même une bonne pratique pour ne pas avoir de problème entre variables locales et variables globales.
<strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

Sub test()

'Déclarer avec le type
Dim a As Integer
a = 7
'Déclarer sans le type
Dim b
b = 10
'Affecter directement une valeur
c = 12

End Sub


</code></pre><p><strong>En Appscript :</strong></p>
<pre class="line-numbers"><code>

function Variables() {
  // Déclarer et affectercer
  var a = 7;
  // Ne pas déclarer
  b = 8;
}


</code></pre><h4 id="types-principaux-et-fonctions-de-conversion" tabindex="-1"><a class="header-anchor" href="#types-principaux-et-fonctions-de-conversion"></a> Types principaux et fonctions de conversion</h4>
<p><strong>En Appscript :</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Conversion</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number</td>
<td>Nombres entiers et flottants</td>
<td>Fonction <strong>Number()</strong>, s'applique aux chaines de caractères et aux booléens</td>
</tr>
<tr>
<td>String</td>
<td>Chaine de caractère</td>
<td>Méthode <strong>.toString()</strong></td>
</tr>
<tr>
<td>Boolean</td>
<td>Valeur booléenne : <strong>true</strong> ou <strong>false</strong></td>
<td>Fonction <strong>Boolean()</strong>. Renvoie true pour toute chaine de caractère autre que la chaine vide &quot;&quot; et pour tout Number autre que 0</td>
</tr>
<tr>
<td>Array</td>
<td>Tableaux</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>En VBA :</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Conversion</th>
</tr>
</thead>
<tbody>
<tr>
<td>Integer</td>
<td>Entiers entre -32 768 et 32 767</td>
<td>Fonction <strong>CInt()</strong></td>
</tr>
<tr>
<td>Long</td>
<td>Entiers entre -2 147 483 648 et 2 147 483 647</td>
<td>Fonction <strong>CLng</strong></td>
</tr>
<tr>
<td>Double</td>
<td>Nombres décimaux</td>
<td>Fonction <strong>CDbl()</strong></td>
</tr>
<tr>
<td>String</td>
<td>Chaines de caractère</td>
<td>Fonction <strong>CStr()</strong></td>
</tr>
<tr>
<td>Boolean</td>
<td>Valeur booléenne : <strong>True</strong> ou <strong>False</strong></td>
<td>Fonction <strong>CBool()</strong></td>
</tr>
</tbody>
</table>
<h3 id="op%C3%A9rateurs-logiques-et-conditions" tabindex="-1"><a class="header-anchor" href="#op%C3%A9rateurs-logiques-et-conditions"></a> Opérateurs logiques et conditions</h3>
<p>Supposons que nous voulons tester la valeur d'une variable : si elle est supérieure à 5, on lui ajoute 10 ; si elle est égale à 2, on lui attribue  0 ; sinon, on lui ajoute 5.</p>
<p><strong>En Appscript :</strong></p>
<pre class="line-numbers"><code>

let a = 2;
if(a >= 10){
  a = a + 10;
} else if(a == 2){
  a=0;
} else {
  a = a + 5;
}


</code></pre><p><strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

a = 2
If a >= 10 Then
    a = a + 10
ElseIf a = 2 Then
    a = 0
Else
    a = a + 5
End If


</code></pre><h3 id="boucles" tabindex="-1"><a class="header-anchor" href="#boucles"></a> Boucles</h3>
<h4 id="boucle-while" tabindex="-1"><a class="header-anchor" href="#boucle-while"></a> Boucle while</h4>
<p>Suppossons que nous voulons connaitre le premier élément de la suite de Fibonacci supérieur à 8, ainsi que son rang dans la suite.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Rappel sur la suite de Fibonacci</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>D'après Wikipédia :
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Suite%20de%20Fibonacci.png" alt="Suite de Fibonacci"></p>
</div>
</details>
</div>
<p><strong>En Appscript :</strong></p>
<pre class="line-numbers"><code>

rang = 1;
seuil = 95;

f0 = 0;
transi = 0;
f1 = 1;

while(f1<seuil){ rang="" +="1;" transi="f1;" f1="f1" f0;="" f0="transi;" <="" code=""></seuil){></code></pre><p><strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

rang = 1
seuil = 95

f0 = 0
transi = 0
f1 = 1

While f1 < seuil
    rang = rang + 1
    transi = f1
    f1 = f1 + f0
    f0 = transi
Wend

MsgBox (rang)
MsgBox (f1)


</code></pre><h4 id="boucle-for" tabindex="-1"><a class="header-anchor" href="#boucle-for"></a> Boucle for</h4>
<p>Reprenons l'exemple de la suite de Fibonacci, cette fois-ci, nous voulons créer une liste avec les n premiers éléments de la suite.</p>
<p><strong>En AppScript :</strong></p>
<pre class="line-numbers"><code>

  rang = 50;
  f0 = 0;
  transi = 0;
  f1 = 1;
  liste = [f0,f1];

  for(let i=2;i<=rang-2;i++){
    transi = f1;
    f1 = f1 + f0;
    f0 = transi;
    liste.push(f1);
  }


</code></pre><p><strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

rang = 50
f0 = 0
transi = 0
f1 = 1
Set liste = New Collection

For i = 2 To rang - 2
    transi = f1
    f1 = f1 + f0
    f0 = transi
    liste.Add f1
Next


</code></pre><h3 id="les-listes" tabindex="-1"><a class="header-anchor" href="#les-listes"></a> Les listes</h3>
<h4 id="doit-on-r%C3%A9ellement-utiliser-des-listes-%3F-l'utilit%C3%A9-d'un-%22back-end%22" tabindex="-1"><a class="header-anchor" href="#doit-on-r%C3%A9ellement-utiliser-des-listes-%3F-l'utilit%C3%A9-d'un-%22back-end%22"></a> Doit-on réellement utiliser des listes ? L'utilité d'un &quot;back-end&quot;</h4>
<p>AppScript et VBA sont souvent utilisés pour intéragir avec des tableurs. Il est donc facile de stocker des valeurs dans un de ces tableaux.
Lorsque des listes sont utilisées de manière récurrente pour l'exécution d'un programme, il peut être interessant de créer une feuille de calcul annexe permettant de stocker et d'accéder à différentes données. J'ai pour habitude de nommer cette feuille <strong>Back-end</strong>.</p>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>En VBA, l'utilisation de listes ou de tableaux n'est pas facile, voire ineffcicace.</p>
</div>
</div>
<h4 id="op%C3%A9rations-sur-les-listes" tabindex="-1"><a class="header-anchor" href="#op%C3%A9rations-sur-les-listes"></a> Opérations sur les listes</h4>
<h5 id="%C2%A4-cr%C3%A9er-une-liste" tabindex="-1"><a class="header-anchor" href="#%C2%A4-cr%C3%A9er-une-liste"></a> ¤ Créer une liste</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

liste = []; // Création d'une liste vide
liste = ["a","b","c","d","e"]


</code></pre><p><em><strong>En VBA :</strong></em>
En VBA, il est possible d'utiliser des tableaux, des collections, des Arraylist, des dictionnaires... La structure la plus simple d'utilisation est la collection.</p>
<pre class="line-numbers"><code>

Dim liste = New Collection 'Création d'une liste vide
liste.Add "a"
liste.Add "b"
liste.Add "c"
liste.Add "d"
liste.Add "e"


</code></pre><h5 id="%C2%A4-longueur-de-liste" tabindex="-1"><a class="header-anchor" href="#%C2%A4-longueur-de-liste"></a> ¤ Longueur de liste</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

Longueur = liste.length;


</code></pre><p><em><strong>En VBA :</strong></em></p>
<pre class="line-numbers"><code>

Longueur = liste.Count


</code></pre><h5 id="%C2%A4-acc%C3%A9der-%C3%A0-des-%C3%A9l%C3%A9ments" tabindex="-1"><a class="header-anchor" href="#%C2%A4-acc%C3%A9der-%C3%A0-des-%C3%A9l%C3%A9ments"></a> ¤ Accéder à des éléments</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

premier = liste[0]; // Premier élément de la liste
dernier = liste[liste.length-1]; //Dernier élément de la liste
troisieme = liste[2]; // Troisème élément de la liste. LE RANG COMMENCE A 0 !!


</code></pre><p><em><strong>En VBA :</strong></em></p>
<pre class="line-numbers"><code>

premier = liste(1) // Premier élément de la liste
dernier = liste(liste.Count) // Dernier élément de la liste
troisième = liste(3) // Troisième élément de la liste. LE RANG COMMENCE A 1 !!


</code></pre><h5 id="%C2%A4-ajouter-et-supprimer-des-%C3%A9l%C3%A9ments" tabindex="-1"><a class="header-anchor" href="#%C2%A4-ajouter-et-supprimer-des-%C3%A9l%C3%A9ments"></a> ¤ Ajouter et supprimer des éléments</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

liste.push("x","y","z"); // Ajoute "x", "y" et "z" à la fin de la liste
liste.unshift("alpha"); // Ajoute "alpha" au début de la liste
position = 0;
nombre = 2;
liste.splice(position,nombre,"delta","mu"); // Permet de supprimer un certain nombre d'éléments à partir d'une position initiale et d'ajouter d'autres éléments à la place


</code></pre><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Méthode .splice()</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>La méthode <strong>.splice()</strong> permet de supprimer des éléments mais aussi de les ajouter à une certaine position à place d'un certain nombre d'autres.</p>
<pre class="line-numbers"><code>

liste = [1,2,3,4,5,6,7,8,9,10];
liste.splice(4,0,152,189,204); // 152, 189, 204 sont les valeurs insérée à la position 4
// liste est maintenant égale à [1, 2, 3, 4, 152, 189, 204, 5, 6, 7, 8, 9, 10]


</code></pre></div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Methode .filter()</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p><strong>.filter()</strong> permet de créer une liste fille en filtrant une liste mère.</p>
<pre class="line-numbers"><code>

liste=[1,2,3,4,5,6,7];
liste = liste.filter(nombre => nombre!=5); //liste est alors égale à [1,2,3,4,6,7]


</code></pre></div>
</details>
</div>
<p><em><strong>En VBA :</strong></em></p>
<pre class="line-numbers"><code>

liste.Add "z"


</code></pre><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>En VBA, on ne peut pas éliminer facilement un élément d'une Collection. Il faut utiliser une boucle pour créer une nouvelle collection dépourvue des éléments à supprimer.
Les <strong>ArrayList</strong> sont en cela plus simples d'utilisation mais il semble nécessaire d'importer des bibliothèsques spéciales pour cela.</p>
</div>
</div>
<h2 id="cr%C3%A9er-des-programmes-et-des-fonctions" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9er-des-programmes-et-des-fonctions"></a> Créer des programmes et des fonctions</h2>
<h3 id="appscript" tabindex="-1"><a class="header-anchor" href="#appscript"></a> AppScript</h3>
<p>Pour travailler en AppScript il est nécessaire d'utiliser des fonctions ou de définir les fonctions utilisées dans un fichier à part. En effet, il est possible d'écrire un programme sans fonction au sein d'un fichier. Cependant, lors de l'éxecution de celui-ci, toutes les fonction également définies sur le fichier seront exécutées.</p>
<p><strong>Pour définir des fonctions :</strong></p>
<pre class="line-numbers"><code>

function MaFonction(x,y){
  return()
}


</code></pre><ul>
<li>Notons qu'une fonction peut ne rien renvoyer et donc peu ne pas comporter de return().</li>
<li>Pour utiliser une fonction au sein d'une autre, il suffit de l'appliquer, la fonction sera notamment proposée après avoir tapé les premiers caractères de son nom.</li>
</ul>
<h3 id="vba" tabindex="-1"><a class="header-anchor" href="#vba"></a> VBA</h3>
<p>Pour travailler en VBA, il faut obliagtoirement travailler au sein d'un <strong>Sub</strong> dans lequel il sera possible d'appeler d'autres <strong>Sub</strong> ou d'autres <strong>fonctions</strong>.</p>
<pre class="line-numbers"><code>

Sub MonSub(argument)
argument = argument + 1
End Sub

'''''''''''''''''''''''''''''
Sub MonGrandSub()
x = 2
Call MonSub(x) // La fonction MonSub est appliquée à x, qui devient donc égal à 3
End Sub


</code></pre><p>Lorsque nous voulons utilser une fonction renvoyant quelque chose, il faut utiliser <strong>Function</strong></p>
<pre class="line-numbers"><code>

Function Ajouter_Deux(argument)
Ajouter_Deux = argument + 2
End Function


</code></pre><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>La valeur renvoyée par la fonction doit posséder le même nom que la fonction.</p>
</div>
</div>
<h2 id="les-fonctions-utiles-en-appscript" tabindex="-1"><a class="header-anchor" href="#les-fonctions-utiles-en-appscript"></a> Les fonctions utiles en AppScript</h2>
<p>Supposons que nous travaillons avec un document nommé &quot;Suivi&quot; et possédant deux feuilles : &quot;Page de garde&quot; et &quot;KPI&quot;.</p>
<h3 id="acc%C3%A9der-%C3%A0-des-fichiers-et-des-feuilles-de-calcul" tabindex="-1"><a class="header-anchor" href="#acc%C3%A9der-%C3%A0-des-fichiers-et-des-feuilles-de-calcul"></a> Accéder à des fichiers et des feuilles de calcul</h3>
<p>Pour pouvoir accéder à un document GSheet, plusieurs méthodes sont possibles :</p>
<pre class="line-numbers"><code>

Document = SpreadsheetApp.getActive(); // La variable Document permet maintenant de se référer au document GSheet ouvert.
DocumentBis = SpreadsheetApp.OpenByUrl("https://..."); // La variable DocumentBis permet de se référer au document dont on a donné l'url.

Feuille = Document.getSheetByName("KPI"); // La variable Feuille permet de se référer à la feuille "KPI" du document "Suivi".
FeuilleBis = Document.getActiveSheet(); // La variable FeuilleBis permet de se référer à la feuille active du document "Suivi".

Toutes_feuilles = Document.getSheets();


</code></pre><h3 id="acc%C3%A9der-ou-modifier-la-valeur-d'une-cellule" tabindex="-1"><a class="header-anchor" href="#acc%C3%A9der-ou-modifier-la-valeur-d'une-cellule"></a> Accéder ou modifier la valeur d'une cellule</h3>
<pre class="line-numbers"><code>

Feuille = SpreadsheetApp.getActive().getSheetByName("KPI");
valeur = Feuille.getRange(3,2).getValue(); // valeur est égale au contenue de la cellule positionnée à la 3ème ligne, 2ème colonne.
Feuille.getRange(3,2).setValue("Nom d'assurance"); // La cellule de la 3ème ligne, 2ème colonne est maintenant égale à "Nom d'assurance".


</code></pre><h3 id="derni%C3%A8re-ligne-ou-colonne-d'un-tableau" tabindex="-1"><a class="header-anchor" href="#derni%C3%A8re-ligne-ou-colonne-d'un-tableau"></a> Dernière ligne ou colonne d'un tableau</h3>
<p>Il est parfois intéressant de connaitre les dimensions d'un tableau afin de réaliser des boucles par exemple.</p>
<pre class="line-numbers"><code>

Feuille = SpreadsheetApp.getActive().getSheetByName("KPI");
derniere_ligne = Feuille.getLastRow();
derniere_colonne = Feuille.getLastColumn();


</code></pre><h3 id="nom-d'une-feuille" tabindex="-1"><a class="header-anchor" href="#nom-d'une-feuille"></a> Nom d'une feuille</h3>
<pre class="line-numbers"><code>

Feuille = SpreadsheetApp.getActive().getActiveSheet();
nom = Feuille.getName(); // Nom de la feuille active


</code></pre><h3 id="nombre-de-feuilles-du-classeur" tabindex="-1"><a class="header-anchor" href="#nombre-de-feuilles-du-classeur"></a> Nombre de feuilles du classeur</h3>
<pre class="line-numbers"><code>

Feuilles = SpreadsheetApp.getActive().getSheets();
Nbr = Feuilles.length;

Feuille = SpreadsheetApp.getActive().getActiveSheet();
numero = Feuilles.indexOf(Feuille);


</code></pre><div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Note</b></p>
</div><div class="pl-8 mr-8">
<p>Si l'index est <strong>-1</strong>, cela signifie que la feuille n'a pas été trouvée.</p>
</div>
</div>
<h3 id="sortir-d'une-boucle-ou-d'une-fonction" tabindex="-1"><a class="header-anchor" href="#sortir-d'une-boucle-ou-d'une-fonction"></a> Sortir d'une boucle ou d'une fonction</h3>
<ul>
<li>Afin de sortir d'une boucle, on utilise <strong>break</strong>.</li>
<li>Afin de sortir d'une fonction en cours, on utilise <strong>return</strong>.</li>
</ul>



</article>

        </main>

        <footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        ©2025 <b><span style="font-family: Consolas, sans-serif;">Do-<span style="color: #4a86e8">It</span></span></b> - Développement, Management et Gestion de projets en IT
                    </p>
                </div>
            </div>
        </footer>

        <!-- MathJax import and initialization -->
        <script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']], // Delimiters for inline math
                    displayMath: [['$$', '$$'], ['\\[', '\\]']] // Delimiters for block math
                },
                svg: {
                    fontCache: 'global' // Use global font cache for SVG output
                }
            };
            document.addEventListener('DOMContentLoaded', () => {
                MathJax.typeset(); // Ensures MathJax processes the content after the page loads
            });
        </script>

        <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">
            Prism.plugins.NormalizeWhitespace.setDefaults({
                'remove-trailing': true,
                'remove-indent': true,
                'left-trim': true,
                'right-trim': true,
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script>
    </body>
</html>
