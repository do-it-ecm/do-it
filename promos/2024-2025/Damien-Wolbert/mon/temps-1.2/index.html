<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="robots" content="index, follow">

        <link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">

        
        

        <meta name="description" content="Ce MON vise √† √† construire un socle de connaissances pour s&#39;initier √† Google Appscript. De plus, il pr√©sente les similitudes entre ce langage et VBA, afin de pouvoir passer de l&#39;un √† l&#39;autre pour les fonctionnalit√©s principales.">
        <meta property="og:description" content="Ce MON vise √† √† construire un socle de connaissances pour s&#39;initier √† Google Appscript. De plus, il pr√©sente les similitudes entre ce langage et VBA, afin de pouvoir passer de l&#39;un √† l&#39;autre pour les fonctionnalit√©s principales.">
        <meta name="twitter:description" content="Ce MON vise √† √† construire un socle de connaissances pour s&#39;initier √† Google Appscript. De plus, il pr√©sente les similitudes entre ce langage et VBA, afin de pouvoir passer de l&#39;un √† l&#39;autre pour les fonctionnalit√©s principales.">

        
            <meta name="author" content="Damien WOLBERT">
        
        <meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON">

        <link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon">
        <link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png">
        <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png">

        <link href="/assets/stylesheets/main.css" rel="stylesheet">

        <meta property="og:title" content="Google AppScript et son cousin VBA">

        <meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">
        <meta property="og:type" content="website">

        <meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta name="twitter:title" content="Google AppScript et son cousin VBA">
        <meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">

        <title>Google AppScript et son cousin VBA</title>

        <!-- Prismjs imports
                - Prism line numbers
                - Prism toolbar
        -->
        <link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
        <link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <!-- Mermaid import and initialization -->
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js "></script>

        <script defer="">
        // Check if a theme is stored in localStorage. If so, use it, otherwise fallback to the system preference.
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme) {
            document.documentElement.classList.toggle("dark", storedTheme === "dark");
        } else {
            // Use system color scheme if there is no stored theme preference.
            document.documentElement.classList.toggle("dark", window.matchMedia("(prefers-color-scheme: dark)").matches);
        }

        function loadPrismTheme(isDarkMode) {
            const newTheme = isDarkMode ? 'prism-okaidia.min.css' : 'prism-solarizedlight.min.css';
            const newLink = document.createElement('link');
            newLink.rel = 'stylesheet';
            newLink.id = 'prism-theme';
            newLink.href = `https://cdn.jsdelivr.net/npm/prismjs/themes/${newTheme}`;

            newLink.onload = () => {
                // Reapply highlighting after the new theme loads
                Prism.highlightAll();
            };

            const existingLink = document.getElementById('prism-theme');
            if (existingLink) {
                document.head.replaceChild(newLink, existingLink);
            } else {
                document.head.appendChild(newLink);
            }
        }

        function setMermaidTheme(isDarkMode) {
            const theme = isDarkMode ? 'dark' : 'forest';
            mermaid.initialize({
                securityLevel: 'loose',
                theme,
                startOnLoad: true,
            });
        }

        // Toggle dark and light mode and update localStorage accordingly.
        function toggleDarkMode() {
            const dark = document.documentElement.classList.contains("dark");
            const newTheme = dark ? "light" : "dark";
            localStorage.setItem('theme', newTheme);
            document.documentElement.classList.toggle("dark", !dark);
            loadPrismTheme(!dark);
            setMermaidTheme(!dark);
        }

        // On initial load, ensure that Prism and Mermaid are initialized using the current theme.
        const isDark = document.documentElement.classList.contains("dark");
        loadPrismTheme(isDark);
        setMermaidTheme(isDark);
        </script>

    </head>

    <body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50">
        <header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-between items-center">
                    <a class="mx-2" href="/">Home</a>
                    <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current">
                            <circle cx="12" cy="12" r="5"></circle>
                            <path d="M12 2V4" stroke-linecap="round"></path>
                            <path d="M12 20V22" stroke-linecap="round"></path>
                            <path d="M4 12L2 12" stroke-linecap="round"></path>
                            <path d="M22 12L20 12" stroke-linecap="round"></path>
                            <path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path>
                            <path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path>
                            <path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path>
                            <path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path>
                        </svg>
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block">
                            <path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                    <div class="flex items-center gap-4 sm:gap-6 ">
                        <a class="" href="/cs">CS</a>
                        <a class="" href="/pok">POK</a>
                        <a class="" href="/mon">MON</a>
                        <a class="" href="/projets">Projets</a>
                        <a class="hidden sm:block" href="/promos">Promos</a>
                        <a href="/search">
                            <svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                            </svg>
                        </a>
                        <a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank">
                            <svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Google AppScript et son cousin VBA</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Tag : </div>
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li>
                

            </ul>

            
            <div class="hidden" data-pagefind-meta="Type" aria-hidden="true">
                
                    
                        <span data-pagefind-filter="Type">MON</span>
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteur : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Damien WOLBERT</li>
                
            </ul>
        </div>
    

    
        <div class="absolute top-0 right-0">
            <span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">
                2024-2025
            </span>
        </div>
    
</div>

<p class="mb-4 text-lg">Ce MON vise √† √† construire un socle de connaissances pour s'initier √† Google Appscript. De plus, il pr√©sente les similitudes entre ce langage et VBA, afin de pouvoir passer de l'un √† l'autre pour les fonctionnalit√©s principales.</p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/promos/2024-2025/Damien-Wolbert/">Damien WOLBERT</a><span class="px-1">/</span><a href="/promos/2024-2025/Damien-Wolbert/mon/">MON de Damien WOLBERT</a><span class="px-1">/</span><a href="/promos/2024-2025/Damien-Wolbert/mon/temps-1.2/">Google AppScript et son cousin VBA</a>

</div>
</div>




<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Pr√©requis</b></p>
</div><div class="pl-8 mr-8">
<ul>
<li>Connaissances des bases de VBA</li>
</ul>
</div>
</div>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100 dark:border-emerald-800 dark:bg-emerald-950">
<svg class="absolute w-6 h-6 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-emerald-500 dark:stroke-emerald-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Liens</b></p>
</div><div class="pl-8 mr-8">
<ul>
<li>Site pratique pour commencer en VBA : <a href="https://excel-pratique.com/fr/vba">https://excel-pratique.com/fr/vba</a></li>
<li>Site pratique pour commencer en AppScript : <a href="https://sheets-pratique.com/fr/apps-script">https://sheets-pratique.com/fr/apps-script</a></li>
</ul>
</div>
</div>
<h2 id="contexte" tabindex="-1"><a class="header-anchor" href="#contexte"></a> Contexte</h2>
<p>Ayant d√ª utiliser Google AppScript pour des projets personnels avant de r√©aliser ce MON, j'ai pr√©f√©r√© ajouter une comparaison √† VBA afin qu'il ait une plus-value suppl√©mentaire pour moi et les prochains lecteurs.</p>
<h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"></a> Introduction</h2>
<p>Le langage Google Appscript permet de coder des programmes sur Google Drive et notamment Google Sheet. Il est pour Google Sheet ce que VBA est pour Excel. Toutefois, les syntaxes de ces deux langages sont assez diff√©rentes. Ce MON contient un ensemble d'√©l√©ments de base pour coder en AppScript ainsi qu'une comparaison avec des √©l√©ments de base de VBA.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Note</b></p>
</div><div class="pl-8 mr-8">
<p>ChatGPT peut s'av√©rer √™tre un v√©ritable alli√© pour apprendre √† coder dans ces langages. Attention toutefois √† v√©rifier tous les r√©sultats propos√©s : en effet certains ne fonctionnent pas. Une partie de ce MON a √©t√© r√©alis√© en s'appuyant sur ChatGPT.</p>
</div>
</div>
<h2 id="comment-utiliser-appscript-%3F" tabindex="-1"><a class="header-anchor" href="#comment-utiliser-appscript-%3F"></a> Comment utiliser AppScript ?</h2>
<h3 id="cr%C3%A9er-un-projet-appscript-depuis-gsheet" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9er-un-projet-appscript-depuis-gsheet"></a> Cr√©er un projet AppScript depuis GSheet</h3>
<p>Pour cr√©er un projet AppScript depuis un fichier GSheet, il suffit de cliquer sur le mneu &quot;Extension&quot; de la barre de t√¢che, puis sur &quot;Google AppScript&quot;. Une fen√™tre s'ouvre avec un projet vierge.</p>
<ul>
<li>Nommer son projet</li>
<li>Nommer son premier fichier (par d√©faux appel√© &quot;<a href="http://Code.gs">Code.gs</a>&quot;)</li>
<li>Cr√©er une fonction de mise en route, par exemple une fonction affichant &quot;Hello World&quot; dans une cellule d'un tableau. Cela permettra de lancer les demandes d'autorisation pour l'acc√®s aux donn√©es. Chaque utilisateur des diff√©rentes fonctions et programmes que vous cr√©ez doivent autoriser vos programmes √† acceder √† vos donn√©es.</li>
</ul>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><strong>ATTENTION !</strong></p>
</div><div class="pl-8 mr-8">
<p>Lorsque vous travaillez avec d'autres collaborateurs, chacun doit r√©aliser les t√¢ches d'autorisation avant toute automatisation (Utilisation de programmes et/ou d'automatisation cr√©√©es par d'autres personnes, lancements diff√©r√©s automatiques...).</p>
</div>
</div>
<h3 id="les-choses-%C3%A0-savoir" tabindex="-1"><a class="header-anchor" href="#les-choses-%C3%A0-savoir"></a> Les choses √† savoir</h3>
<p>Google AppScript poss√®de un certain nombre de d√©fauts qui n'en sont plus lorsque nous savons qu'ils existent.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>L'enregistrement</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>L'enregistrement est r√©alis√© soit manuellement, soit avant chaque lancement de programme. Il est r√©alis√© sur l'ensemble du projet et indique les erreurs de syntaxe. Cela permet en effet de limiter le risque de perte mais pose un probl√®me majeur : vous ne pouvez pas laisser une fonction en attente ! Si vous lancez un programme vous devez vous assurer que la synthaxe de l'enti√®ret√© de votre projet est correcte.
Ainsi, il est pratique <strong>d'enregistrer r√©guli√®rement son travail !</strong> et de convertir les blocs &quot;en attente&quot;, en commentaire.</p>
</div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Les droits d'acc√®s</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>Comme √©voqu√© pr√©cemment, tout utilisateur d'un nouveau programme doit d'abord autoriser ce dernier √† s'ex√©cuter. Pour se faire, il est int√©ressant de cr√©er une fonction simple, permettant d'acc√©der ou de modifier la valeur d'une cellule du document GSheet (N'afficher qu'un message dans la boite de dialogue ne fonctionne par exemple pas).</p>
<pre class="line-numbers"><code>

function Hello_world() {
  // Le document actif poss√®de une feuille dont le nom est "Feuille 2"
  feuille = SpreadsheetApp.getActive().getSheetByName("Feuille 2");

  // On inscrit "Hello World" dans la cellule A1 (premi√®re ligne, premi√®re colonne)
  feuille.getRange(1,1).setValue("Hello World");
}


</code></pre><p>Apr√®s avoir cliqu√© sur le bouton de lancement, un certain nombre de fen√™tre vont se succ√©der.
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%201.png" alt="Autorisation 1">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%202.png" alt="Autorisation 2">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%203.png" alt="Autorisation 3">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Autorisation%204.png" alt="Autorisation 4"></p>
</div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Les d√©clencheurs</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>Les d√©clencheurs permettent de lancer des programmes de mani√®re diff√©rentes ou lors d'un √©v√®nement.
<strong>Types de d√©clencheurs :</strong></p>
<ul>
<li>Bas√© sur une feuille de calcul : Ouverture, modification (modification manuelle d'une cellule), changement (modifications structurelles ou par des programmes : nouvelle feuille, nouvelle colonne...), envoie d'un formulaire.</li>
<li>Horaires : date et heure pr√©cise, intervalles de temps (de la minute au mois).</li>
<li>Bas√© sur un agenda : A la modification d'un google agenda.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Menu%20d%C3%A9clencheurs.png" alt="Menu d√©clencheurs">
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/R%C3%A9glage%20d%C3%A9clencheur.png" alt="R√©glage d√©clencheur"></p>
</div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Journal d'ex√©cution</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>Le journal d'ex√©cution permet de tester ses fonctions et programmes plus facilement, sans avoir √† afficher des boites de dialogues n√©cessitant une action utilisateur. Par exemple, fermer la boite de dialogue pour que le programme puisse continuer.
On utilise donc la commande <strong>console.log()</strong> pour faire apprara√Øtre des r√©sultats dans le journal</p>
<pre class="line-numbers"><code>

console.log("7");
console.log("8");


</code></pre><p>R√©sultat :
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Journal_d_execution.png" alt="Journal d'ex√©cution"></p>
</div>
</details>
</div>
<h2 id="syntaxes-appscript-et-vba" tabindex="-1"><a class="header-anchor" href="#syntaxes-appscript-et-vba"></a> Syntaxes AppScript et VBA</h2>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>En Appscript, chaque ligne doit √™tre termin√©e par <strong>&quot;;&quot;</strong> !!!!</p>
</div>
</div>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Information</b></p>
</div><div class="pl-8 mr-8">
<p>Les commentaires se font :</p>
<ul>
<li><strong>En VBA :</strong> Avec <em><strong>'</strong></em></li>
<li><strong>En AppScript :</strong> Avec <em><strong>//</strong></em></li>
</ul>
</div>
</div>
<h3 id="donn%C3%A9es-de-r%C3%A9f%C3%A9rence-pour-comparaison" tabindex="-1"><a class="header-anchor" href="#donn%C3%A9es-de-r%C3%A9f%C3%A9rence-pour-comparaison"></a> Donn√©es de r√©f√©rence pour comparaison</h3>
<p>Consid√©rons les donn√©es suivantes :</p>
<ul>
<li>Un fichier (Gsheet ou Excel) nomm√© &quot;Suivi&quot;</li>
<li>&quot;Suivi&quot; poss√®de deux feuilles : &quot;Page de garde&quot; et &quot;KPI&quot; telles que suit :</li>
</ul>
<h3 id="variables" tabindex="-1"><a class="header-anchor" href="#variables"></a> Variables</h3>
<h4 id="d%C3%A9clarer-des-variables" tabindex="-1"><a class="header-anchor" href="#d%C3%A9clarer-des-variables"></a> D√©clarer des variables</h4>
<p>En VBA ou en AppScript il n'est pas n√©cessaire de d√©clarer les variables que l'on utilise. Cela reste tout de m√™me une bonne pratique pour ne pas avoir de probl√®me entre variables locales et variables globales.
<strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

Sub test()

'D√©clarer avec le type
Dim a As Integer
a = 7
'D√©clarer sans le type
Dim b
b = 10
'Affecter directement une valeur
c = 12

End Sub


</code></pre><p><strong>En Appscript :</strong></p>
<pre class="line-numbers"><code>

function Variables() {
  // D√©clarer et affectercer
  var a = 7;
  // Ne pas d√©clarer
  b = 8;
}


</code></pre><h4 id="types-principaux-et-fonctions-de-conversion" tabindex="-1"><a class="header-anchor" href="#types-principaux-et-fonctions-de-conversion"></a> Types principaux et fonctions de conversion</h4>
<p><strong>En Appscript :</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Conversion</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number</td>
<td>Nombres entiers et flottants</td>
<td>Fonction <strong>Number()</strong>, s'applique aux chaines de caract√®res et aux bool√©ens</td>
</tr>
<tr>
<td>String</td>
<td>Chaine de caract√®re</td>
<td>M√©thode <strong>.toString()</strong></td>
</tr>
<tr>
<td>Boolean</td>
<td>Valeur bool√©enne : <strong>true</strong> ou <strong>false</strong></td>
<td>Fonction <strong>Boolean()</strong>. Renvoie true pour toute chaine de caract√®re autre que la chaine vide &quot;&quot; et pour tout Number autre que 0</td>
</tr>
<tr>
<td>Array</td>
<td>Tableaux</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>En VBA :</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Conversion</th>
</tr>
</thead>
<tbody>
<tr>
<td>Integer</td>
<td>Entiers entre -32 768 et 32 767</td>
<td>Fonction <strong>CInt()</strong></td>
</tr>
<tr>
<td>Long</td>
<td>Entiers entre -2 147 483 648 et 2 147 483 647</td>
<td>Fonction <strong>CLng</strong></td>
</tr>
<tr>
<td>Double</td>
<td>Nombres d√©cimaux</td>
<td>Fonction <strong>CDbl()</strong></td>
</tr>
<tr>
<td>String</td>
<td>Chaines de caract√®re</td>
<td>Fonction <strong>CStr()</strong></td>
</tr>
<tr>
<td>Boolean</td>
<td>Valeur bool√©enne : <strong>True</strong> ou <strong>False</strong></td>
<td>Fonction <strong>CBool()</strong></td>
</tr>
</tbody>
</table>
<h3 id="op%C3%A9rateurs-logiques-et-conditions" tabindex="-1"><a class="header-anchor" href="#op%C3%A9rateurs-logiques-et-conditions"></a> Op√©rateurs logiques et conditions</h3>
<p>Supposons que nous voulons tester la valeur d'une variable : si elle est sup√©rieure √† 5, on lui ajoute 10 ; si elle est √©gale √† 2, on lui attribue  0 ; sinon, on lui ajoute 5.</p>
<p><strong>En Appscript :</strong></p>
<pre class="line-numbers"><code>

let a = 2;
if(a >= 10){
  a = a + 10;
} else if(a == 2){
  a=0;
} else {
  a = a + 5;
}


</code></pre><p><strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

a = 2
If a >= 10 Then
    a = a + 10
ElseIf a = 2 Then
    a = 0
Else
    a = a + 5
End If


</code></pre><h3 id="boucles" tabindex="-1"><a class="header-anchor" href="#boucles"></a> Boucles</h3>
<h4 id="boucle-while" tabindex="-1"><a class="header-anchor" href="#boucle-while"></a> Boucle while</h4>
<p>Suppossons que nous voulons connaitre le premier √©l√©ment de la suite de Fibonacci sup√©rieur √† 8, ainsi que son rang dans la suite.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Rappel sur la suite de Fibonacci</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>D'apr√®s Wikip√©dia :
<img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Damien-Wolbert/mon/temps-1.2/Suite%20de%20Fibonacci.png" alt="Suite de Fibonacci"></p>
</div>
</details>
</div>
<p><strong>En Appscript :</strong></p>
<pre class="line-numbers"><code>

rang = 1;
seuil = 95;

f0 = 0;
transi = 0;
f1 = 1;

while(f1<seuil){ rang="" +="1;" transi="f1;" f1="f1" f0;="" f0="transi;" <="" code=""></seuil){></code></pre><p><strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

rang = 1
seuil = 95

f0 = 0
transi = 0
f1 = 1

While f1 < seuil
    rang = rang + 1
    transi = f1
    f1 = f1 + f0
    f0 = transi
Wend

MsgBox (rang)
MsgBox (f1)


</code></pre><h4 id="boucle-for" tabindex="-1"><a class="header-anchor" href="#boucle-for"></a> Boucle for</h4>
<p>Reprenons l'exemple de la suite de Fibonacci, cette fois-ci, nous voulons cr√©er une liste avec les n premiers √©l√©ments de la suite.</p>
<p><strong>En AppScript :</strong></p>
<pre class="line-numbers"><code>

  rang = 50;
  f0 = 0;
  transi = 0;
  f1 = 1;
  liste = [f0,f1];

  for(let i=2;i<=rang-2;i++){
    transi = f1;
    f1 = f1 + f0;
    f0 = transi;
    liste.push(f1);
  }


</code></pre><p><strong>En VBA :</strong></p>
<pre class="line-numbers"><code>

rang = 50
f0 = 0
transi = 0
f1 = 1
Set liste = New Collection

For i = 2 To rang - 2
    transi = f1
    f1 = f1 + f0
    f0 = transi
    liste.Add f1
Next


</code></pre><h3 id="les-listes" tabindex="-1"><a class="header-anchor" href="#les-listes"></a> Les listes</h3>
<h4 id="doit-on-r%C3%A9ellement-utiliser-des-listes-%3F-l'utilit%C3%A9-d'un-%22back-end%22" tabindex="-1"><a class="header-anchor" href="#doit-on-r%C3%A9ellement-utiliser-des-listes-%3F-l'utilit%C3%A9-d'un-%22back-end%22"></a> Doit-on r√©ellement utiliser des listes ? L'utilit√© d'un &quot;back-end&quot;</h4>
<p>AppScript et VBA sont souvent utilis√©s pour int√©ragir avec des tableurs. Il est donc facile de stocker des valeurs dans un de ces tableaux.
Lorsque des listes sont utilis√©es de mani√®re r√©currente pour l'ex√©cution d'un programme, il peut √™tre interessant de cr√©er une feuille de calcul annexe permettant de stocker et d'acc√©der √† diff√©rentes donn√©es. J'ai pour habitude de nommer cette feuille <strong>Back-end</strong>.</p>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>En VBA, l'utilisation de listes ou de tableaux n'est pas facile, voire ineffcicace.</p>
</div>
</div>
<h4 id="op%C3%A9rations-sur-les-listes" tabindex="-1"><a class="header-anchor" href="#op%C3%A9rations-sur-les-listes"></a> Op√©rations sur les listes</h4>
<h5 id="%C2%A4-cr%C3%A9er-une-liste" tabindex="-1"><a class="header-anchor" href="#%C2%A4-cr%C3%A9er-une-liste"></a> ¬§ Cr√©er une liste</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

liste = []; // Cr√©ation d'une liste vide
liste = ["a","b","c","d","e"]


</code></pre><p><em><strong>En VBA :</strong></em>
En VBA, il est possible d'utiliser des tableaux, des collections, des Arraylist, des dictionnaires... La structure la plus simple d'utilisation est la collection.</p>
<pre class="line-numbers"><code>

Dim liste = New Collection 'Cr√©ation d'une liste vide
liste.Add "a"
liste.Add "b"
liste.Add "c"
liste.Add "d"
liste.Add "e"


</code></pre><h5 id="%C2%A4-longueur-de-liste" tabindex="-1"><a class="header-anchor" href="#%C2%A4-longueur-de-liste"></a> ¬§ Longueur de liste</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

Longueur = liste.length;


</code></pre><p><em><strong>En VBA :</strong></em></p>
<pre class="line-numbers"><code>

Longueur = liste.Count


</code></pre><h5 id="%C2%A4-acc%C3%A9der-%C3%A0-des-%C3%A9l%C3%A9ments" tabindex="-1"><a class="header-anchor" href="#%C2%A4-acc%C3%A9der-%C3%A0-des-%C3%A9l%C3%A9ments"></a> ¬§ Acc√©der √† des √©l√©ments</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

premier = liste[0]; // Premier √©l√©ment de la liste
dernier = liste[liste.length-1]; //Dernier √©l√©ment de la liste
troisieme = liste[2]; // Trois√®me √©l√©ment de la liste. LE RANG COMMENCE A 0 !!


</code></pre><p><em><strong>En VBA :</strong></em></p>
<pre class="line-numbers"><code>

premier = liste(1) // Premier √©l√©ment de la liste
dernier = liste(liste.Count) // Dernier √©l√©ment de la liste
troisi√®me = liste(3) // Troisi√®me √©l√©ment de la liste. LE RANG COMMENCE A 1 !!


</code></pre><h5 id="%C2%A4-ajouter-et-supprimer-des-%C3%A9l%C3%A9ments" tabindex="-1"><a class="header-anchor" href="#%C2%A4-ajouter-et-supprimer-des-%C3%A9l%C3%A9ments"></a> ¬§ Ajouter et supprimer des √©l√©ments</h5>
<p><em><strong>En AppScript :</strong></em></p>
<pre class="line-numbers"><code>

liste.push("x","y","z"); // Ajoute "x", "y" et "z" √† la fin de la liste
liste.unshift("alpha"); // Ajoute "alpha" au d√©but de la liste
position = 0;
nombre = 2;
liste.splice(position,nombre,"delta","mu"); // Permet de supprimer un certain nombre d'√©l√©ments √† partir d'une position initiale et d'ajouter d'autres √©l√©ments √† la place


</code></pre><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>M√©thode .splice()</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p>La m√©thode <strong>.splice()</strong> permet de supprimer des √©l√©ments mais aussi de les ajouter √† une certaine position √† place d'un certain nombre d'autres.</p>
<pre class="line-numbers"><code>

liste = [1,2,3,4,5,6,7,8,9,10];
liste.splice(4,0,152,189,204); // 152, 189, 204 sont les valeurs ins√©r√©e √† la position 4
// liste est maintenant √©gale √† [1, 2, 3, 4, 152, 189, 204, 5, 6, 7, 8, 9, 10]


</code></pre></div>
</details>
</div>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Methode .filter()</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<p><strong>.filter()</strong> permet de cr√©er une liste fille en filtrant une liste m√®re.</p>
<pre class="line-numbers"><code>

liste=[1,2,3,4,5,6,7];
liste = liste.filter(nombre => nombre!=5); //liste est alors √©gale √† [1,2,3,4,6,7]


</code></pre></div>
</details>
</div>
<p><em><strong>En VBA :</strong></em></p>
<pre class="line-numbers"><code>

liste.Add "z"


</code></pre><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>En VBA, on ne peut pas √©liminer facilement un √©l√©ment d'une Collection. Il faut utiliser une boucle pour cr√©er une nouvelle collection d√©pourvue des √©l√©ments √† supprimer.
Les <strong>ArrayList</strong> sont en cela plus simples d'utilisation mais il semble n√©cessaire d'importer des biblioth√®sques sp√©ciales pour cela.</p>
</div>
</div>
<h2 id="cr%C3%A9er-des-programmes-et-des-fonctions" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9er-des-programmes-et-des-fonctions"></a> Cr√©er des programmes et des fonctions</h2>
<h3 id="appscript" tabindex="-1"><a class="header-anchor" href="#appscript"></a> AppScript</h3>
<p>Pour travailler en AppScript il est n√©cessaire d'utiliser des fonctions ou de d√©finir les fonctions utilis√©es dans un fichier √† part. En effet, il est possible d'√©crire un programme sans fonction au sein d'un fichier. Cependant, lors de l'√©xecution de celui-ci, toutes les fonction √©galement d√©finies sur le fichier seront ex√©cut√©es.</p>
<p><strong>Pour d√©finir des fonctions :</strong></p>
<pre class="line-numbers"><code>

function MaFonction(x,y){
  return()
}


</code></pre><ul>
<li>Notons qu'une fonction peut ne rien renvoyer et donc peu ne pas comporter de return().</li>
<li>Pour utiliser une fonction au sein d'une autre, il suffit de l'appliquer, la fonction sera notamment propos√©e apr√®s avoir tap√© les premiers caract√®res de son nom.</li>
</ul>
<h3 id="vba" tabindex="-1"><a class="header-anchor" href="#vba"></a> VBA</h3>
<p>Pour travailler en VBA, il faut obliagtoirement travailler au sein d'un <strong>Sub</strong> dans lequel il sera possible d'appeler d'autres <strong>Sub</strong> ou d'autres <strong>fonctions</strong>.</p>
<pre class="line-numbers"><code>

Sub MonSub(argument)
argument = argument + 1
End Sub

'''''''''''''''''''''''''''''
Sub MonGrandSub()
x = 2
Call MonSub(x) // La fonction MonSub est appliqu√©e √† x, qui devient donc √©gal √† 3
End Sub


</code></pre><p>Lorsque nous voulons utilser une fonction renvoyant quelque chose, il faut utiliser <strong>Function</strong></p>
<pre class="line-numbers"><code>

Function Ajouter_Deux(argument)
Ajouter_Deux = argument + 2
End Function


</code></pre><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Attention</b></p>
</div><div class="pl-8 mr-8">
<p>La valeur renvoy√©e par la fonction doit poss√©der le m√™me nom que la fonction.</p>
</div>
</div>
<h2 id="les-fonctions-utiles-en-appscript" tabindex="-1"><a class="header-anchor" href="#les-fonctions-utiles-en-appscript"></a> Les fonctions utiles en AppScript</h2>
<p>Supposons que nous travaillons avec un document nomm√© &quot;Suivi&quot; et poss√©dant deux feuilles : &quot;Page de garde&quot; et &quot;KPI&quot;.</p>
<h3 id="acc%C3%A9der-%C3%A0-des-fichiers-et-des-feuilles-de-calcul" tabindex="-1"><a class="header-anchor" href="#acc%C3%A9der-%C3%A0-des-fichiers-et-des-feuilles-de-calcul"></a> Acc√©der √† des fichiers et des feuilles de calcul</h3>
<p>Pour pouvoir acc√©der √† un document GSheet, plusieurs m√©thodes sont possibles :</p>
<pre class="line-numbers"><code>

Document = SpreadsheetApp.getActive(); // La variable Document permet maintenant de se r√©f√©rer au document GSheet ouvert.
DocumentBis = SpreadsheetApp.OpenByUrl("https://..."); // La variable DocumentBis permet de se r√©f√©rer au document dont on a donn√© l'url.

Feuille = Document.getSheetByName("KPI"); // La variable Feuille permet de se r√©f√©rer √† la feuille "KPI" du document "Suivi".
FeuilleBis = Document.getActiveSheet(); // La variable FeuilleBis permet de se r√©f√©rer √† la feuille active du document "Suivi".

Toutes_feuilles = Document.getSheets();


</code></pre><h3 id="acc%C3%A9der-ou-modifier-la-valeur-d'une-cellule" tabindex="-1"><a class="header-anchor" href="#acc%C3%A9der-ou-modifier-la-valeur-d'une-cellule"></a> Acc√©der ou modifier la valeur d'une cellule</h3>
<pre class="line-numbers"><code>

Feuille = SpreadsheetApp.getActive().getSheetByName("KPI");
valeur = Feuille.getRange(3,2).getValue(); // valeur est √©gale au contenue de la cellule positionn√©e √† la 3√®me ligne, 2√®me colonne.
Feuille.getRange(3,2).setValue("Nom d'assurance"); // La cellule de la 3√®me ligne, 2√®me colonne est maintenant √©gale √† "Nom d'assurance".


</code></pre><h3 id="derni%C3%A8re-ligne-ou-colonne-d'un-tableau" tabindex="-1"><a class="header-anchor" href="#derni%C3%A8re-ligne-ou-colonne-d'un-tableau"></a> Derni√®re ligne ou colonne d'un tableau</h3>
<p>Il est parfois int√©ressant de connaitre les dimensions d'un tableau afin de r√©aliser des boucles par exemple.</p>
<pre class="line-numbers"><code>

Feuille = SpreadsheetApp.getActive().getSheetByName("KPI");
derniere_ligne = Feuille.getLastRow();
derniere_colonne = Feuille.getLastColumn();


</code></pre><h3 id="nom-d'une-feuille" tabindex="-1"><a class="header-anchor" href="#nom-d'une-feuille"></a> Nom d'une feuille</h3>
<pre class="line-numbers"><code>

Feuille = SpreadsheetApp.getActive().getActiveSheet();
nom = Feuille.getName(); // Nom de la feuille active


</code></pre><h3 id="nombre-de-feuilles-du-classeur" tabindex="-1"><a class="header-anchor" href="#nombre-de-feuilles-du-classeur"></a> Nombre de feuilles du classeur</h3>
<pre class="line-numbers"><code>

Feuilles = SpreadsheetApp.getActive().getSheets();
Nbr = Feuilles.length;

Feuille = SpreadsheetApp.getActive().getActiveSheet();
numero = Feuilles.indexOf(Feuille);


</code></pre><div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Note</b></p>
</div><div class="pl-8 mr-8">
<p>Si l'index est <strong>-1</strong>, cela signifie que la feuille n'a pas √©t√© trouv√©e.</p>
</div>
</div>
<h3 id="sortir-d'une-boucle-ou-d'une-fonction" tabindex="-1"><a class="header-anchor" href="#sortir-d'une-boucle-ou-d'une-fonction"></a> Sortir d'une boucle ou d'une fonction</h3>
<ul>
<li>Afin de sortir d'une boucle, on utilise <strong>break</strong>.</li>
<li>Afin de sortir d'une fonction en cours, on utilise <strong>return</strong>.</li>
</ul>



</article>

        </main>

        <footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        ¬©2025 <b><span style="font-family: Consolas, sans-serif;">Do-<span style="color: #4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT
                    </p>
                </div>
            </div>
        </footer>

        <!-- MathJax import and initialization -->
        <script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']], // Delimiters for inline math
                    displayMath: [['$$', '$$'], ['\\[', '\\]']] // Delimiters for block math
                },
                svg: {
                    fontCache: 'global' // Use global font cache for SVG output
                }
            };
            document.addEventListener('DOMContentLoaded', () => {
                MathJax.typeset(); // Ensures MathJax processes the content after the page loads
            });
        </script>

        <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">
            Prism.plugins.NormalizeWhitespace.setDefaults({
                'remove-trailing': true,
                'remove-indent': true,
                'left-trim': true,
                'right-trim': true,
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script>
    </body>
</html>
