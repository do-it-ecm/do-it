<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2024-2025/Matthieu-Dufort/mon/temps-1.1/"><meta name="description" content="Le rattrapage de donn√©es consiste √† corriger les donn√©es existantes d&#39;une base afin de les aligner sur un format commun. Pour cela, on utilise beaucoup Excel. Le but de ce MON sera d&#39;apprendre et de d√©couvrir des formules Excel pour corriger des donn√©es."><meta property="og:description" content="Le rattrapage de donn√©es consiste √† corriger les donn√©es existantes d&#39;une base afin de les aligner sur un format commun. Pour cela, on utilise beaucoup Excel. Le but de ce MON sera d&#39;apprendre et de d√©couvrir des formules Excel pour corriger des donn√©es."><meta name="twitter:description" content="Le rattrapage de donn√©es consiste √† corriger les donn√©es existantes d&#39;une base afin de les aligner sur un format commun. Pour cela, on utilise beaucoup Excel. Le but de ce MON sera d&#39;apprendre et de d√©couvrir des formules Excel pour corriger des donn√©es."><meta name="author" content="Matthieu Dufort"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, Excel, Traitement de donn√©es, Novice/int√©rm√©diaire"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="L&#39;utilisation d&#39;Excel pour mettre en forme de la donn√©e"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Matthieu-Dufort/mon/temps-1.1/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="L&#39;utilisation d&#39;Excel pour mettre en forme de la donn√©e"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2024-2025/Matthieu-Dufort/mon/temps-1.1/"><title>L&#39;utilisation d&#39;Excel pour mettre en forme de la donn√©e</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">L&#39;utilisation d&#39;Excel pour mettre en forme de la donn√©e</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Excel</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Traitement de donn√©es</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Novice/int√©rm√©diaire</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Matthieu Dufort</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2024-2025</span></div></div><p class="mb-4 text-lg">Le rattrapage de donn√©es consiste √† corriger les donn√©es existantes d'une base afin de les aligner sur un format commun. Pour cela, on utilise beaucoup Excel. Le but de ce MON sera d'apprendre et de d√©couvrir des formules Excel pour corriger des donn√©es.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2024-2025/Matthieu-Dufort/">Matthieu Dufort</a><span class="px-1">/</span><a href="/promos/2024-2025/Matthieu-Dufort/mon/">MON de Matthieu Dufort</a><span class="px-1">/</span><a href="/promos/2024-2025/Matthieu-Dufort/mon/temps-1.1/">L&#39;utilisation d&#39;Excel pour mettre en forme de la donn√©e</a></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Pr√©requis</b></p></div><div class="pl-8 mr-8"><p>Connaitre les bases d'Excel et les formules standards.</p></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-emerald-500 bg-emerald-100 dark:border-emerald-800 dark:bg-emerald-950"><svg class="absolute w-6 h-6 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-emerald-500 dark:stroke-emerald-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Liens</b></p></div><div class="pl-8 mr-8"><ul><li><a href="https://fr.excel-translator.de/fonctions/">Traduction des formules Excel</a></li><li><a href="BaseDeDonnees.zip">Fichier Excel utilis√© dans ce MON</a></li></ul></div></div><p>Dans ce MON, je vais utiliser des formules Excel pour mettre en forme une base de donn√©es que j'aurai au pr√©alable volontairement mal remplie, en m'inspirant de ce que l'on peut retrouver dans une base r√©elle.</p><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"></a> Introduction</h2><p>Lorsqu'une base de donn√©es pr√©sente de nombreux formats diff√©rents pour un seul et unique champ, cela perturbe l'analyse de donn√©es. Pour √©viter cela, il est fr√©quent d'imposer un formatage avec des r√®gles de validation ou des listes de choix impos√©s. Cependant, il arrive fr√©quemment que certaines de ces r√®gles ne soient pas con√ßues d√®s le d√©but, car on peut de temps en temps oublier √† quel point une r√©ponse d'un utilisateur peut varier par rapport √† un autre. Et, une fois que l'on ajoute ces r√®gles, il faut alors corriger l'ancienne data. C'est ce que nous allons faire dans ce MON √† l'aide d'Excel.</p><p>Pour cela, nous allons tout d'abord cr√©er une base de donn√©es qui ne suivra aucune bonne pratique. Puis, nous alignerons toutes les donn√©es sur des formats communs en travaillant sur des formules Excel que nous expliquerons.</p><h2 id="constitution-d'une-base-de-donn%C3%A9es-non-format%C3%A9es" tabindex="-1"><a class="header-anchor" href="#constitution-d'une-base-de-donn%C3%A9es-non-format%C3%A9es"></a> Constitution d'une base de donn√©es non format√©es</h2><p>Nous allons partir d'une base pr√©sentant des donn√©es standard d'un utilisateur avec comme cl√© primaire l'email de l'utilisateur (un email √©tant forc√©ment synonyme d'unicit√©).</p><p>Pour la constitution de cette base de donn√©es, j'ai choisi de commencer par demander √† ChatGPT un exemple de ce que pourrait donner une base sans aucune contrainte de remplissage. Pour cela, j'ai utilis√© le prompt suivant :</p><p><em>Can you fill this data base with french information that could be not well formatted like a wrong email or different phone number format etc. The data base use this fields and there is for now no rules on how to fill it : Name, Surname, email, phone number, phone number 2, Street number,	Street, City, Postal Code, Country, Birth date,	City of Birth, Nationality</em></p><p>Je suis ensuite parti de sa r√©ponse en corrigeant l√©g√®rement certaine ab√©ration afin d'aboutir √† ceci :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Matthieu-Dufort/mon/temps-1.1/Picture1.png" alt="image de la base de donn√©es non format√©es"></p><p>On peut bien observer sur cette base que certains emails sont faux et ne peuvent pas marcher. Les num√©ros de t√©l√©phone ont absolument tous les formats possibles et imaginables, tout comme les dates de naissance. Certains champs ne sont pas remplis et l'information se trouve ailleurs. Il faut donc remettre tout cela en ordre afin de pouvoir faire du reporting efficace. Mais, avant cela, il faut faire en sorte que ce genre d'erreurs ne se reproduise pas en mettant des r√®gles en place.</p><h2 id="les-nouvelles-r%C3%A8gles-sur-la-base" tabindex="-1"><a class="header-anchor" href="#les-nouvelles-r%C3%A8gles-sur-la-base"></a> Les nouvelles r√®gles sur la base</h2><p>En suivant les bonnes pratiques que l'on retrouve dans le <a href="https://do-it.aioli.ec-m.fr/promos/2024-2025/Matthieu-Dufort/pok/temps-1/">POK 1</a>, nous allons fixer des r√®gles pour chacun des objets.</p><p>En premier, pour <strong>l'adresse email</strong>, nous allons fixer une r√®gle de validation d'adresse email en v√©rifiant le format <em>---@---.---</em></p><p>Puis, pour les <strong>num√©ros de t√©l√©phone</strong>, nous allons rajouter une r√®gle sur le format en s'alignant sur un format fixe de la forme <em>XX........</em> ; de sorte que les XX reprennent les num√©ros d'identification du pays et ensuite on ajoute sans espace la suite de chiffre.</p><p>Pour le <strong>code Postal</strong> et <strong>la nationalit√©</strong>, nous le rempla√ßons par une <em>liste de choix</em> permettant l'homog√©n√©it√©. La ville peut ensuite √™tre d√©duite du code postal afin de proposer un auto-remplissage. Elle pourra ensuite √™tre modifi√©e en cas de besoin.</p><p>Pour la <strong>rue</strong>, il est difficile de confirmer que l'adresse existe vraiment. On peut donc envisager, afin de r√©duire au maximum les erreurs potentielles, de se connecter √† <em>l'API de google maps</em> afin de donner la possibilit√© √† l'utilisateur de rechercher son adresse pour remplir tous les champs automatiquement.</p><p>Enfin, nous allons forcer le formatage de la <strong>date</strong> au format <em>jj/mm/aaaa</em>.</p><p>Gr√¢ce √† ces nouvelles r√®gles en place, nous pouvons maintenant √™tre s√ªrs que la donn√©e sera remplie au mieux, et il est donc temps de corriger l'ancienne donn√©e gr√¢ce √† Excel.</p><h2 id="nettoyage-et-allignement-des-donn%C3%A9es" tabindex="-1"><a class="header-anchor" href="#nettoyage-et-allignement-des-donn%C3%A9es"></a> Nettoyage et allignement des donn√©es</h2><p>Pour aligner les donn√©es, il est possible d'utiliser Excel avec des formules de niveau int√©rm√©diaire.</p><h3 id="l'email" tabindex="-1"><a class="header-anchor" href="#l'email"></a> L'email</h3><p>Tout d'abord l'email √©tant l'√©l√©ment essentiel de la base, nous allons supprimer tous les emails qui ont des formats non conforme. Pour cela, il faut d'abord v√©rifier que chaque email a au moins un &quot;<em>.</em>&quot; apr√®s &quot;@&quot; et uniquement un &quot;<em>@</em>&quot;. Nous allons combiner plusieurs fonctions :</p><ul><li><p>Fonction <strong>MID</strong> (STXT) :</p><ul><li><em>Format</em> : MID(Texte sur lequel on travail,num√©ro de caract√®re o√π commencer l'extraction, Nombre de caract√®res √† extraire)</li><li><em>R√©ponse</em> : La partie de texte extraite sur une longueur du nombre de caract√®res rentr√© en param√®tre</li></ul></li><li><p>Fonction <strong>SEARCH</strong> (CHERCHE) :</p><ul><li><em>Format</em> : SEARCH(&quot;texte √† trouver&quot; ; Ou le chercher)</li><li><em>R√©ponse</em> : Position du premier caract√®re √† trouver qui est trouv√© (premier caract√®re du texte = 1) ; Renvoie une erreur si le caract√®re n'est pas dans la liste</li></ul></li><li><p>Fonction <strong>ISNUMBER</strong> (ESTNUM) :</p><ul><li><em>Format</em> : ISNUMBER(Test logique, valeur si c'est un nombre, valeur sinon)</li><li><em>R√©ponse</em> : Retourne les valeurs choisies en fonction de ce qu'on a mis en param√®tre de la fonction</li></ul></li></ul><p>La fonction <strong>MID</strong> va nous permettre d'extraire tous les caract√®res trouv√©s apr√®s le premier @ (ou une erreur s'il n'y en a pas). Pour cela nous allons la combiner avec la fonction <strong>SEARCH</strong>. Puis nous allons verifier dans cette extraction qu'il n'y a plus de @ et qu'il y a bien un point en utilisant la fonction <strong>IF</strong> (Si), <strong>NOT</strong> (NON), et <strong>AND</strong> (ET) pour faire nos tests de logique ainsi que <strong>LEN</strong>.</p><p>Cela donne :</p><pre class="line-numbers"><code>

=MID(C2; SEARCH("@";C2)+1; LEN(C2) - SEARCH("@";C2))


</code></pre><p>Pour r√©aliser l'extraction et on peut maintenant rajouter la logique en rentrant la formule pr√©c√©dente dans la colonne N :</p><pre class="line-numbers"><code>

=IF(AND(NOT(ISNUMBER(SEARCH("@";N2)));ISNUMBER(SEARCH(".";N2)));"ok";"Wrong")


</code></pre><p>Ce qui donne :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Matthieu-Dufort/mon/temps-1.1/Picture2.png" alt="Analyse de la base sur les emails"></p><p>Et on peut donc maintenant supprimer tous ceux qui sont mauvais et passer √† la suite.</p><h3 id="les-num%C3%A9ros-de-t%C3%A9l%C3%A9phone" tabindex="-1"><a class="header-anchor" href="#les-num%C3%A9ros-de-t%C3%A9l%C3%A9phone"></a> Les num√©ros de t√©l√©phone</h3><p>Pour s'aligner sur le format nouvellement impos√©, nous allons commencer par supprimer tout ce qui n'est pas un chiffre. Puis, nous changerons les nombres en fonction des besoins restants.</p><ul><li>Fonction <strong>SUBSTITUTE</strong> (SUBSTITUE) :<ul><li><em>Format</em> : SUBSTITUTE(&quot;texte sur lequel on travaille&quot; ; &quot;ancienne valeur √† remplacer&quot; ; &quot;Nouvelle Valeur&quot;)</li><li><em>R√©ponse</em> : Texte sur lequel on travaille avec la nouvelle valeur √† la place de l'ancienne.</li></ul></li></ul><p>On fait donc :</p><pre class="line-numbers"><code>

=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(D2;" ";"");"+";"");".";"");"-";"");"(";"");")";"")


</code></pre><p>On combine ensuite, en fonction de la longueur de la cha√Æne, des fonctions logiques et des fonctions qui r√©cup√®rent une partie des caract√®res :</p><ul><li>Fonction <strong>RIGHT</strong> (DROITE) :<ul><li><em>Format</em> : RIGHT(&quot;texte sur lequel on travaille&quot; ; &quot;Nombre de caract√®res √† r√©cup√©rer en partant de la droite&quot;)</li><li><em>R√©ponse</em> : Nombre de caract√®res choisis sur le texte indiqu√© en partant de la droite</li></ul></li><li>Fonction <strong>TEXT</strong> (TEXT) :<ul><li><em>Format</em> : TEXT(&quot;champ √† transformer au format texte&quot; ; &quot;format du texte voulue&quot;)</li><li><em>R√©ponse</em> : Le champ sous forme de texte au format souhait√©</li></ul></li></ul><pre class="line-numbers"><code>

=IF(LEN(N2)=11;N2;IF(LEN(N2)=10;"33" & TEXT(RIGHT(N2;9);"0");"33" & N2))


</code></pre><p>Et on obtient :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Matthieu-Dufort/mon/temps-1.1/Picture3.png" alt="Analyse de la base sur les emails"></p><p>On applique ceci au num√©ro 2 aussi pour passer ensuite au num√©ro de rue et √† l'adresse.</p><h3 id="adresse" tabindex="-1"><a class="header-anchor" href="#adresse"></a> Adresse</h3><p>Pour l'adresse, comme observ√© dans les r√®gles pr√©c√©demment, on ne peut que fixer le choix du code postal. Nous allons donc aligner les codes postaux. Pour cela, nous r√©utilisons uniquement des fonctions vues pr√©c√©demment de la fa√ßon suivante :</p><pre class="line-numbers"><code>

=IF(LEN(I2)=4;"0"&TEXT(I2;"0");IF(LEN(I2)=2;TEXT(I2;"0")&"000";I2))


</code></pre><p>Et cela donne :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Matthieu-Dufort/mon/temps-1.1/Picture4.png" alt="Analyse de la base sur l'adresse"></p><h3 id="nationalit%C3%A9" tabindex="-1"><a class="header-anchor" href="#nationalit%C3%A9"></a> Nationalit√©</h3><p>Pour la nationalit√©, nous allons homog√©n√©iser en passant par une liste de choix avec les abr√©viations des pays.</p><pre class="line-numbers"><code>

=IF(LEFT(M2;4)="Fran";"FR"; "Other")


</code></pre><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Matthieu-Dufort/mon/temps-1.1/Picture5.png" alt="Analyse de la base sur la nationalit√©"></p><h3 id="date-de-naissance" tabindex="-1"><a class="header-anchor" href="#date-de-naissance"></a> Date de naissance</h3><p>Pour la date de naissance, il suffit de substituer tout ce qui n'est pas un chiffre par un / afin d'obtenir le format voulu. On utilise donc la fonction <strong>SUBSTITUTE</strong></p><pre class="line-numbers"><code>

=IF(ISNUMBER(SEARCH("/";TEXT(K2; "jj/mm/aaaa")))=TRUE;TEXT(K2;"jj/mm/aaaa");SUBSTITUTE(SUBSTITUTE(K2;".";"/");"-";"/"))


</code></pre><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Matthieu-Dufort/mon/temps-1.1/Picture6.png" alt="Analyse de la base sur la date de naissance"></p><p>Et on obtient alors une base de donn√©es propre et align√©e sur les nouveaux crit√®res afin de repartir sur de bonnes bases pour faire du reporting.</p><h2 id="bonus-%3A-doublon" tabindex="-1"><a class="header-anchor" href="#bonus-%3A-doublon"></a> Bonus : Doublon</h2><p>En base de donn√©es, il y a souvent des doublons. Pour traiter cela dans Excel, on utilise une fonction tr√®s pratique :</p><ul><li>Fonction <strong>VLOOKUP</strong> (RECHERCHEV) :<ul><li><em>Format</em> : VLOOKUP(&quot;Valeur recherch√©&quot;; Endroit ou chercher la valeur ; L'indexe de la colonne √† retourner, Le type de ressemblance)<ul><li>La valeur recherch√©e correspond √† la cellule sur le test du doublon.</li><li>L'endroit o√π chercher est une matrice ; cependant, Excel ne cherchera que dans la premi√®re colonne de la matrice. Le fait d'utiliser une matrice permet uniquement d'afficher diff√©rentes valeurs si un doublon est trouv√©.</li><li>L'index correspond au num√©ro de la colonne de la matrice dont on veut retourner la valeur. Si on cherche uniquement sur une colonne simple et qu'on veut retourner la valeur de cette colonne, cela sera <em>1</em>.</li><li>Le type de ressemblance peut √™tre TRUE ou FALSE : FALSE pour une ressemblance exacte et TRUE pour une ressemblance approximative (si aucune ressemblance n'est trouv√©e, Excel retourne la valeur d'en dessous ; il faut donc bien ordonner la premi√®re colonne pour faire ce type de ressemblance).</li></ul></li><li><em>R√©ponse</em> : Retourne la valeur de la colonne choisie en param√®tre 3 en fonction du match en param√®tre 1.</li></ul></li></ul><p>Exemple :</p><pre class="line-numbers"><code>

=VLOOKUP(C2;C3:C10;1;FALSE)


</code></pre><p>Ce qui donne : <img src="https://raw.githubusercontent.com/do-it-ecm/promo-2024-2025/refs/heads/main//Matthieu-Dufort/mon/temps-1.1/Picture7.png" alt="Analyse de la base sur les doublons"></p><p>Il ne reste plus ensuite qu'a combiner les informations des doublons pour les supprimer.</p></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>