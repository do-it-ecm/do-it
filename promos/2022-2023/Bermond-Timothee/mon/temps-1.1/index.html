<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2022-2023/Bermond-Timothee/mon/temps-1.1/"><meta name="description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta property="og:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="twitter:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="author" content="Timoth√©e Bermond"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, google-apps-script"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="Working with Excel Spreadsheets"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Bermond-Timothee/mon/temps-1.1/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="Working with Excel Spreadsheets"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Bermond-Timothee/mon/temps-1.1/"><title>Working with Excel Spreadsheets</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">Working with Excel Spreadsheets</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tag :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">google-apps-script</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Timoth√©e Bermond</li></ul></div></div><p>Automate the boring stuff with python : Working with Excel spreadsheets (chapter 13)</p><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"></a> Introduction</h2><p>J'ai suivi la formation du livre <a href="https://automatetheboringstuff.com/">Automate the boring stuff with python</a> et plus particuli√®rement le chapitre 13 <a href="https://automatetheboringstuff.com/2e/chapter13/">Working with Excel Spreadsheets</a> car on est forc√©ment amen√© √† utiliser des tableurs dans notre vie professionelle. Savoir automatiser son utilisation afin de gagner du temps et limiter les erreurs me para√Æt pertinent.</p><h2 id="lire-un-document-excel" tabindex="-1"><a class="header-anchor" href="#lire-un-document-excel"></a> Lire un document Excel</h2><p>Une m√©thode pour travailler sur les documents Excel est l'utilisation du module OpenPyXL (version 2.6.2 dans cette formation).</p><p>Il est ensuite possible d'importer un document excel avec la fonction <em>openpyxl.load_workbook()</em>. Ce qui permet d'acc√©der aux diff√©rents feuilles (sheet) du tableur ainsi qu'aux cellules de chaque feuille.</p><p>Chaque cellule a comme attribut :</p><ul><li>sa valeur (<em>value</em>)</li><li>sa ligne (<em>row</em>)</li><li>sa colonne (<em>column</em>)</li><li>ses coordonn√©es (<em>coordinate</em>)</li></ul><p>Il est donc possible de lire les donn√©es, de calculer l'occurence d'un mot, comparer les donn√©es entre diff√©rents tableurs, v√©rifier la pr√©sence de lignes vides ou de donn√©es invalides...</p><p><strong>Petit r√©sum√©</strong></p><ul><li>Importer le module openpyxl</li><li>Utiliser la fonction openpyxl.load_workbook()</li><li>Choisir les feuilles qu'on veut modifier en utilisant son nom ou en choisissant la feuille active</li><li>Utiliser les coordonn√©es ou la m√©thode <em>cell()</em> avec les lignes et les colonnes en arguments</li><li>Lire la valeur de la cellule</li></ul><h2 id="modifier-un-document-excel" tabindex="-1"><a class="header-anchor" href="#modifier-un-document-excel"></a> Modifier un document Excel</h2><p>Il est √©galement possible de modifier un document Excel :</p><ul><li>Cr√©er un nouveau tableur vide</li><li>Cr√©er ou supprimer une nouvelle feuille</li><li>Modifier le nom d'une feuille</li><li>Cr√©er ou modifier la valeur d'une cellule</li></ul><p>Il ne faut pas oublier d'utiliser la fonction <em>save()</em> afin de sauvegarder les modifications. Il est aussi pr√©f√©rable d'enregistrer les modifications dans une copie du tableur au cas ou il y aurait une erreur.(donn√©es corrompues...)</p><p><strong>Id√©es de programmes</strong></p><ul><li>Modifier un tableur</li><li>√âcrire des parties d'un tableur dans un autre</li><li>Lire des donn√©es sur des sites, des textes ou sur le presse papier et les √©crire dans un tableur</li><li>Automatiquement &quot;clean up&quot; des donn√©es dans un tableur. (r√©√©crire diff√©rents formats de num√©ros de t√©l√©phones en un seul)</li></ul><h2 id="autres-fonctionnalit%C3%A9s" tabindex="-1"><a class="header-anchor" href="#autres-fonctionnalit%C3%A9s"></a> Autres fonctionnalit√©s</h2><p><strong>Modifier le style de police</strong> Pour cela on utilise la fontion <em>Font()</em> du module <em>openpyxl.styles</em>. Il est possible:</p><ul><li>de changer la police avec l'attribut <em>name</em></li><li>ou la taille avec l'attribut <em>size</em></li><li>d'√©crire en gras avec l'attribut <em>bold</em></li><li>ou en italique avec l'attribut <em>italic</em>.</li></ul><p><strong>√âcrire des formules</strong> Il est possible d'√©crire des formules exactement comme dans un Excel.</p><p><strong>Modifier la taille des lignes et des colonnes</strong> Il est possible de changer la hauteur des lignes <em>row_dimension[].height</em> et la largeur des colonnes <em>column_dimension[].width</em>.</p><p><strong>Fusionner ou s√©parer des cellules</strong> En utilisant les fontions <em>merge_cells()</em> ou <em>unmerge_cells()</em>.</p><p><strong>Figer des volets</strong> Afin d'avoir toujours acc√®s √† certaines lignes ou colonnes, il est possible d'utiliser l'attribut <em>sheet.freeze.panes = ' '</em>. Toutes les lignes au dessus de celle indiqu√©e ainsi que toutes les colonnes √† gauche seront figer mais pas celles indiqu√©es.</p><p><strong>Cr√©er des diagrammes</strong> Pour cr√©er un diagramme, il faut suivre les √©tapes suivantes:</p><ul><li>Cr√©er un objet <em>Reference</em> √† partir d'une selection de cellules : <em>chart.Reference(sheet, min_col= , min_row= , max_col= , max_row=)</em></li><li>Cr√©er un objet <em>Series</em> qui prend l'objet <em>Reference</em> en arguement : <em>chart.Series(refObj, title='')</em></li><li>Cr√©er un objet <em>Chart</em> qui peut √™tre un diagramme en barre, en ligne, un nuage de point ou un camembert</li><li>Ajouter l'objet <em>Series</em> √† l'objet <em>Chart</em></li><li>Ajouter l'objet <em>Chart</em> √† la feuille : <em>sheet.add_chart(chartObj, 'C5')</em></li></ul><h2 id="google-apps-script" tabindex="-1"><a class="header-anchor" href="#google-apps-script"></a> Google Apps Script</h2><p>Afin de compl√©ter ma formation et de pouvoir √©galement travailler sur les google sheets j'ai suivi le guide <a href="https://developers.google.com/apps-script/guides/sheets">Automatiser des t√¢ches avec Apps Script</a>.</p><p><strong>Pr√©sentation</strong></p><p>Comme pour <em>openpyxl</em>, Apps Script permet de cr√©er, lire et modifier des tableurs Google Sheets. La principale diff√©rence est le langage utilis√© : Apps Script utilise du code JavaScript.</p><p>Les fonctionnalit√©s essentielles :</p><ul><li>Lire des donn√©es : avec les fonctions <em>getValue()</em> ou <em>getValues()</em></li><li>√âcrire des donn√©es : avec les fonctions <em>setValue()</em> ou <em>setValues()</em></li></ul><p>On peut ensuite cr√©er des fonctions qui permettent de transformer les valeurs r√©cup√©r√©s ou d'en √©crire de nouvelles. Diff√©rentes fonctionnalit√©s :</p><ul><li><p>Mise en forme : <a href="https://developers.google.com/apps-script/reference/spreadsheet/range">Class Range</a>, permet de modifier le fond, le style de police, permet de fusionner ou de diviser des cellules, d√©finir des r√®gles de validation,...</p></li><li><p>Cr√©ation de graphiques : <em>var chart = sheet.newChart()</em> (initialisation) <em>.setChartType()</em> (type de graphique) <em>.addRange(sheet.getRange())</em> (s√©l√©ction des cellules) <em>.setPosition()</em> (position du graphique) <em>.build();</em> (construction du graphique)</p><p><em>sheet.insertChart(chart);</em> (ins√®re le graphique dans la feuille de calcul)</p></li><li><p>Macros : fonctions qui s'activent √† l'aide d'un raccourci clavier</p></li><li><p>D√©clencheurs : il est possible de param√©trer les scripts afin qu'ils se d√©clenchent √† un moment pr√©cis. Par exemple, avec les fonctions <em>onOpen()</em> ou <em>onEdit()</em>.</p></li></ul></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>