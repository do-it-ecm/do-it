<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2022-2023/Durand-Jean-Baptiste/mon/temps-1.2/"><meta name="description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta property="og:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="twitter:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="author" content="Jean-Baptiste Durand"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, security, web, connexion, sql"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="SQL Injection"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Durand-Jean-Baptiste/mon/temps-1.2/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="SQL Injection"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Durand-Jean-Baptiste/mon/temps-1.2/"><title>SQL Injection</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">SQL Injection</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">security</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">web</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">connexion</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">sql</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Jean-Baptiste Durand</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2022-2023</span></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2022-2023/Durand-Jean-Baptiste/">Jean-Baptiste Durand</a><span class="px-1">/</span><a href="/promos/2022-2023/Durand-Jean-Baptiste/mon/">MON Jean-Baptiste</a><span class="px-1">/</span><a href="/promos/2022-2023/Durand-Jean-Baptiste/mon/temps-1.2/">SQL Injection</a></div></div><h2 id="h1">Disclaimer</h2><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Information</b></p></div><div class="pl-8 mr-8"><p>Les m√©thodes pr√©sent√©es dans ce cours peuvent permettre d'acc√©der de mani√®re ill√©gale √† des informations.</p><p>L'utilisation de ces m√©thodes sans l'autorisation du propri√©taire d'un site web ou un quelconque serveur est ill√©gale et est punit par la loi.</p><p>Ce cours a pour objectif de sensibiliser les ing√©nieurs dans le domaine de la s√©curit√© et leur permettre de prot√©ger les serveurs contre ce type d'attaque.</p></div></div><h2 id="toc">Table des mati√®res</h2><ul><li><a href="#h1">Disclaimer</a></li><li><a href="#toc">Table des mati√®res</a></li><li><a href="#h2">Pourquoi cette attaque ?</a></li><li><a href="#h3">BurpSuite</a></li><li><a href="#h4">SQL injection</a><ul><li><a href="#h4-1">Principe de base</a><ul><li><a href="#h4-1-1">Requete envoy√© par l'utilisateur pour s'authentifier</a></li><li><a href="#h4-1-2">Interpr√©tation par le serveur</a></li><li><a href="#h4-1-3">Attaquer cette m√©canique</a></li><li><a href="#h4-1-4">Interpr√©tation de la requ√™te par le serveur</a></li></ul></li><li><a href="#h4-2">UNION attack</a><ul><li><a href="#h4-2-1">Sp√©cificit√©s d'une UNION</a></li><li><a href="#h4-2-2">Trouver le nombre de colonnes</a></li><li><a href="#h4-2-3">Trouver le type de donn√©es envoy√©es</a></li><li><a href="#h4-2-4">1 seule colonne</a></li><li><a href="#h4-2-5">Versions</a></li><li><a href="#h4-2-6">Avoir le nom des tables</a></li></ul></li><li><a href="#h4-3">CheatSheet</a></li></ul></li><li><a href="#h5">D√©fense</a></li></ul><h2 id="h2">Pourquoi cette attaque ?</h2><p>Tout site web, sauf sites statiques, h√©berge une base de donn√©es SQL. Donc tous les sites web sont des potentielles victimes d'attaques par injection de SQL.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Information</b></p></div><div class="pl-8 mr-8"><p>D'apr√®s les chiffres d'Akamai (<a href="https://www.akamai.com/site/en/documents/state-of-the-internet/soti-security-api-the-attack-surface-that-connects-us-all.pdf">lien de l'article</a>), sur une √©tude men√©e entre Janvier 2020 et Juin 2021 :</p><ul><li>les attaques de type injection de SQL sont les plus pr√©sentes</li><li>durant la dur√©e d'√©tude (18 mois) il y a eu 6.2 millards de tentatives d'attaques enregistr√©es par injection de SQL, ce qui repr√©sente 55.88% des attaques sur le web.</li></ul></div></div><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Durand-Jean-Baptiste/mon/temps-1.2/nb_attaque_sql.png" alt="Technologies utilis√©es" style="height:500px;margin:0 auto;border:0"><p><em>Graphique provenant du m√™me article</em></p><h2 id="h3">BurpSuite</h2><p>BurpSuite est un logiciel permettant de capturer des requ√™tes effectu√©es sur un navigateur internet, de les modifier, de les renvoyer r√©guli√®rement. C'est un outil tr√®s utile, voir n√©cessaire pour faire de l'analyse d'API ou pour faire des attaques par injection.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg><div class="pl-8 mb-2 mr-8"><p>Voici tous les d√©tails pour t√©l√©charger BurpSuite :</p></div><div class="pl-8 mr-8"><ul><li><a href="https://portswigger.net/burp/releases/professional-community-2022-8-5?requestededition=community&amp;requestedplatform=">Download</a></li><li><a href="https://portswigger.net/burp/documentation/desktop/external-browser-config/browser-config-firefox">Setup Proxy</a></li><li><a href="https://portswigger.net/burp/documentation/desktop/external-browser-config/certificate/ca-cert-firefox">BurpSuite Certificate</a></li></ul></div></div><p>Le site web de BurpSuite propose un service appel√© WebSecurityAcademy qui permet de tester diff√©rentes attaques, l'enti√®ret√© des exemples de ce cours provient de ce site :</p><p><a href="https://portswigger.net/web-security/all-labs#sql-injection">WebSecurityAcademy - SQL injection</a></p><h2 id="h4">SQL injection</h2><h3 id="h4-1">Principe de base</h3><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Beaucoup de fonctionnalit√©s d'un serveur n√©cessitent appels √† une base de donn√©es SQL, avec pour param√®tres des √©l√©ments envoy√©s par l'utilisateur.</p></div></div><p>Par exemple lors d'une connexion, un utilisateur rentre son nom d'utilisateur et son mot de passe. Puis le serveur authentifie l'utilisateur en v√©rifiant que les donn√©es saisies sont bien pr√©sentes dans la base de donn√©e des utilisateurs :</p><h4 id="h4-1-1">Requete envoy√© par l'utilisateur pour s'authentifier</h4><pre class="language-javascript line-numbers"><code>

fetch("https://nomDuServeur/login",
{
    method: "POST",                     //permet d'envoyer des donn√©es au serveur
    body: JSON.stringify(
      {
        username : "mon_username",      //permet d'envoyer les informations au serveur
        password : "mon_password"
      }
    )
})


</code></pre><h4 id="h4-1-2">Interpr√©tation par le serveur</h4><pre class="language-sql line-numbers"><code>

SELECT * FROM users WHERE username = ' + requete.username + ' AND password = ' + requete.password + '


</code></pre><p>ce qui donne ici :</p><pre class="language-sql line-numbers"><code>

SELECT * FROM users WHERE username = 'mon_username' AND password = 'mon_password'


</code></pre><h4 id="h4-1-3">Attaquer cette m√©canique</h4><p>L'objectif est de ne pas avoir √† passer l'√©tape de v√©rification du mot de passe.</p><p>Pour √ßa, on va utiliser une m√©canique assez simple en programmation : <strong>les commentaires</strong>.</p><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Pour une base de donn√©e Oracle, Microsoft ou PostgreSQL, les commentaires sont fait par <strong>--</strong> Pour une base de donn√©e qui utilise MySQL, les commentaires sont fait par <strong>#</strong> qui vaut <strong>%23</strong> en hexad√©cimal</p></div></div><p>Donc si on termine le <em>username</em> envoy√© dans la requ√™te par un comentaire, il n'y aura pas de v√©rificaton du <em>password</em>.</p><pre class="language-javascript line-numbers"><code>

fetch("https://nomDuServeur/login",
{
    method: "POST",
    body: JSON.stringify(
      {
        username : "administrateur%27--",
        password : "n'importeQuoi"
      }
    )
})


</code></pre><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Le caract√®re <strong>%27</strong> correspond au symbole <strong>'</strong> de fermeture de chaine de caract√®re, il permet de dire que le nom d'utilisateur est fini. Pourquoi on utilise √ßa plut√¥t que <strong>'</strong> ? Le serveur va rajouter un caract√®re d'√©chappement devant les caract√®res qu'il utilise notamment <strong>'</strong>, mais pas devant sa forme hexad√©cimale <strong>%27</strong></p></div></div><h4 id="h4-1-4">Interpr√©tation de la requ√™te par le serveur</h4><pre class="language-sql line-numbers"><code>

SELECT * FROM users WHERE username = 'administarteur'--' AND password = 'n\'importeQuoi'


</code></pre><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Information</b></p></div><div class="pl-8 mr-8"><p>Et l√†, vous √™tes connect√©s en tant qu'administrateur du site.</p></div></div><h3 id="h4-2">UNION Attack</h3><p>C'est sympa de pouvoir se connecter √† la place de l'administrateur, mais si l'administrateur ne s'appelle pas <strong>administrateur</strong>, comment est ce qu'on peut faire pour quand m√™me se connecter ?</p><p>Jusque l√†, on √©tait limit√© par le fait de devoir faire des recherches dans la table par d√©faut de la requ√™te : il est impossible de modifier la requ√™te avant un <strong>WHERE</strong> qui se situe forc√©ment apr√®s le <strong>FROM</strong>. <em>On veut pouvoir effectuer nos propre requ√™tes dans d'autres table.</em></p><p>Pour cela on va utiliser le mot cl√© SQL <strong>UNION</strong> qui va r√©aliser la concat√©nation de 2 recherches dans la base de donn√©e : celle par d√©faut et celle inject√©e.</p><h4 id="h4-2-1">Sp√©cificit√©s d'une UNION</h4><p>Il est pas possible de simplement mettre ce qu'on veut dans la 2e recherche de l'<strong>UNION</strong>, il y a certaines contraintes :</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100 dark:border-yellow-800 dark:bg-yellow-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-yellow-500 dark:stroke-yellow-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Faire</b></p></div><div class="pl-8 mr-8"><ul><li><p>Il doit avoir autant de valeurs de retour des 2 recherches : ex : si la recherche par d√©faut envoie 2 informations (un nom et pr√©nom d'utilisateur par exemple), la 2e recherche devra envoyer exactement 2 informations</p></li><li><p>Les valeurs de retour doivent √™tre de m√™me type : ex : le nom et pr√©nom sont 2 chaines de caract√®res, la 2e recherche devra envoyer exactement 2 chaines de caract√®res</p></li></ul></div></div><h4 id="h4-2-2">Trouver le nombre de colonnes</h4><p>Premi√®rement, il faut trouver le nombre de valeur de retour de la premi√®re recherche. Pour cela il y a <strong>2 possibilit√©s</strong> :</p><ul><li>Ordonner la premi√®re recherche selon la ni√®me colonne, grace au mot cl√© <strong>ORDER BY n</strong>, si il y a une errreur c'est que la colonne <strong>n</strong> n'existe pas.</li><li>Faire une 2e recherche (avec une <strong>UNION</strong>) en envoyant simplement des <strong>NULL</strong>, l'objectif √©tant de trouver combien on peut mettre de <strong>NULL</strong> sans avoir d'erreur :</li></ul><pre class="language-sql line-numbers"><code>

UNION SELECT NULL,NULL


</code></pre><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Remarque 1 : il n'est pas possible pour une base de donn√©e Oracle de faire des requ√™tes sans le mot cl√© <strong>FROM</strong>, pour cela, il existe une table faite pour √ßa : <strong>dual</strong></p></div></div><pre class="language-sql line-numbers"><code>

UNION SELECT NULL,NULL FROM dual


</code></pre><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Remarque 2 : √† partir de maintenant, on est oblig√© d'avoir des <em>espaces</em> dans nos requ√™tes (entre ORDER et BY ou entre UNION et SELECT), or il est pas possible de faire une requ√®te HTTP avec des espaces dans les param√®tres. Pour cela, <strong>il faut remplacer tous les espaces par le caract√®re +</strong></p></div></div><h4 id="h4-2-3">Trouver le type de donn√©es envoy√©es</h4><p>Maintenant qu'on a le nombre de colonnes, il faut tester un par un les param√®tres pour savoir quel est le type du param√®tre :</p><p>On envoie <strong>UNION 'string',NULL,NULL</strong> (si 3 colonnes), puis <strong>UNION 0,NULL,NULL</strong>, jusqu'√† trouver le type de la premi√®re colonne et ainsi de suite.</p><p>La remarque faite sur Oracle dans la pr√©c√©dente partie est toujours applicable ici.</p><h4 id="h4-2-4">1 seule colonne</h4><p>Si un il y a uniquement un champ <em>string</em> disponible, et qu'on veut afficher plusieurs sorties en m√™me temps (par exemple le <em>username</em> et le <em>password</em> d'un utilisateur), on peut utiliser la fonction <strong>CONCAT</strong> de SQL:</p><pre class="language-sql line-numbers"><code>

SELECT CONCAT(username,'/',password) from users


</code></pre><h4 id="h4-2-5">Versions</h4><p>Il peut √™tre interressant de connaitre la version de la base de donn√©e pour effectuer des attaques cibl√©es sur la version. Les requ√™tes d√©pendent de la base de donn√©e :</p><ul><li><em>Oracle</em> : <strong>SELECT banner FROM v$version</strong></li><li><em>Microsoft</em> : <strong>SELECT @@version</strong></li><li><em>PostgreSQL</em> : <strong>SELECT version()</strong></li><li><em>MySQL</em> : <strong>SELECT @@version</strong></li></ul><p>Si besoin <strong>@</strong> = <strong>%40</strong> et <strong>$</strong> = <strong>%24</strong></p><h4 id="h4-2-6">Avoir le nom des tables</h4><p>Pour effectuer nos recherche, il faut avoir le nom des tables et de colonnes, pour cela on peut effectuer, dans un requete <strong>UNION</strong>, les recherches suivantes :</p><p><strong>Non Oracle</strong></p><pre class="language-sql line-numbers"><code>

SELECT TABLE_NAME FROM information_schema.tables
SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'TABLE-NAME-HERE'



</code></pre><p><strong>Oracle</strong></p><pre class="language-sql line-numbers"><code>

SELECT TABLE_NAME FROM all_tables
SELECT COLUMN_NAME FROM all_tab_columns WHERE TABLE_NAME = 'TABLE-NAME-HERE'


</code></pre><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Ne pas oublier de rajouter des colonnes <strong>NULL</strong> au cas o√π il faille plusieurs colonnes avec l'<strong>UNION</strong></p></div></div><h4 id="h4-3">CheatSheet</h4><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg><div class="pl-8 mb-2 mr-8"><p>Les informations plus sp√©cifiques li√©s aux serveur SQL sont dans ce document : <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">lien</a></p></div><div class="pl-8 mr-8"></div></div><h2 id="h5">D√©fense</h2><p>Il est possible de param√©trer une requ√™te SQL, c'est-√†-dire transformer une requ√™te en une fonction prenant en param√®tre les valeurs de la requ√™te.</p><p>Au lieu d'executer :</p><pre class="language-javascript line-numbers"><code>

String query = "SELECT * FROM products WHERE category = '"+ input + "'";
Statement statement = connection.createStatement();
ResultSet resultSet = statement.executeQuery(query);


</code></pre><p>On cr√©e un statement sans les valeurs, puis on ajoute les param√®tres :</p><pre class="language-javascript line-numbers"><code>

PreparedStatement statement = connection.prepareStatement("SELECT * FROM products WHERE category = ?");
statement.setString(1, input);
ResultSet resultSet = statement.executeQuery();


</code></pre><p>Voici les 3 liens o√π on peut retrouver des exemples de code en fonction des languages utilis√©s :</p><ul><li><a href="https://www.hacksplaining.com/prevention/sql-injection">hacksplaining</a></li><li><a href="https://portswigger.net/web-security/sql-injection">PortSwigger</a></li><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">OWASP</a></li></ul><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100 dark:border-red-800 dark:bg-red-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-red-500 dark:stroke-red-800 stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div class="pl-8 mb-2 mr-8"><p><strong>Attention</strong> aux ORM</p></div><div class="pl-8 mr-8"><p>Un ORM est un outils permettant de faciliter la communication entre le serveur et la base de donn√©e. Un ORM n'est pas forc√©ment une protexion contre les injections de SQL.</p></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100 dark:border-cyan-800 dark:bg-cyan-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-cyan-500 dark:stroke-cyan-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Information</b></p></div><div class="pl-8 mr-8"><p>Pour savoir si votre serveur est prot√©g√© contre ce type d'attaques, n'oubliez pas de <strong>tester</strong> par vous m√™me <strong>la s√©curit√©</strong> de votre site.</p></div></div></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>