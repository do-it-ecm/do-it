<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2022-2023/Adelain-thibault/mon/temps-3.2/"><meta name="description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta property="og:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="twitter:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="author" content="Thibault Adelain"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, wireshark, reseaux, tcp, s√©curit√© informatique"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="Wireshark : analyse de paquets"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Adelain-thibault/mon/temps-3.2/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="Wireshark : analyse de paquets"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Adelain-thibault/mon/temps-3.2/"><title>Wireshark : analyse de paquets</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">Wireshark : analyse de paquets</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">wireshark</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">reseaux</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">tcp</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">s√©curit√© informatique</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Thibault Adelain</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2022-2023</span></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2022-2023/Adelain-thibault/">Thibault Adelain</a><span class="px-1">/</span><a href="/promos/2022-2023/Adelain-thibault/mon/">MONs de Thibault</a><span class="px-1">/</span><a href="/promos/2022-2023/Adelain-thibault/mon/temps-3.2/">Wireshark : analyse de paquets</a></div></div><ul><li>Wireshark : analyse de paquets</li><li>Niveau : d√©butant √† interm√©diaire</li></ul><h2 id="analyse-de-paquets-avec-wireshark" tabindex="-1"><a class="header-anchor" href="#analyse-de-paquets-avec-wireshark"></a> Analyse de paquets avec Wireshark</h2><p><a href="https://www.wireshark.org/">Wireshark</a> est un logiciel libre et gratuit qui permet d'analyser le trafic r√©seau en capturant et en examinant les paquets de donn√©es qui circulent sur un r√©seau. Il est largement utilis√© par les professionnels de la s√©curit√© informatique, les administrateurs r√©seaux... pour diagnostiquer les probl√®mes de r√©seau et d√©tecter les √©ventuelles attaques.</p><p>L'analyse de paquets avec Wireshark permet de comprendre le fonctionnement d'un r√©seau en examinant le contenu de chaque paquet de donn√©es qui y circule. Wireshark peut capturer et afficher diff√©rents types de paquets tels que les paquets TCP, UDP, ICMP, DNS... En fait, quasiment tous le trafic r√©seau transitant par la machine. En examinant les en-t√™tes de chaque paquet, il est possible de comprendre comment les donn√©es sont achemin√©es √† travers le r√©seau, quelle est l'origine et la destination de chaque paquet, quels sont les ports utilis√©s, et quelle est la nature des donn√©es transmises... Les possibilit√©s sont grandes et ce MON n'en donnera qu'un avant-go√ªt.</p><p>Wireshark permet, entre autres, de :</p><ul><li>Capturer et filtrer les paquets en fonction de diff√©rents crit√®res tels que l'adresse IP, le port, le protocole, etc.</li><li>Afficher des statistiques sur le trafic r√©seau (par exemple, le nombre de paquets envoy√©s et re√ßus, le d√©bit de donn√©es, etc.)</li><li>Examiner le contenu des paquets, y compris les donn√©es brutes et les donn√©es applicatives (par exemple, les requ√™tes HTTP, les requ√™tes DNS, etc.)</li><li>D√©tecter les attaques r√©seau telles que les attaques de d√©ni de service, les attaques de spoofing, les scans r√©seaux...</li><li>etc</li></ul><p>Il peut √™tre int√©ressant pour un expert en cybers√©curit√©, administration r√©seau, d√©veloppement de savoir utiliser ce logiciel.</p><ul><li>Il pourra avoir une vision plus claire des donn√©es qui transitent sur le r√©seau et comprendre les protocoles en profondeur pour en tirer d'√©ventuels exploits.</li><li>Les hacker sont de plus en plus cr√©atifs pour contourner les IDS et une analyse au niveau des paquets est parfois n√©cessaire pour d√©tecter les attaques.</li><li>Le logiciel peut permettre de comprendre d'o√π vient la latence pour se connecter √† une application (pas assez de d√©bit, retransmission de paquets car probl√®me applicatif...). √ânorm√©ment de probl√®mes de latence sont r√©gl√©s en redescendant au niveau des paquets.</li><li>etc</li></ul><p><strong><a href="https://www.wireshark.org/download.html">Le logiciel est t√©l√©chargeable ici</a>.</strong></p><h2 id="mod%C3%A8le-osi" tabindex="-1"><a class="header-anchor" href="#mod%C3%A8le-osi"></a> Mod√®le OSI</h2><p>Le mod√®le OSI (Open Systems Interconnection) est un mod√®le de r√©f√©rence en informatique qui d√©finit les normes de communication entre les diff√©rents syst√®mes informatiques. Ce mod√®le a √©t√© d√©velopp√© par l'ISO (International Organization for Standardization) dans les ann√©es 1980 afin de standardiser les communications entre les ordinateurs de diff√©rents fabricants et de diff√©rentes plateformes.</p><p>Le mod√®le OSI est constitu√© de sept couches, chacune repr√©sentant une √©tape sp√©cifique dans le processus de communication entre les syst√®mes. Ces couches sont :</p><ul><li>Couche physique : cette couche repr√©sente le support physique de la communication.<ul><li>ex de protocole : Fibre optique, c√¢ble, ondes radio...</li></ul></li><li>Couche liaison de donn√©es : cette couche est responsable de la gestion de la transmission de donn√©es entre les √©quipements connect√©s.<ul><li>ex : ethernet, wifi...</li></ul></li><li>Couche r√©seau : cette couche est responsable de la transmission de donn√©es entre les r√©seaux diff√©rents, en utilisant des protocoles de routage.<ul><li>ex : IP, ICMP, ARP...</li></ul></li><li>Couche transport : cette couche est responsable de la gestion de la transmission de donn√©es de bout en bout.<ul><li>ex : TCP, UDP, QUIC...</li></ul></li><li>Couche session : cette couche permet l'√©tablissement, la gestion, la fermeture de sessions, le chiffrement entre les applications des diff√©rents syst√®mes.<ul><li>ex : SOCKS, (TLS, SSL) ?</li></ul></li><li>Couche pr√©sentation : cette couche est responsable de la pr√©sentation des donn√©es aux applications, en g√©rant les formats de donn√©es, le chiffrement et la compression.<ul><li>ex : (TLS, SSL) ?</li></ul></li><li>Couche application : cette couche repr√©sente les applications elles-m√™mes et leur interface avec les autres couches du mod√®le OSI.<ul><li>ex : HTTP, SMTP, FTP, DNS, SSH...</li></ul></li></ul><p>Le mod√®le OSI permet de standardiser la communication entre les diff√©rents syst√®mes informatiques en s√©parant les diff√©rentes √©tapes de la communication en couches distinctes. Cela facilite la conception de nouveaux protocoles de communication, la r√©solution des probl√®mes et la compatibilit√© entre les diff√©rents syst√®mes. Le mod√®le OSI est largement utilis√© dans l'industrie des r√©seaux informatiques pour comprendre et d√©panner les probl√®mes de communication entre les diff√©rents √©quipements et applications.</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Adelain-thibault/mon/temps-3.2/modele_osi.png" alt="mod√®le osi"> par <a href="https://cisco.goffinet.org/ccna/fondamentaux/modeles-tcp-ip-osi/">cisco.goffinet.org</a>.</p><h2 id="ping-pong" tabindex="-1"><a class="header-anchor" href="#ping-pong"></a> PING PONG</h2><h4 id="d%C3%A9finition" tabindex="-1"><a class="header-anchor" href="#d%C3%A9finition"></a> D√©finition</h4><p>Lorsque vous envoyez un ping √† un serveur, vous utilisez le protocole ICMP pour tester la connectivit√© r√©seau entre votre syst√®me et le serveur. Le ping envoie un message ICMP ECHO_REQUEST √† l'adresse IP du serveur que vous voulez tester. Le serveur recevra alors ce message et r√©pondra avec un message ICMP ECHO_REPLY. Voici comment cela se d√©roule en d√©tail :</p><ul><li><p>Envoi du PING (ICMP ECHO_REQUEST) : Lorsque vous envoyez un ping √† un serveur, votre syst√®me envoie un message ICMP ECHO_REQUEST √† l'adresse IP du serveur. Ce message contient un champ d'identification et un champ de num√©ro de s√©quence, ainsi qu'un champ de donn√©es qui peut √™tre utilis√© pour transporter des informations suppl√©mentaires.</p></li><li><p>R√©ception du PING et envoi du PONG (ICMP ECHO_REPLY).</p></li><li><p>R√©ception du PONG : votre syst√®me utilise le champ d'identification et le champ de num√©ro de s√©quence pour identifier la r√©ponse correspondante √† la demande d'envoi de ping et calcule le temps √©coul√© entre l'envoi et la r√©ception de la r√©ponse. Cela permet √† votre syst√®me de mesurer le temps de latence entre votre syst√®me et le serveur.</p></li></ul><p>Si le serveur ne r√©pond pas au message ICMP ECHO_REQUEST, la machine n'est pas atteignable / n'a pas r√©pondu. Le ping est utilis√© pour diagnostiquer les probl√®mes de r√©seau et tester la connectivit√© entre les syst√®mes.</p><h4 id="dans-wireshark" tabindex="-1"><a class="header-anchor" href="#dans-wireshark"></a> Dans Wireshark</h4><p>On lance la capture de paquets. Avec la commande <code>ping google.com</code> :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Adelain-thibault/mon/temps-3.2/capture_icmp.png" alt="Capture ICMP"></p><p>Pour trouver les paquets en question, on peut utiliser des filtres. Je vous renvoie √† <a href="https://www.youtube.com/watch?v=aEss3CG49iI&amp;ab_channel=DavidBombal">cette vid√©o</a> pour avoir plus de d√©tails. Par exemple, on peut filtrer avec :</p><p><code>ip.addr == 192.168.1.21 &amp;&amp; icmp</code></p><p>Ensuite, on peut prendre un paquet et faire [clique droit &gt; conversation filter &gt; ethernet] pour avoir son contexte.</p><p>On a :</p><ul><li>Une requ√™te + r√©ponse DNS pour r√©soudre l'IP de <a href="http://google.com">google.com</a></li><li>ping request et ping response.</li></ul><p>On peut examiner les paquets en d√©tail et s'int√©resser au champs pr√©sents dans un paquet ICMP (source ip, destination ip, <a href="https://fr.wikipedia.org/wiki/Time_to_Live">ttl</a>...)</p><p>Assez simple, jusque-l√†. On peut aussi recommencer une capture et pr√©ciser la payload (nombre d'octets) √† envoyer par <a href="https://fr.wikipedia.org/wiki/Trame_(informatique)">trame</a> :</p><p><code>ping -s 1500 google.com</code></p><p>puis :</p><p><code>ping -s 1500 -D google.com</code></p><p>Et l√†, probl√®me. Vous pouvez essayer de comprendre dans Wireshark et allez voir <a href="https://www.youtube.com/watch?v=J-gnDC6B5eE&amp;t=3312s&amp;ab_channel=DavidBombal">cette ressource</a> pour en savoir plus.</p><h2 id="tcp" tabindex="-1"><a class="header-anchor" href="#tcp"></a> TCP</h2><h4 id="d%C3%A9finition-1" tabindex="-1"><a class="header-anchor" href="#d%C3%A9finition-1"></a> D√©finition</h4><p>TCP (Transmission Control Protocol) est un protocole de transport fiable et orient√© connexion utilis√© pour la transmission de donn√©es sur les r√©seaux informatiques. Il est l'une des deux options principales de la couche transport du mod√®le OSI (l'autre √©tant UDP). TCP fournit une communication bidirectionnelle, de bout en bout et fiable, c'est-√†-dire qu'il garantit la livraison des donn√©es sans erreur.</p><p>Pour cela, TCP utilise une m√©thode appel√© le three-way handshake. Le 3-way handshake est un m√©canisme de synchronisation √† trois √©tapes utilis√© par TCP pour √©tablir une connexion fiable et orient√©e connexion entre deux syst√®mes. Voici les √©tapes du 3-way handshake :</p><ul><li><p>SYN : Le syst√®me √©metteur envoie un segment SYN (Synchronize) au syst√®me destinataire pour indiquer qu'il souhaite √©tablir une connexion TCP. Ce segment contient un num√©ro de s√©quence initial choisi par l'√©metteur. Dans wireshark, un num√©ro not√© <em>relative sequence number</em> est ramen√© √† 0 pour nous faciliter le comptage, mais il s'agit en fait d'un tr√®s grand nombre al√©atoire pour identifier de mani√®re unique la connection TCP en cours (dans wireshark, il s'appelle <em>sequence number (raw)</em>).</p></li><li><p>SYN-ACK : Le syst√®me destinataire r√©pond avec un segment SYN-ACK (Synchronize-Acknowledgment) pour indiquer qu'il est pr√™t √† √©tablir la connexion. Ce segment contient entre autres : Dans le SYN, un nouveau num√©ro de s√©quence. Dans le ACK, le num√©ro de s√©quence initial choisi par l'√©metteur initial + 1.</p></li><li><p>ACK : Le syst√®me √©metteur r√©pond avec un segment ACK pour confirmer la r√©ception du segment SYN du destinataire. Ce segment contient √©galement le num√©ro de s√©quence du SYN du destinataire + 1, qui indique que la connexion a √©t√© √©tablie avec succ√®s.</p></li></ul><p>Une fois que le 3-way handshake est termin√©, les deux syst√®mes peuvent commencer √† √©changer des donn√©es de mani√®re fiable et ordonn√©e. Les segments de donn√©es envoy√©s par TCP contiennent un num√©ro de s√©quence qui permet √† celui qui r√©ceptionne les donn√©es de les r√©assembler dans le bon ordre.</p><h4 id="dans-wireshark-1" tabindex="-1"><a class="header-anchor" href="#dans-wireshark-1"></a> Dans Wireshark</h4><p><a href="https://www.youtube.com/watch?v=rmFX1V49K8U&amp;list=PLW8bTPfXNGdCR0RjCBwHM0EzfVKQfpn1m&amp;ab_channel=DavidBombal">Ressource</a>.</p><p>On lance la capture de paquets. Avec la commande <code>curl google.com</code> :</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Adelain-thibault/mon/temps-3.2/capture_tcp.png" alt="capture_tcp"></p><p>Pour avoir la capture en question, on peut appliquer le filtre <code>http</code>. Ensuite, [clique droit &gt; follow TCP stream] sur le paquet.</p><p><em>Note</em> : pour ajouter des colonnes : dans le cadre en bas √† gauche, clique droit sur la donn√©e et apply as a column</p><p>Les trois premiers paquets correspondent √† l'√©tablissement de la connexion : SYN, SYN-ACK, ACK. Je vous invite √† √©tudier ces paquets.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>On voit un lien entre le <em>acknowledgment number</em> et <em>TCP Segment Length</em>, non ?</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><p>En fait, le <em>acknowledgment number</em> est incr√©ment√© de 1 + taille du paquet re√ßu √† chaque r√©ception</p></div></details></div><h2 id="analyse-scan-nmap" tabindex="-1"><a class="header-anchor" href="#analyse-scan-nmap"></a> Analyse scan Nmap</h2><h4 id="scan-full-tcp-connect" tabindex="-1"><a class="header-anchor" href="#scan-full-tcp-connect"></a> Scan Full TCP connect</h4><p><strong>Exo :</strong> faites un scan <a href="https://nmap.org/">nmap</a> full TCP connect sur une machine de votre r√©seau. Comment d√©tecter que c'est un scan Nmap ?</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>R√©ponse</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><p><code>nmap -sT 192.168.1.1</code> En regardant paquet par paquet, c'est difficile √† remarquer... Chaque paquet TCP est normal et comporte toutes les options classiques d'un paquet TCP. Le comportement global est cependant √©trange (SYN, SYN-ACK, ACK, RST-ACK), on √©tablit une connection pour la fermer brutalement ensuite (flag RESET : &quot;Le bit de r√©initialisation a √©t√© pr√©vu pour des situations comme celle o√π un ordinateur A ¬´ plante ¬ª ou est √©teint alors qu'une connexion TCP √©tait en cours avec un ordinateur B.&quot; <a href="https://fr.wikipedia.org/wiki/Attaque_TCP_reset">wikipedia</a>). On aurait pu aussi pr√©ciser le port pour √©viter de tout scanner et d'√©veiller les soup√ßons. Finalement, on comprend facilement qu'un scan comme √ßa est facile √† d√©tecter par les IDS. <img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Adelain-thibault/mon/temps-3.2/capture_nmap_full_tcp.png" alt="capture nmap full tcp"></p></div></details></div><h4 id="syn-(%22stealth%22)-scan" tabindex="-1"><a class="header-anchor" href="#syn-(%22stealth%22)-scan"></a> SYN (&quot;stealth&quot;) scan</h4><p><strong>Exo :</strong> faites un SYN scan <a href="https://nmap.org/">nmap</a> sur une machine de votre r√©seau. Comment d√©tecter que c'est un scan Nmap ?</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>R√©ponse</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><p><code>sudo nmap -sS 192.168.1.1</code> Si on a r√©ussi √† √©tablir une connexion, on a ceci dans wireshark : <img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Adelain-thibault/mon/temps-3.2/capture_nmap_syn_scan.png" alt="capture syn scan"> On voit que le client envoie un SYN, le server revoie un SYN-ACK pour √©tablir une connexion TCP, et ensuite... plus de r√©ponse. Le serveur retransmet alors son SYN-ACK, en supposant qu'il n'a pas √©t√© re√ßu, et recommence toutes les <code>~ 2 * delta</code>. Le SYN scan envoie un paquet SYN et attend un SYN-ACK en retour, mais ne renvoie pas de ACK au serveur. Il est donc normal d'avoir ce genre de stream. Mais du point de vue du serveur, c'est difficile √† d√©tecter, car tout se passe comme si le paquet r√©ponse s'√©tait perdu en chemin (d'o√π la retransmission). Cependant, en regardant attentivement, on voit que le premier SYN envoy√© par le client n'est pas identique √† ceux de tout √† l'heure. Et oui, regardez dans les options TCP... que 4 octets. C'est tr√®s √©trange, normalement un paquet TCP SYN a au moins une vingtaine d'octets d'options. Finalement, On voit qu'un <em>stealth scan</em> n'est pas si <em>stealth</em> que √ßa...</p></div></details></div><h2 id="sources" tabindex="-1"><a class="header-anchor" href="#sources"></a> Sources</h2><ul><li>David Bombal and Chris Greer using Wireshark : <a href="https://www.youtube.com/watch?v=rmFX1V49K8U&amp;list=PLhfrWIlLOoKO8522T1OAhR5Bb2mD6Qy_l&amp;ab_channel=DavidBombal">https://www.youtube.com/watch?v=rmFX1V49K8U&amp;list=PLhfrWIlLOoKO8522T1OAhR5Bb2mD6Qy_l&amp;ab_channel=DavidBombal</a></li></ul></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>