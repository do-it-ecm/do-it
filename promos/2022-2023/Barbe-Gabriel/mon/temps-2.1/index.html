<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2022-2023/Barbe-Gabriel/mon/temps-2.1/"><meta name="description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta property="og:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="twitter:description" content="Do-It, cours et travaux des √©l√®ves de l&#39;√©cole Centrale M√©diterran√©e"><meta name="author" content="Gabriel BARBE"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, serveur"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="Cot√© Web"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Barbe-Gabriel/mon/temps-2.1/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="Cot√© Web"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2022-2023/Barbe-Gabriel/mon/temps-2.1/"><title>Cot√© Web</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">Cot√© Web</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">serveur</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Gabriel BARBE</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2022-2023</span></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2022-2023/Barbe-Gabriel/">Gabriel Barb√©</a><span class="px-1">/</span><a href="/promos/2022-2023/Barbe-Gabriel/mon/">MON de Gabriel</a><span class="px-1">/</span><a href="/promos/2022-2023/Barbe-Gabriel/mon/temps-2.1/">Cot√© Web</a></div></div><p>MON sur le developpement c√¥t√© serveur suivi sur le site de M. Brucker puis sur mdn developper.<br>Nous apprendrons entre autre √† cr√©er une base de donn√©es, l'utiliser, la modifier depuis le site web mais aussi apprendre le &quot;back-end&quot; et l'associer au &quot;front-end&quot;. Ce cours sera constitu√© de deux partie.<br>Niveau : Interm√©diaire<br>Pr√©requis : <a href="Devweb1.md">DevWeb1</a>, <a href="./Devweb2.md">DevWeb2</a></p><h2 id="pr%C3%A9ambule" tabindex="-1"><a class="header-anchor" href="#pr%C3%A9ambule"></a> Pr√©ambule</h2><p>J'ai affich√© un niveau interm√©diaire mais j'aurais tout aussi bien pu mettre facile, en effet le cours est relativement accessible √©tant donn√© que je suis moi-m√™me un d√©butant, et qu'avec le temps allou√© j'ai √©t√© capable d'effectuer les taches voulues. N√©anmoins, pour les d√©butants, il vous faudra sortir de votre zone de confort et √™tre motiv√© car il y a des passages quelques peu ardus o√π avoir un projet en t√™te aide. Pour moi ce cours a √©t√© suivi dans l'id√©e de r√©aliser mon projet <a href="/src/pok/GB-TB/index.md">PFC</a> que vous pouvez aussi visiter pour mieux comprendre mes intentions.<br>Mes sources principales sont le cours de Fran√ßois Brucker <a href="https://francoisbrucker.github.io/cours_informatique/cours/web/">Web</a> et un cours en anglais sur le site <a href="https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs/development_environment">MDN Developer</a><br>Bon cours !</p><h2 id="cot%C3%A9-serveur" tabindex="-1"><a class="header-anchor" href="#cot%C3%A9-serveur"></a> Cot√© serveur</h2><h3 id="lire-des-donn%C3%A9es" tabindex="-1"><a class="header-anchor" href="#lire-des-donn%C3%A9es"></a> Lire des donn√©es</h3><p>Afin de lire des donn√©es sur un site web et les r√©utiliser ensuite, on utilise la fonction javascript &quot;fetch&quot;. Cette derni√®re est fondamentale dans l'utilisation des bases de donn√©es. La fonction fetch peut √™tre utilis√© sur des fichiers textes, des images ou du json (<a href="./Devweb1.md">voir Devweb 1</a>) √† condition que ces derni√®res soient sur un serveur web !</p><h3 id="serveur-web-minimal" tabindex="-1"><a class="header-anchor" href="#serveur-web-minimal"></a> Serveur web minimal</h3><p>On peut cr√©er un &quot;serveur minimal&quot; gr√¢ce √† node simplement avec la commande shell :</p><pre class="language-bash line-numbers"><code>

node index.js


</code></pre><p>Cette commande cr√©e un serveur minimal en local. Ce serveur suit le protocole http c'est √† dire une suite de requ√™te de l'utilsateur et de r√©ponse de la machine.</p><h3 id="cr%C3%A9ation-du-premier-projet-gr%C3%A2ce-%C3%A0-node%2Fexpress" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9ation-du-premier-projet-gr%C3%A2ce-%C3%A0-node%2Fexpress"></a> Cr√©ation du premier projet gr√¢ce √† Node/Express</h3><p>Express est un framework de node, lui-m√™me environnement de d√©veloppement, permettant de coder des sites c√¥t√©s serveurs. Tout l'int√©ret de l'apprentissage de ce MON est de basculer le site cr√©er avec le premier POK : &quot;Mon site chez moi&quot; cot√© serveur.<br>Le framework Express cr√©e tout le &quot;squelette&quot; de notre site web et l'importe sur un serveur local. Ce serveur est localis√© √† <a href="http://localhost:3000/">http://localhost:3000/</a>. Nous obtenons donc notre premier site web sur serveur : <img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Barbe-Gabriel/mon/Images/Express.png"> Nous avons pour le moment les dossiers suivants dans notre environnement de programmation : <img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Barbe-Gabriel/mon/Images/Dossiers.PNG"></p><ul><li>le dossier &quot;bin&quot; contient un fichier &quot;www&quot; qui repr√©sente l'h√©bergement de notre site</li><li>les dossiers &quot;models&quot; ainsi que &quot;public&quot; sont vides pour le moment : &quot;models&quot; nous servira pour la base de donn√©es et &quot;public&quot; pour les images et les styles.</li><li>&quot;routes&quot; indique les routes</li><li>&quot;views&quot; est l√† o√π l'on code l'interface.</li><li>les fichiers &quot;.json&quot; sont l'identit√© de notre projet et le fichier app.js est l'endroit o√π l'on programme notre site et ressemble pour le moment √† ceci :</li></ul><pre class="language-bash line-numbers"><code>

var createError = require('http-errors');
var express = require('express');
var path = require('path');
var cookieParser = require('cookie-parser');
var logger = require('morgan');

var indexRouter = require('./routes/index');
var usersRouter = require('./routes/users');

var app = express();

// view engine setup
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'jade');

app.use(logger('dev'));
app.use(express.json());
app.use(express.urlencoded({ extended: false }));
app.use(cookieParser());
app.use(express.static(path.join(__dirname, 'public')));

app.use('/', indexRouter);
app.use('/users', usersRouter);

// catch 404 and forward to error handler
app.use(function(req, res, next) {
  next(createError(404));
});

// error handler
app.use(function(err, req, res, next) {
  // set locals, only providing error in development
  res.locals.message = err.message;
  res.locals.error = req.app.get('env') === 'development' ? err : {};

  // render the error page
  res.status(err.status || 500);
  res.render('error');
});

module.exports = app;


</code></pre><h3 id="utiliser-une-base-de-donn%C3%A9e" tabindex="-1"><a class="header-anchor" href="#utiliser-une-base-de-donn%C3%A9e"></a> Utiliser une base de donn√©e</h3><p>Dans cette troisi√®me partie nous apprenons √† ins√©rer une base de donn√©es sur notre site express via mongoose et mangodb. Cette partie fondamentale est surement la plus compliqu√© que j'ai effectu√©e en informatique depuis cette ann√©e.<br>Nous avons commenc√© par cr√©er un compte sur hhtp://cloud.mongodb.com/ puis le tout est de connecter notre application ou site avec la database pr√©sente sur le cloud. Pour se faire, nous utilisons le lien que nous donne mangodb : 'mongodb+srv://username:password!@cluster0.kngjtje.mongodb.net/?retryWrites=true&amp;w=majority' que nous lions avec notre projet dans le fichier app.js :</p><pre class="language-bash line-numbers"><code>

var mongoose = require('mongoose');
var dev_db_url = 'mongodb+srv://username:password!@cluster0.kngjtje.mongodb.net/?retryWrites=true&w=majority';
var mongoDB = process.env.MONGODB_URI || dev_db_url;
mongoose.connect(mongoDB, {useNewUrlParser: true, useUnifiedTopology: true});
mongoose.Promise = global.Promise;
var db = mongoose.connection;
db.on('error', console.error.bind(console, 'MongoDB connection error:'));


</code></pre><p>Nous cr√©√©ons ensuite une base de donn√©e comprenant des chaines de caract√®res, des dates, des nombres etc. Cette base est cr√©e par l'interm√©diaire d'un nouveau fichier &quot;populatedb.js&quot; qui nous sert √† peupler la base de donn√©es. Ce fichier contient par exemple des fonctions telles que :</p><pre class="language-bash line-numbers"><code>

function personCreate(first_name, family_name, d_birth, d_death, cb) {
  persondetail = {first_name:first_name , family_name: family_name }
  if (d_birth != false) persondetail.date_of_birth = d_birth
  if (d_death != false) persondetail.date_of_death = d_death
  
  var person = new Person(authordetail);
       
  person.save(function (err) {
    if (err) {
      cb(err, null)
      return
    }
    console.log('New Player: ' + person);
    persons.push(person)
    cb(null, person)
  }  );
}
function createGenrePersons(cb) {
    async.series([
        function(callback) {
          playerCreate('Patrick', 'Rothfuss', '1973-06-06', false, callback);
        },
        function(callback) {
          playerCreate('Ben', 'Bova', '1932-11-8', false, callback);
        },
    ]);
}


</code></pre><p>Cette fonction renvoi √† un autre fichier, &quot;person.js&quot;, stock√© dans &quot;models&quot; d√©finissant l'objet &quot;personne&quot;.</p><pre class="language-bash line-numbers"><code>

const mongoose = require("mongoose");

const Schema = mongoose.Schema;

const PersonSchema = new Schema({
  first_name: { type: String, required: true, maxLength: 100 },
  family_name: { type: String, required: true, maxLength: 100 },
  date_of_birth: { type: Date },
  date_of_death: { type: Date },
});

PersonSchema.virtual("name").get(function () {
 
  let fullname = "";
  if (this.first_name && this.family_name) {
    fullname = `${this.family_name}, ${this.first_name}`;
  }
  if (!this.first_name || !this.family_name) {
    fullname = "";
  }
  return fullname;
});

PersonSchema.virtual("url").get(function () {
  return `/catalog/person/${this._id}`;
});

// Export model
module.exports = mongoose.model("Person", PersonSchema);


</code></pre><p>Nous pouvons retrouver cette base de donn√©es √† tout moment sur mangodb : <img src="https://raw.githubusercontent.com/do-it-ecm/promo-2022-2023/refs/heads/main//Barbe-Gabriel/mon/Images/database.PNG"></p><h3 id="routes" tabindex="-1"><a class="header-anchor" href="#routes"></a> Routes</h3><p>D√©finition : Une route est une section de code qui associe un HTTP, un chemin URL et une fonction qui les associe sur le site.<br>Express poss√®de un middleware (sorte de pont entre diff√©rentes applications web) permettant de cr√©er des routes directement. Ce middleware permet de cr√©er des routes pour les requ√™tes : &quot;get&quot;, &quot;post&quot;, &quot;delete&quot;, &quot;copy&quot;, &quot;subscribe&quot;... et bien d'autres. Ainsi, pour chaque filtre de notre base de donn√©es, nous cr√©ons un fichier o√π l'on code toutes les requ√™tes souhait√©es. Nous pla√ßons ces fonctions dans un dossier &quot;controller&quot;.<br>Un exemple de fichier &quot;listController&quot; peut-√™tre :</p><pre class="language-bash line-numbers"><code>

const Element = require("../models/element");

//Liste tous les √©l√©ments
exports.list = (req, res) => {
  res.send("NOT IMPLEMENTED: Element list");
};


</code></pre><p>Ce code cr√©e un URL o√π l'on listera tous les √©l√©ments de notre base de donn√©es. Nous verrons plus tard comment l'associer r√©ellement √† notre BDD. Le code suivant permet ensuite de cr√©er la route en tant que tel, nous le pla√ßons donc dans le dossier express &quot;routes&quot; :</p><pre class="language-bash line-numbers"><code>

const list_controller = require("../controllers/listController");

//Page principale du site
router.get("/", list_controller.index);


</code></pre><p>Les routes &quot;index&quot; et &quot;users&quot; sont automatiquement implant√©es dans le fichier &quot;app.js&quot; mais on peut rajout√©s des fichiers dans &quot;Routes&quot; et les relier dans &quot;app.js&quot;.<br></p><h3 id="mis-en-page-du-site-web" tabindex="-1"><a class="header-anchor" href="#mis-en-page-du-site-web"></a> Mis en page du site web</h3><p>Nous avons d√©sormais nos routes et notre base de donn√©e pr√™te √† √™tre utilis√©e. Il nous reste donc √† exploiter (dans un premier temps plus simplement afficher) les donn√©es sur notre site. Pour se faire, nous allons effectuer des modifications dans 2 dossiers : controller et view. Ces deux dossiers sont reli√©s et on peut consid√©rer que les fichier controllers sont le &quot;back&quot; alors que les fichiers views sont le &quot;front&quot;. En effet, les dossier view sont √©crit en pug, un d√©riv√© de html, et d√©crira explicitement ce que &quot;verra&quot; l'utilisateur.<br>En l'√©tat actuel, notre page affiche le message : &quot;Not implemented : Element list&quot;. Il nous suffit simplement de remplacer la fonction &quot;export.list&quot; dans &quot;listController&quot; et elle pourra ensuite afficher notre base de donn√©e :</p><pre class="language-bash line-numbers"><code>

exports.list = function (req, res, next) {
  Element.find({}, "Information 1")
    .sort({ title: 1 })
    .exec(function (err, list) {
      if (err) {
        return next(err);
      }
      res.render("list", { title: "List", list: books });
    });
};


</code></pre><p>Que l'on associe avec un fichier &quot;list.pug&quot; dans notre dossier &quot;View&quot; :</p><pre class="language-bash line-numbers"><code>

extends layout

block content
  h1= title

  ul
    each element in list
      li
        a(href=element.url) #{element.title}
    else
      li There are no books.


</code></pre><p>Nous pouvons bien-s√ªr associer ce fichier √† un fichier CSS et √† un fichier JS comme nous l'avons vu auparavant (voir <a href="../index.md">DevWeb</a>)</p><h3 id="forms" tabindex="-1"><a class="header-anchor" href="#forms"></a> Forms</h3><p>Nous sommes d√©sormais capable de cr√©er une base de donn√©es et de l'afficher sur notre site. Afin de cr√©er des interactions avec l'utilisateur, nous souhaiterions lui donner la possibilit√© de modifier la base de donn√©es. Pour ceci, nous utilisons les &quot;forms&quot;. Ce sont des balises html qui donnent la possibilit√© √† l'utilisateur de donner des informations et de les rentrer sur le serveur.<br>Apr√®s que l'utilisateur ait rentr√© son nouvel √©l√©ment, express-validator, que nous devons installer, se chargera de v√©rifier que la donn√©e correspond bien √† celle attendue et sinon, enverra un message d'erreur. Pour exemple, si l'on veut v√©rifier que notre donn√©e n'est pas un texte vide, il nous suffit d'ins√©rer une ligne dans &quot;controller :</p><pre class="language-bash line-numbers"><code>

[
  body("name", "Empty name").trim().isLength({ min: 1 }).escape(),
];


</code></pre><p>Attention, il faut au pr√©alable d√©finir dans nos routes et nos controller si la donn√©e est de type &quot;GET&quot; ou &quot;POST&quot;.<br>Nous cr√©√©ons donc notre fonction de cr√©ation puis nous la reportons dans un fichier view :</p><pre class="language-bash line-numbers"><code>

exports.humain_create_post = [

  body("name")
    .trim()
    .isLength({ min: 1 })
    .escape()
    .withMessage("First name must be specified.")
    .isAlphanumeric()
    .withMessage("First name has non-alphanumeric characters."),
    (req, res, next) => {
    
    const errors = validationResult(req);

    if (!errors.isEmpty()) {
      res.render("person_form", {
        title: "Create Humain",
        person: req.body,
        errors: errors.array(),
      });
      return;
    }
    const person = new Person({
      name: req.body.name,
    });
    person.save((err) => {
      if (err) {
        return next(err);
      }
      res.redirect(person.url);
    });
  },
];


</code></pre><p>Nous cr√©ons finalement un fichier &quot;person_form.pug&quot; dans view o√π nous mettons :</p><pre class="language-bash line-numbers"><code>

form(method='POST' action='')
    div.form-group
      label(for='name') Name:
      input#name.form-control(type='text' placeholder='Name' name='name' required='true' value=(undefined===person ? '' : person.first_name) )
    button.btn.btn-primary(type='submit') Submit
  if errors
    ul
      for error in errors
        li!= error.msg


</code></pre><p>Nous sommes d√©sormais capable de mettre √† jour notre base de donn√©es !</p></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>