<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2023-2024/Dang-Vu-Duc/mon/temps-3.1/"><meta name="description" content="Ce MON expliquera l&#39;utilisation des biblioth√®ques PyPDF2 et Python-Docx pour manipuler des fichiers Word et PDF."><meta property="og:description" content="Ce MON expliquera l&#39;utilisation des biblioth√®ques PyPDF2 et Python-Docx pour manipuler des fichiers Word et PDF."><meta name="twitter:description" content="Ce MON expliquera l&#39;utilisation des biblioth√®ques PyPDF2 et Python-Docx pour manipuler des fichiers Word et PDF."><meta name="author" content="Duc DANG VU"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, Python, Word, PDF, PyPDF2, Python-Docx"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="Utilisation de Python pour manipuler des fichiers Word et PDF"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2023-2024/Dang-Vu-Duc/mon/temps-3.1/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="Utilisation de Python pour manipuler des fichiers Word et PDF"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2023-2024/Dang-Vu-Duc/mon/temps-3.1/"><title>Utilisation de Python pour manipuler des fichiers Word et PDF</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">Utilisation de Python pour manipuler des fichiers Word et PDF</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Python</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Word</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">PDF</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">PyPDF2</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Python-Docx</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">MON</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Duc DANG VU</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2023-2024</span></div></div><p class="mb-4 text-lg">Ce MON expliquera l'utilisation des biblioth√®ques PyPDF2 et Python-Docx pour manipuler des fichiers Word et PDF.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2023-2024/Dang-Vu-Duc/">Duc DANG VU</a><span class="px-1">/</span><a href="/promos/2023-2024/Dang-Vu-Duc/mon/">MON de Duc DANG VU</a><span class="px-1">/</span><a href="/promos/2023-2024/Dang-Vu-Duc/mon/temps-3.1/">Utilisation de Python pour manipuler des fichiers Word et PDF</a></div></div><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100 dark:border-pink-800 dark:bg-pink-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-pink-500 dark:stroke-pink-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg><div class="pl-8 mb-2 mr-8"><p>Pr√©requis</p></div><div class="pl-8 mr-8"><p>Connaissance basique de la programmation objet avec Python.</p></div></div><div class="quote relative drop-shadow py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="pl-8 mb-2 mr-8"><p><b>Note</b></p></div><div class="pl-8 mr-8"><p>Tout les codes pr√©sent√©s sont disponibles dans mon <a href="https://github.com/do-it-ecm/do-it/tree/main/src/promos/2023-2024/Dang-Vu-Duc/mon/temps-3.1">dossier GitHub de temps 3.1</a></p></div></div><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"></a> Introduction</h2><p>Les formats PDF et Word sont des formats tr√®s utilis√©s. Il peut √™tre int√©ressant de pouvoir automatiser certaines t√¢ches concernant ces formats, ou bien r√©cup√©rer les donn√©es de ces documents dans des programmes Python. En effet, ces documents ont des encodages plus complexes qu'un simple fichier <em>.txt</em>, ce qui les rend difficile √† manipuler sans biblioth√®ques ad√©quates. Ce MON pr√©sentera comment utiliser les biblioth√®ques <strong>PyPDF2</strong> et <strong>Python-Docx</strong> pour pouvoir manipuler de tels documents.</p><p>Dans la suite, quelques lignes de code en Python seront pr√©sent√©es. Le r√©sultat de l‚Äôex√©cution des lignes de code est indiqu√© juste apr√®s celles-ci, apr√®s 3 chevrons <code>&gt;&gt;&gt;</code></p><p>Il faut commencer par installer ces biblioth√®ques, avec les commandes <code>pip install PyPDF2==1.26.0</code> et <code>pip install python-docx==0.8.10</code>.</p><h2 id="utilisation-de-pypdf2" tabindex="-1"><a class="header-anchor" href="#utilisation-de-pypdf2"></a> Utilisation de PyPDF2</h2><h3 id="pr%C3%A9sentation-des-%C3%A9l%C3%A9ments-de-base-du-module" tabindex="-1"><a class="header-anchor" href="#pr%C3%A9sentation-des-%C3%A9l%C3%A9ments-de-base-du-module"></a> Pr√©sentation des √©l√©ments de base du module</h3><p>Nous allons commencer par pr√©senter les √©l√©ments de base de cette biblioth√®que. La premi√®re classe √† conna√Ætre est la classe <strong>PdfFileReader</strong>. Les objets de cette classe permettent d'int√©grer dans le code Python un document PDF. Ces objets ont diff√©rents attributs, correspondants √† diff√©rentes caract√©ristiques du document en question. Elles ont √©galement plusieurs m√©thodes pour effectuer des op√©rations sur le document.</p><p>Dans la suite de cette section, nous nous appuierons sur deux documents PDF, enregistr√©s sous les noms de <em>PDF_test_1.pdf</em> et <em>PDF_test_2.pdf</em>. Ces documents sont des travaux que j'ai effectu√© lors de ma deuxi√®me ann√©e.</p><p>Pour ouvrir les documents PDF et les associer √† des objets de la classe <strong>PdfFileReader</strong>, il faut d'abord les ouvrir avec la fonction <em>open</em>, en pr√©cisant en argument le param√®tre <em>rb</em>, qui permet de lire en binaire le fichier. Ensuite, on cr√©√© l'objet en appellant la classe <strong>PdfFileReader</strong> du module <strong>PyPDF2</strong>. Une fois que l'on a cet objet, on peut r√©cup√©rer ses attributs et utiliser les m√©thodes associ√©es.</p><pre class="language-python line-numbers"><code>

pdfFile = open('PDF_test_2.pdf', 'rb')
pdfReader = PyPDF2.PdfFileReader(pdfFile)
print(pdfReader.numPages)
>>> 6


</code></pre><p>Dans l'exemple ci-dessus, on ouvre le fichier test num√©ro 2 et on r√©cup√®re son nombre de pages.</p><p>L'autre classe √† conna√Ætre est la classe <strong>PageObject</strong>. Les objets de cette classe repr√©sentent les diff√©rentes pages du document, ainsi que leurs contenu. On r√©cup√®re ces objets √† partir d'un objet de la classe <strong>PdfFileReader</strong> gr√¢ce √† la m√©thode <em>getPage</em>. En sp√©cifiant le num√©ro de page que l'on veut r√©cup√©rer (indexation commen√ßant √† 0), on peut r√©cup√©rer un objet de la classe <strong>PageObject</strong>. Encore une fois, ces objets ont diff√©rents attributs et m√©thodes pour les manipuler, telle que par exemple la m√©thode <em>extractText()</em> qui permet d'extraire du texte de la page. Notons √©galement la m√©thode <em>rotateClockwise</em>, qui prend en argument un des entiers 90, 180 ou 270, et qui permet d'effectuer une rotation de la page.</p><pre class="language-python line-numbers"><code>

page = pdfReader.getPage(2)
print(page.extractText())
>>> Compte-renduTPPollution
MIE:Approchevariationnelleet

Elements
Cours:GuillaumeChiavassa
Auteur:DucDANGVU
CentraleMarseille
2022-2023


</code></pre><p>Notons que le texte renvoy√© est loin d'√™tre parfait. On remarque que certains √©l√©ment manquent √† l'appel. Cependant, ce texte est globalement conforme √† ce qui est pr√©sent r√©ellement dans le PDF.</p><p>Enfin, la derni√®re classe importante de ce module est la classe <strong>PdfFileWriter</strong>. Les objets de cette classe permettent de cr√©er des nouveaux fichiers PDF, √† partir des classes pr√©c√©demment pr√©sent√©es. Les m√©thodes importantes de cette classe sont les suivantes:</p><ul><li>La m√©thode <em>addPage</em>, qui permet d'ajouter une page au nouveau fichier PDF en sp√©cifiant en argument un objet de la classe <strong>PageObject</strong></li><li>La m√©thode <em>write</em>, qui prend en argument un fichier √©crit en binaire et qui permet de sauvegarder sous format PDF le document associ√© √† l'objet.</li><li>La m√©thode <em>encrypt</em> permet de prot√©ger le fichier PDF par un mot de passe, renseign√© en argument de la m√©thode.</li></ul><h3 id="utilisation-de-ces-%C3%A9l%C3%A9ments" tabindex="-1"><a class="header-anchor" href="#utilisation-de-ces-%C3%A9l%C3%A9ments"></a> Utilisation de ces √©l√©ments</h3><p>Pour appliquer ces connaissances, nous allons √† pr√©sent cr√©er une classe <strong>PDF_Tools</strong>. Les objets de cette classe pourront effectuer des op√©rations sur des fichiers PDF gr√¢ce √† des m√©thodes qui utiliseront les √©l√©ments pr√©sent√©s ci-dessus.</p><h4 id="cr%C3%A9ation-de-la-m%C3%A9thode-pour-combiner-des-pdf" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9ation-de-la-m%C3%A9thode-pour-combiner-des-pdf"></a> Cr√©ation de la m√©thode pour combiner des PDF</h4><p>Cette m√©thode permettra de combiner plusieurs documents PDF, c'est-√†-dire mettre les pages les une √† la suite des autres. Elle prend en argument une liste contenant les noms des PDF √† combiner ainsi que le nom du nouveau fichier PDF cr√©√©. Pour cela, on doit utiliser un objet de la classe <strong>PdfFileWriter</strong>, qui va permettre de construire le nouveau fichier PDF. On ajoute ensuite les pages (qui sont en fait des objets de la classe <strong>PageObject</strong>) une par une gr√¢ce √† la m√©thode <em>addPage</em>, puis on sauvegarde le nouveau fichier gr√¢ce √† la m√©thode <em>write</em>.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Cliquer pour voir le code de la m√©thode <em>combine_pdf</em></p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><pre class="language-python line-numbers"><code>

class PDF_Tools():
  def combine_pdf(self, list_pdf: list, name_merged_file: str):
    pdf_writer = PyPDF2.PdfFileWriter()
    list_pdf_objects = []
    for pdf_name in list_pdf:
      pdf_file = open(pdf_name, 'rb')
      list_pdf_objects.append(PyPDF2.PdfFileReader(pdf_file))
    for pdf_object in list_pdf_objects:
      for page_num in range(pdf_object.numPages):
        page_object = pdf_object.getPage(page_num)
        pdf_writer.addPage(page_object)
    new_pdf = open(name_merged_file, 'wb')
    pdf_writer.write(new_pdf)
    new_pdf.close()


</code></pre></div></details></div><h4 id="cr%C3%A9ation-de-la-m%C3%A9thode-pour-effectuer-des-rotations-sur-des-pages" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9ation-de-la-m%C3%A9thode-pour-effectuer-des-rotations-sur-des-pages"></a> Cr√©ation de la m√©thode pour effectuer des rotations sur des pages</h4><p>Cette m√©thode prend en argument le nom du fichier PDF √† modifier, ainsi qu'une liste contenant les num√©ros de page sur lesquelles effectuer des rotations. Enfin, le dernier argument sp√©cifie quelle rotation effectuer (90, 180 ou 270). Il suffit d'utiliser la m√©thode <em>rotateClockwise</em> de la classe <strong>PageObject</strong>, et de l'utiliser dans la boucle qui ajoute les pages une par une dans le nouveau fichier.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Cliquer pour voir le code de la m√©thode <em>rotate_pages</em></p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><pre class="language-python line-numbers"><code>

def rotate_pages(self, pdf_name: str, list_num_pages: list, rotation: int, name_new_file: str):
      pdf_file = open(pdf_name, 'rb')
      pdf_reader = PyPDF2.PdfFileReader(pdf_file)
      pdf_writer = PyPDF2.PdfFileWriter()
      for num_page in range(pdf_reader.numPages):
        page_object = pdf_reader.getPage(num_page)
        if num_page in list_num_pages:
          page_object.rotateClockwise(rotation)
        pdf_writer.addPage(page_object)
      new_pdf = open(name_new_file, 'wb')
      pdf_writer.write(new_pdf)
      new_pdf.close()


</code></pre></div></details></div><p>Voici un exemple de l'utilisation de ce code. Si on cr√©e un objet de la classe PDF_Tools (<code>test = PDF_Tools()</code>) et que l'on rentre la ligne de code <code>test.rotate_pages(&quot;PDF_test_1.pdf&quot;, [0,1,3], 180, &quot;Nouveau_PDF.pdf&quot;)</code>, on obtient le fichier PDF suivant:</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Dang-Vu-Duc/mon/temps-3.1/Image1.png" alt="Image1"></p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Dang-Vu-Duc/mon/temps-3.1/Image2.png" alt="Image2"></p><p>Seules les pages num√©ro 1, 2 et 4 (index√©es 0, 1 et 3) ont √©t√© tourn√©es, ce qui est bien ce qu'on voulait.</p><h4 id="cr%C3%A9ation-de-la-m%C3%A9thode-pour-superposer-des-pages" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9ation-de-la-m%C3%A9thode-pour-superposer-des-pages"></a> Cr√©ation de la m√©thode pour superposer des pages</h4><p>Cette m√©thode prend argument un nom de fichier √† modifier et un autre nom de fichier contenant l'image √† superposer. Un autre param√®tre est une liste contenant les num√©ros des pages que l'on veut modifier. On utilise la m√©thode <em>mergePage</em> de la classe <em>PageObject</em>, qui prend en argument un autre objet de la classe <em>PageObject</em> et qui superpose les deux pages.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Cliquer pour voir le code de la m√©thode <em>overlay_pages</em></p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><pre class="language-python line-numbers"><code>

def overlay_pages(self, pdf_name: str, pdf_name_overlay: str, list_num_pages: list, name_new_file: str):
  pdf_file = open(pdf_name, 'rb')
  pdf_reader = PyPDF2.PdfFileReader(pdf_file)
  pdf_writer = PyPDF2.PdfFileWriter()
  for num_page in range(pdf_reader.numPages):
    if num_page not in list_num_pages:
      page_object = pdf_reader.getPage(num_page)
      pdf_writer.addPage(page_object)
    else:
      pdf_file_overlay = open(pdf_name_overlay, 'rb')
      pdf_reader_overlay = PyPDF2.PdfFileReader(pdf_file_overlay)
      page_overlay = pdf_reader_overlay.getPage(0)
      page_object = pdf_reader.getPage(num_page)
      page_overlay.mergePage(page_object)
      pdf_writer.addPage(page_overlay)
  new_pdf = open(name_new_file, 'wb')
  pdf_writer.write(new_pdf)
  new_pdf.close()


</code></pre></div></details></div><p>Pour tester cette fonction, on rentre la commande suivante: <code>test.overlay_pages(&quot;PDF_test_2.pdf&quot;, &quot;Logo_Centrale.pdf&quot;, [1, 2, 3, 4, 5], &quot;Nouveau_PDF3.pdf&quot;)</code>, et le fichier suivant est produit:</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Dang-Vu-Duc/mon/temps-3.1/Image3.png" alt="Image3"></p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Dang-Vu-Duc/mon/temps-3.1/Image4.png" alt="Image4"></p><p>Le logo a bien √©t√© plac√© sur les pages qu'il fallait.</p><h4 id="cr%C3%A9ation-de-la-m%C3%A9thode-pour-prot%C3%A9ger-un-pdf-par-un-mot-de-passe" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9ation-de-la-m%C3%A9thode-pour-prot%C3%A9ger-un-pdf-par-un-mot-de-passe"></a> Cr√©ation de la m√©thode pour prot√©ger un PDF par un mot de passe</h4><p>Cette m√©thode permet de crypter un fichier pdf avec un mot de passe, renseign√© en argument de la m√©thode. Cette derni√®re utilise la m√©thode <em>encrypt</em> de la classe <strong>PdfFileWriter</strong>.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Cliquer pour voir le code de la m√©thode <em>encrypt</em></p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><pre class="language-python line-numbers"><code>

def encrypt(self, pdf_name: str, password: str, name_encrypted_file):
    pdf_file = open(pdf_name, 'rb')
    pdf_reader = PyPDF2.PdfFileReader(pdf_file)
    pdf_writer = PyPDF2.PdfFileWriter()
    for page_num in range(pdf_reader.numPages):
      page_object = pdf_reader.getPage(page_num)
      pdf_writer.addPage(page_object)
    pdf_writer.encrypt(password)
    new_pdf = open(name_encrypted_file, 'wb')
    pdf_writer.write(new_pdf)
    new_pdf.close()


</code></pre></div></details></div><h4 id="cr%C3%A9ation-de-la-m%C3%A9thode-pour-r%C3%A9arranger-les-pages-d'un-pdf" tabindex="-1"><a class="header-anchor" href="#cr%C3%A9ation-de-la-m%C3%A9thode-pour-r%C3%A9arranger-les-pages-d'un-pdf"></a> Cr√©ation de la m√©thode pour r√©arranger les pages d'un PDF</h4><p>Cette derni√®re m√©thode prend en argument le nom du fichier √† modifier ainsi qu'une liste contenant le nouvel ordre des pages.</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Cliquer pour voir le code de la m√©thode <em>reorder</em></p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><pre class="language-python line-numbers"><code>

def reorder(self, pdf_name: str, list_new_order: list, name_reordered_file: str):
    pdf_file = open(pdf_name, 'rb')
    pdf_reader = PyPDF2.PdfFileReader(pdf_file)
    pdf_writer = PyPDF2.PdfFileWriter()
    for num_page in list_new_order:
      page_object = pdf_reader.getPage(num_page)
      pdf_writer.addPage(page_object)
    new_pdf = open(name_reordered_file, 'wb')
    pdf_writer.write(new_pdf)
    new_pdf.close()


</code></pre></div></details></div><h2 id="utilisation-de-python-docx" tabindex="-1"><a class="header-anchor" href="#utilisation-de-python-docx"></a> Utilisation de python-docx</h2><p>Nous allons √† pr√©sent explorer les possibilit√©s qu'offre le module Python-docx. Pour charger un fichier Word avec ce module, il faut utiliser la commande: <code>doc = docx.Document(&quot;Word_test_1.docx&quot;)</code>. On pourra ensuite manipuler cet objet et utiliser ses attributs.</p><p>Le texte d'un document Word est d√©compos√© en paragraphes, qui se terminent √† un retour √† la ligne. Dans ces paragraphes, on y trouve des objets de la classe <strong>Runs</strong> qui correspondent √† du texte de la m√™me police. Par exemple, dans le texte suivant:</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Dang-Vu-Duc/mon/temps-3.1/Image5.png" alt="Image5"></p><p>on y trouve 6 objets de la classe <strong>Runs</strong>. Chacun de ces objets ont des attributs que l'ont peut modifier. En voici une liste:</p><p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Dang-Vu-Duc/mon/temps-3.1/Image6.png" alt="Image6"> <em>Source: <a href="https://automatetheboringstuff.com/2e/chapter15/">Automate the boring stuff with Python</a></em></p><p>On peut changer chacun de ces attributs en True ou False.</p><p>L'attribut <em>paragraphs</em> de la classe <strong>Document</strong> permet de r√©cup√©rer une liste de tout les paragraphes du documents. Chaque objet de la classe <strong>Paragraphs</strong> a un attribut <em>runs</em>, qui est une liste d'objets de la classe <strong>Runs</strong>.</p><p>Une autre chose utile √† faire est changer le style d'un paragraphe. Pour cela, on doit changer l'attribut <em>style</em> d'un objet <em>paragraph</em> et l'assigner √† un nom de style. Le style de base se nomme &quot;Normal&quot;, mais il est possible d'en cr√©er un autre directement depuis le logiciel Word, avec le raccourci Ctrl + Maj + S.</p><p>En connaissant tout ces √©l√©ments, on peut changer facilement le contenu d'un document Word, ainsi que ses attributs de base tels que le soulignage, l'italique etc...</p></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>