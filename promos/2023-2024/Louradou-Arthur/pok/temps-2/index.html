<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="index, follow"><link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2023-2024/Louradou-Arthur/pok/temps-2/"><meta name="description" content="Ce POK, modestement nomm√© selon le nom de son grand fr√®re S√©r√©nade, est un projet de cr√©ation d&#39;un site web de gestion de calendrier pour les √©l√®ves en 3A."><meta property="og:description" content="Ce POK, modestement nomm√© selon le nom de son grand fr√®re S√©r√©nade, est un projet de cr√©ation d&#39;un site web de gestion de calendrier pour les √©l√®ves en 3A."><meta name="twitter:description" content="Ce POK, modestement nomm√© selon le nom de son grand fr√®re S√©r√©nade, est un projet de cr√©ation d&#39;un site web de gestion de calendrier pour les √©l√®ves en 3A."><meta name="author" content="Arthur Louradou"><meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, POK, Data, Excel, Google Spreadsheet, Python"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon"><link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png"><link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png"><link href="/assets/stylesheets/main.css" rel="stylesheet"><meta property="og:title" content="S√©r√©naDo_It - Du POC √† la production"><meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2023-2024/Louradou-Arthur/pok/temps-2/"><meta property="og:type" content="website"><meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:title" content="S√©r√©naDo_It - Du POC √† la production"><meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png"><meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2023-2024/Louradou-Arthur/pok/temps-2/"><title>S√©r√©naDo_It - Du POC √† la production</title><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script defer="">const storedTheme=localStorage.getItem("theme");function loadPrismTheme(e){const t=e?"prism-okaidia.min.css":"prism-solarizedlight.min.css",s=document.createElement("link");s.rel="stylesheet",s.id="prism-theme",s.href=`https://cdn.jsdelivr.net/npm/prismjs/themes/${t}`,s.onload=()=>{Prism.highlightAll()};const m=document.getElementById("prism-theme");m?document.head.replaceChild(s,m):document.head.appendChild(s)}function setMermaidTheme(e){const t=e?"dark":"forest";mermaid.initialize({securityLevel:"loose",theme:t,startOnLoad:!0})}function toggleDarkMode(){const e=document.documentElement.classList.contains("dark"),t=e?"light":"dark";localStorage.setItem("theme",t),document.documentElement.classList.toggle("dark",!e),loadPrismTheme(!e),setMermaidTheme(!e)}storedTheme?document.documentElement.classList.toggle("dark","dark"===storedTheme):document.documentElement.classList.toggle("dark",window.matchMedia("(prefers-color-scheme: dark)").matches);const isDark=document.documentElement.classList.contains("dark");loadPrismTheme(isDark),setMermaidTheme(isDark)</script></head><body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50"><header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-between items-center"><a class="mx-2" href="/">Home</a> <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current"><circle cx="12" cy="12" r="5"></circle><path d="M12 2V4" stroke-linecap="round"></path><path d="M12 20V22" stroke-linecap="round"></path><path d="M4 12L2 12" stroke-linecap="round"></path><path d="M22 12L20 12" stroke-linecap="round"></path><path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path><path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path><path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path><path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path></svg> <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block"><path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="flex items-center gap-4 sm:gap-6"><a class="" href="/cs">CS</a> <a class="" href="/pok">POK</a> <a class="" href="/mon">MON</a> <a class="" href="/projets">Projets</a> <a class="hidden sm:block" href="/promos">Promos</a> <a href="/search"><svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg> </a><a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank"><svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div></div></div></header><main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body=""><article class="relative"><h1 class="mb-1">S√©r√©naDo_It - Du POC √† la production</h1><div class="mb-4"><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Tags :</div><ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags"><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">POK</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Data</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Excel</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Google Spreadsheet</li><li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Python</li></ul><div class="hidden" data-pagefind-meta="Type" aria-hidden="true"><span data-pagefind-filter="Type">POK</span></div></div><div class="px-4 flex flex-wrap items-center"><div class="font-bold">Auteur :</div><ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs"><li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Arthur Louradou</li></ul></div><div class="absolute top-0 right-0"><span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">2023-2024</span></div></div><p class="mb-4 text-lg">Ce POK, modestement nomm√© selon le nom de son grand fr√®re S√©r√©nade, est un projet de cr√©ation d'un site web de gestion de calendrier pour les √©l√®ves en 3A.</p><div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950"><svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg><div class="pl-8 mr-8"><a href="/promos/2023-2024/Louradou-Arthur/">Arthur Louradou</a><span class="px-1">/</span><a href="/promos/2023-2024/Louradou-Arthur/pok/">POKs</a><span class="px-1">/</span><a href="/promos/2023-2024/Louradou-Arthur/pok/temps-2/">S√©r√©naDo_It - Du POC √† la production</a></div></div><a href="http://node.oignon.ovh1.ec-m.fr/" class="buttonGithub"><span>Acc√©der √† S√©r√©naDo_It !</span></a><h2 id="sommaire" tabindex="-1"><a class="header-anchor" href="#sommaire"></a> Sommaire</h2><ul><li><a href="#objectifs">Objectifs</a></li><li><a href="#sprint-planning">Sprint planning</a><ul><li><a href="#sprint-1">Sprint 1</a></li><li><a href="#sprint-2">Sprint 2</a></li></ul></li><li><a href="#de-la-recherche-au-poc">De la recherche au POC</a><ul><li><a href="#google-spredsheet">Google Spredsheet</a></li><li><a href="#traitement">Traitement</a></li></ul></li><li><a href="#du-poc-%C3%A0-la-r%C3%A9alisation">Du POC √† la r√©alisation</a></li><li><a href="#revue-de-sprint-1">Revue de Sprint 1</a></li><li><a href="#suite--sprint-2">Suite : Sprint 2</a><ul><li><a href="#objectifs-fin-sprint1">Objectifs √† l'issue du Sprint 1</a></li><li><a href="#documentation-google-api">Lecture de documentation de <strong>Google Workspace APIs</strong> pour d√©ployer en local</a></li><li><a href="#solution">Une solution inesp√©r√©e, plus simple..!</a></li><li><a href="#integration-poc">Int√©gration du POC au code</a></li><li><a href="#traitement-donnees">Traitement des donn√©es</a></li><li><a href="#tests-unitaires">Tests unitaires</a></li></ul></li><li><a href="#perspectives-et-conclusion">Perspectives et conclusion</a></li><li><a href="#liens-et-documentation">Liens et documentation</a></li></ul><h2 id="objectifs-%7B-%23objectifs-%7D" tabindex="-1"><a class="header-anchor" href="#objectifs-%7B-%23objectifs-%7D"></a> Objectifs { #objectifs }</h2><p>Les objectifs de cette r√©alisation sont les suivants :</p><ul><li>Extraire l'information pertinente du calendrier de la fili√®re Do_It</li><li>Exporter cette donn√©e √† la main dans un fichier .ics</li><li>Cr√©er un site web permettant de s'abonner au calendrier √©l√®ve par √©l√®ve, √† partir du travail de Duc</li></ul><h2 id="sprint-planning-%7B-%23sprint-planning-%7D" tabindex="-1"><a class="header-anchor" href="#sprint-planning-%7B-%23sprint-planning-%7D"></a> Sprint planning { #sprint-planning }</h2><h3 id="sprint-1-%7B-%23sprint-1-%7D" tabindex="-1"><a class="header-anchor" href="#sprint-1-%7B-%23sprint-1-%7D"></a> Sprint 1 { #sprint-1 }</h3><table><thead><tr><th>T√¢che</th><th>Difficult√©</th><th>Temps</th></tr></thead><tbody><tr><td>Interagir avec l'API Google Spreadsheet</td><td>1</td><td>1h</td></tr><tr><td>Extraire les informations du tableur sous forme de DataFrame</td><td>2</td><td>2h</td></tr><tr><td>Extraire du DataFrame les informations pertinentes</td><td>3</td><td>2h</td></tr><tr><td>Tester, d√©bugger, chercher des solutions</td><td>5</td><td>3h</td></tr><tr><td>Exporter ces informations dans un fichier .ics</td><td>1</td><td>1h</td></tr><tr><td>G√©n√©rer l'architecture propre du projet</td><td>2</td><td>2h</td></tr></tbody></table><p>√Ä la fin de ce sprint, nous devrions avoir un programme qui s'√©x√©cute en ligne de commande et qui permet d'extraire les informations de l'Excel (Google Spreadsheet, en r√©alit√©) du calendrier de la fili√®re Do_It.</p><h3 id="sprint-2-%7B-%23sprint-2-%7D" tabindex="-1"><a class="header-anchor" href="#sprint-2-%7B-%23sprint-2-%7D"></a> Sprint 2 { #sprint-2 }</h3><table><thead><tr><th>T√¢che</th><th>Difficult√©</th><th>Temps</th></tr></thead><tbody><tr><td>√âcrire les tests unitaires</td><td>5</td><td>3h</td></tr><tr><td>Mettre le POC du POK dans les classes python</td><td>3</td><td>2h</td></tr><tr><td>D√©gugger le code jusqu'√† export du .ics</td><td>5</td><td>3h</td></tr><tr><td>Cr√©er une interface web pour exporter le .ics</td><td>3</td><td>2h</td></tr></tbody></table><p>Dans cette partie, nous allons cr√©er une interface permettant d'exporte un .ics et de s'abonner au calendrier de la fili√®re Do_It, en t√¢chant de personnaliser cela aux √©l√®ves en utilisant le travail de Duc.</p><h2 id="de-la-recherche-au-poc-%7B-%23de-la-recherche-au-poc-%7D" tabindex="-1"><a class="header-anchor" href="#de-la-recherche-au-poc-%7B-%23de-la-recherche-au-poc-%7D"></a> De la recherche au POC { #de-la-recherche-au-poc }</h2><p>Je vais vous pr√©senter dans cette partie les pistes de codes envisag√©es au cours de la phase de recherche n√©cessaire √† l'analyse de donn√©es. En effet, ce projet comporte une phase de recherche importante, car il faut comprendre le fonctionnement de l'API Google Spreadsheet, et trouver un moyen de l'utiliser pour traiter les donn√©es du calendrier de la fili√®re Do_It.</p><h3 id="google-spredsheet-%7B-%23google-spredsheet-%7D" tabindex="-1"><a class="header-anchor" href="#google-spredsheet-%7B-%23google-spredsheet-%7D"></a> Google Spredsheet { #google-spredsheet }</h3><p>Pour commencer, voil√† comment importer notre fichier dans Google Colab :</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Authentification Google Colab et traitement de la donn√©e</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><pre class="language-python line-numbers"><code>

from google.colab import drive
drive.mount('/content/drive')


</code></pre><p>Ensuite, il faut autoriser google √† nous authentifier sur ses services :</p><pre class="language-python line-numbers"><code>

from google.colab import auth
auth.authenticate_user()

import gspread
from google.auth import default
creds, _ = default()

gc = gspread.authorize(creds)

workbook = gc.open_by_url(<url du="" spreadsheet="" do_it="">)
ws = workbook.worksheet('ann√©e')


</url></code></pre><p>On peut ensuite r√©cup√©rer les donn√©es de la feuille de calcul :</p><pre class="language-python line-numbers"><code>

import pandas as pd
from datetime import datetime
import numpy as np

df = pd.DataFrame(ws.get_all_records())

sheet_titles = []

for sheet in workbook.worksheets():
  sheet_titles.append(sheet.title)

# Get_all_values from sheets and store in dictionary
dict_of_sheets = {}
for sheet_title in sheet_titles:
  sheet = workbook.worksheet(sheet_title)
  values = sheet.get_all_values()
  dict_of_sheets[sheet_title] = values
# To confirm all sheets made it into the dictionary
dict_of_sheets.keys()

df = pd.DataFrame.from_records(dict_of_sheets.get('ann√©e'))

df.loc[0] = df.loc[0].replace('', np.nan)
# df = df.fillna(axis=1, method='ffill')
df.loc[0] = df.loc[0].fillna(method='ffill')

two_first = df.iloc[0:2]
two_first = two_first.transpose()
first = two_first[0] + "," + two_first[1]

headers = df.iloc[0].values
df.columns = first


</code></pre></div></details></div><p>√Ä ce stade, le code n'est pas propre et il faut encore le nettoyer. Cependant, il permet d'obtenir un DataFrame contenant les donn√©es du calendrier :</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Voir la DataFrame</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><div style="overflow:scroll"><table><thead><tr><th>index</th><th>Ors,</th><th>Ors,</th><th>Semaine,du</th><th>Semaine,au</th><th>Lundi,8h-9h</th><th>Lundi,9h-10h</th><th>Lundi,10h-11h</th><th>Lundi,11h-12h15</th><th>Lundi,14h-15h</th><th>Lundi,15h-16h</th><th>Lundi,16h15-17h15</th><th>Lundi,17h15-18h15</th><th>Mardi,8h-9h</th><th>Mardi,9h-10h</th><th>Mardi,10h15-11h15</th><th>Mardi,11h15-12h15</th><th>Mardi,14h-15h</th><th>Mardi,15h-16h</th><th>Mardi,16h15-17h15</th><th>Mardi,17h15-18h15</th></tr></thead><tbody><tr><td>0</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td><td>NaN</td></tr><tr><td>1</td><td></td><td></td><td>du</td><td>au</td><td>8h-9h</td><td>9h-10h</td><td>10h-11h</td><td>11h-12h15</td><td>14h-15h</td><td>15h-16h</td><td>16h15-17h15</td><td>17h15-18h15</td><td>8h-9h</td><td>9h-10h</td><td>10h15-11h15</td><td>11h15-12h15</td><td>14h-15h</td><td>15h-16h</td><td>16h15-17h15</td><td>17h15-18h15</td></tr><tr><td>2</td><td>temps 1</td><td></td><td>28/08</td><td>01/09</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td></td><td></td><td>04/09</td><td>08/09</td><td>tronc commun 3A</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>4</td><td></td><td>1</td><td>11/09</td><td>15/09</td><td></td><td></td><td>Bonjour !(FB--LP)218</td><td></td><td>TC1 : Agilit√©(Florian Magnani)Visio/218</td><td></td><td></td><td></td><td>Langues</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table></div></div></details></div><p>On voit que le header a une forme satisfaisante pour √™tre exploitable par la suite.</p><p>Un point important √† noter est que les cases fusionn√©es dans Excel ne sont pr√©senter que dans la premi√®re ligne du DataFrame. On pourrait consid√©rer les remplir avec la m√©thode <code>fillna(method='ffill')</code>, mais cela engenderait des incoh√©rences et des &quot;trous&quot; dans l'emploi du temps seraient remplis.</p><p>Pour combler ceci, il va falloir extraire les informations de fusion du google spreadsheet. Apr√®s de longues recherches, ceci s'est av√©r√© impossible.</p><p>Il faut donc trouver une autre solution, dont l'une retenue est d'exporter la taille des cours du fichier excel export√©, qui lui poss√®de bien les informations de fusion.</p><p>Nous verrons dans un second temps comment proc√©der.</p><h3 id="traitement-%7B-%23traitement-%7D" tabindex="-1"><a class="header-anchor" href="#traitement-%7B-%23traitement-%7D"></a> Traitement { #traitement }</h3><p>√Ä l'aide de fonctions utilitaires et d'une boucle, on peut extraire les informations de l'emploi du temps :</p><div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950"><details class="group"><summary class="list-none py-0.5"><svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg> <svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg><div class="pl-8 font-bold inline-block group-open:select-text"><p>Extraction des informations</p></div><svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg></summary><div class="mx-8 pb-2 cursor-auto select-text"><pre class="language-python line-numbers"><code>

from icalendar import Calendar, Event
from datetime import datetime, timedelta

row = df.iloc[17]  # Prenons un ligne pour exemple
row = row.fillna('').iloc[2:] # On enl√®ve les deux premi√®res colonnes, qui ne nous int√©ressent pas

cal = Calendar()

for col_name, col_value in row.items():
    if col_name == 'Semaine,du':
        week_start_date = datetime.strptime(col_value+"/2023", '%d/%m/%Y')
        week_end_date = week_start_date + timedelta(days=5)
        print("Traitement de la semaine du",week_start_date,"au",week_end_date)
    elif col_value:
        try:
            event_start_date, event_end_date = parse_custom_time(
                df[col_name].iloc[1],
                (week_start_date + timedelta(days=df[col_name].iloc[0])).date()
                )

            event_end_date = event_start_date + timedelta(hours=3)

            print("√âv√©nement d√©tect√© le",event_start_date,event_end_date,":",col_value)

            event = Event()
            event.add('summary', col_value)  # Ajoutez le contenu de la cellule comme titre de l'√©v√©nement
            event.add('dtstart', event_start_date)
            event.add('dtend', event_end_date) # + compute_duration()

            cal.add_component(event)
        except Exception as e:
            print("Erreur dans la colonne",col_value,": ",e)


</code></pre></div></details></div><p>Ce code parcourt donc les colonnes pour une ligne donn√©e, et cr√©e un √©v√©nement pour chaque cours d√©tect√©. Le fait que cela fonctionne, et donne des cours d'une heure dans mon calendrier, est satisfaisant et d√©montre que l'on peut faire un Proof Of Concept de ce POK.</p><p>Le probl√®me subsiste avec les cours de deux ou trois heures, qui sont d√©tect√©s comme des cours d'une heure.</p><h2 id="du-poc-%C3%A0-la-r%C3%A9alisation-%7B-%23du-poc-%C3%A0-la-r%C3%A9alisation-%7D" tabindex="-1"><a class="header-anchor" href="#du-poc-%C3%A0-la-r%C3%A9alisation-%7B-%23du-poc-%C3%A0-la-r%C3%A9alisation-%7D"></a> Du POC √† la r√©alisation { #du-poc-√†-la-r√©alisation }</h2><p>Pour passer du POC √† la r√©alisation, il convient de quitter l'environnement Google Colab et d'ouvrir un repository Git digne de ce nom.</p><p>Nous travaillerons donc sur un environnement local en utilisant au maximum des classes python pour rendre le code plus lisible et plus facilement maintenable.</p><p>Je vous propose donc pour cette revue de Sprint 1 de vous pr√©senter la structure qu'aura le code au repo suivant : <a href="https://github.com/alouradou/SerenaDo_It">https://github.com/alouradou/SerenaDo_It</a></p><h2 id="revue-de-sprint-1-%7B-%23revue-de-sprint-1-%7D" tabindex="-1"><a class="header-anchor" href="#revue-de-sprint-1-%7B-%23revue-de-sprint-1-%7D"></a> Revue de Sprint 1 { #revue-de-sprint-1 }</h2><p>Dans ce Sprint, nous avons vu comment extraire les informations de l'emploi du temps de la fili√®re Do_It, et comment les traiter pour les exporter dans un fichier .ics.</p><p>Nous avons ainsi produit un Proof Of Concept qui nous permet de voir que le projet est r√©alisable, puis nous avons d√©fini la structure du code sous forme de classes qui sera utilis√©e pour la suite du projet.</p><p>Vous pourrez noter ici que la structure du code est g√©n√©r√©e √† l'aide de l'assistant chatGPT et je m'assurerai que le contenu qui s'y trouve en dernier lieu sera bien v√©rifi√© et test√© par mes soins. Petit point m√©thodologique cependant : j'utilise principalement chatGPT dans ce genre de cas, √† l'initialisation d'un projet, car ses r√©ponses sont bonnes pour √©tablir une architecture globale et &quot;dans les r√®gles de l'art&quot; (respectant des bonnes pratiques d√®s le d√©part) d'une application.</p><h2 id="suite-%3A-sprint-2-%7B-%23suite--sprint-2-%7D" tabindex="-1"><a class="header-anchor" href="#suite-%3A-sprint-2-%7B-%23suite--sprint-2-%7D"></a> Suite : Sprint 2 { #suite--sprint-2 }</h2><h3 id="objectifs-%C3%A0-l'issue-du-sprint-1-%7B-%23objectifs-fin-sprint1-%7D" tabindex="-1"><a class="header-anchor" href="#objectifs-%C3%A0-l'issue-du-sprint-1-%7B-%23objectifs-fin-sprint1-%7D"></a> Objectifs √† l'issue du Sprint 1 { #objectifs-fin-sprint1 }</h3><ul><li>Faire des Tests Unitaires ! Cela facilitera l'int√©gration des fonctions de traitement de donn√©es</li><li>Int√©grer le POC au code</li><li>Automatiser l'exportation du (des !) fichier .ics pour les √©l√®ves</li></ul><h3 id="lecture-de-documentation-de-google-workspace-apis-pour-d%C3%A9ployer-en-local-%7B-%23documentation-google-api-%7D" tabindex="-1"><a class="header-anchor" href="#lecture-de-documentation-de-google-workspace-apis-pour-d%C3%A9ployer-en-local-%7B-%23documentation-google-api-%7D"></a> Lecture de documentation de <strong>Google Workspace APIs</strong> pour d√©ployer en local { #documentation-google-api }</h3><p>La solution prometteuse semblait √™tre l‚Äôutilisation de l‚ÄôAPI de Google pour le projet en dehors d‚Äôun environnement Google Workspace. Cependant, celle-ci a des r√®gles bien sp√©cifiques pour √™tre utilis√©e sur n‚Äôimporte quelle application, incluant un environnement de test contraignant ou bien une validation de la part de Google. Ce d√©tour est n√©anmoins int√©ressant pour comprendre le fonctionnement de certaines applications Cloud. [3]</p><p>J‚Äôai donc abandonn√© cette piste qui m‚Äôa conduit √† d‚Äôautres recherches.</p><h3 id="une-solution-inesp%C3%A9r%C3%A9e%2C-plus-simple..!-%7B-%23solution-%7D" tabindex="-1"><a class="header-anchor" href="#une-solution-inesp%C3%A9r%C3%A9e%2C-plus-simple..!-%7B-%23solution-%7D"></a> Une solution inesp√©r√©e, plus simple..! { #solution }</h3><p>Durant les recherches sur l‚ÄôAPI, certains posts ont mentionn√© des liens d‚Äôexport et nous aurions pu commencer par l√† : analyser les requ√™tes effectu√©es par le navigateur pour t√©l√©charger un Google Spreadsheet en PDF, Excel, CSV, etc. En effet, √† l‚Äôaide d‚Äôun simple lien compos√© de cette fa√ßon :</p><pre class="language-python line-numbers"><code>

csv_url = "https://docs.google.com/spreadsheets/d/" + sheet_id + "/gviz/tq?tqx=out:csv&sheet=" + sheet_name
xlsx_url = "https://docs.google.com/spreadsheets/d/" + sheet_id + "/export?format=xlsx&id=" + sheet_id


</code></pre><p>Avec le Sheet id se trouvant dans l‚ÄôURL de l‚Äôemploi du temps de Do_It.</p><aside>üí° Merveilleux : nous avons d√©sormais un Google Sheet qui se t√©l√©charge tout seul et qui peut √™tre exploit√© par la biblioth√®que `openpyxl` comme le fait DUC dans son MON !</aside><h3 id="int%C3%A9gration-du-poc-au-code-%7B-%23integration-poc-%7D" tabindex="-1"><a class="header-anchor" href="#int%C3%A9gration-du-poc-au-code-%7B-%23integration-poc-%7D"></a> Int√©gration du POC au code { #integration-poc }</h3><p>Dans cette phase du projet, nous avons consolid√© le Proof Of Concept (POC) que nous avons d√©velopp√© dans le Sprint 1. Pour ce faire, nous avons int√©gr√© le code du POC dans la structure du projet d√©finie pr√©c√©demment. Les fonctionnalit√©s de traitement des donn√©es du Google Spreadsheet ont √©t√© encapsul√©es dans des classes Python pour assurer une int√©gration automatique √† tout code python y faisant appel.</p><h3 id="traitement-des-donn%C3%A9es-%7B-%23traitement-donnees-%7D" tabindex="-1"><a class="header-anchor" href="#traitement-des-donn%C3%A9es-%7B-%23traitement-donnees-%7D"></a> Traitement des donn√©es { #traitement-donnees }</h3><div style="display:flex;flex-direction:row"><div style="display:block;margin-right:20px"><p>Comme il ne s‚Äôagit pas de perdre tout le monde, j‚Äôinvite les int√©ress√©s √† regarder le code du projet et √† tester par vous m√™me l‚Äôinterface disponible au moment o√π je poste ce MON √† son adresse de d√©ploiement. Je vais tout de m√™me d√©tailler les classes int√©ressantes du projet pour le traitement des donn√©es.</p><p>Dans la phase de traitement des donn√©es, nous avons utilis√© les biblioth√®ques <code>openpyxl</code> et <code>pandas</code> pour extraire et manipuler les donn√©es de l‚ÄôExcel et r√©soudre la probl√©matique des cellules fusionn√©es.</p><p>Comme un sch√©ma vaut mieux que mille mots, voici le sch√©ma de la donn√©e √† mettre en perspective avec le code.</p><h3 id="fonctionnement-de-l%E2%80%99application-%7B-%23fonctionnement-application-%7D" tabindex="-1"><a class="header-anchor" href="#fonctionnement-de-l%E2%80%99application-%7B-%23fonctionnement-application-%7D"></a> Fonctionnement de l‚Äôapplication { #fonctionnement-application }</h3><a href="http://node.oignon.ovh1.ec-m.fr/" class="buttonGithub"><span>Allons voir le projet !</span></a><p>Le fonctionnement de l‚Äôapplication est possible de plusieurs fa√ßons que je vais d√©tailler de la plus stable et fiable √† la moins √©prouv√©e.</p></div><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Louradou-Arthur/pok/temps-2/assets/schema_data_serenadoit.png" style="width:30vw;aspect-ratio:1/1"></div><ol><li><p>Le calendrier g√©n√©ral (route <code>/annee</code>)</p><p>Dans le cas o√π vous souhaitez consulter l‚Äôagenda g√©n√©ral, vous pouvez vous y abonner et voir les cours de tout Do_It. Notez que ce calendrier marche avec l‚Äôagenda de l‚Äôoption CliMaTHs car leur calendrier est de la m√™me forme que celui de l‚Äôoption Do_It. Pour ce qui est de la g√©n√©ration du calendrier avec abonnement √† partir du Google Sheet, celle-ci a lieu lors du clic sur le bouton ‚ÄúLa liste compl√®te des cours de l‚Äôann√©e‚Äù. Vous pouvez donc mettre √† jours les cours de toute l‚Äôoption en parcourant le site !</p></li><li><p>Personnalisation √† partir de votre Excel (route POST <code>/annee/source-excel</code>)</p><p>Vous pouvez vous-m√™me supprimer les cours que vous n‚Äôavez pas choisi au cours de l‚Äôann√©e et ainsi personnaliser votre calendrier et ajouter vos propres √©v√©nements. Veillez √† ne pas toucher √† la structure de l‚ÄôExcel et cela sera</p></li><li><p>Scrapping de l‚Äôexport de Duc depuis Github (route <code>/github</code>)</p><p>√Ä l‚Äôorigine, Duc a sorti un export lors de <a href="../../../Dang-Vu-Duc/mon/temps-1.2/">son MON 1.2.</a> Il est donc possible de r√©cup√©rer les fichiers Excel bruts sur le repo du site. On affiche ainsi une liste de documents qui peuvent √™tre int√©gr√©s au programme de traitement. Probl√®me relev√© : lorsque l‚Äôorthographe des cours est inexacte dans la premi√®re ligne de la cellule de l‚Äôemploi du temps, le cours n‚Äôapparait pas. Deux solutions sont envisag√©es : modifier un peu l‚Äôalgorithme pour le rendre plus robuste ou √©crire des tests unitaires pour garantir l‚Äôint√©grit√© du calendrier ainsi g√©n√©r√©.</p></li><li><p>Utilisation de l‚Äôalgorithme de Duc directement dans l‚ÄôAPI (route <code>/eleves</code>)</p><p>Cette route liste les √©l√®ves pour ex√©cuter l‚Äôalgorithme de s√©lection des cours directement dans l‚Äôapplication.</p></li></ol><h3 id="tests-unitaires-%7B-%23tests-unitaires-%7D" tabindex="-1"><a class="header-anchor" href="#tests-unitaires-%7B-%23tests-unitaires-%7D"></a> Tests unitaires { #tests-unitaires }</h3><p>Pour assurer la fiabilit√© de ce dernier algorithme (qui est le plus pratique pour les √©l√®ves), j‚Äôai pu lors du peu de temps restant ex√©cuter un test dont voici le principe :</p><ol><li>Cr√©er un √©l√®ve ‚ÄúTest‚Äù qui aurait rempli de ‚ÄúX‚Äù toutes les cases de choix de cours.</li><li>Parcourir l‚ÄôExcel g√©n√©r√© par la fonction de Duc et l‚ÄôExcel original, complet.</li><li>En relevant les diff√©rences, on sait si des probl√®mes d‚Äôorthographe ont √©t√© rep√©r√©s.</li></ol><p>Pour l‚Äôheure, je corrige ces probl√®mes en ajoutant dans CreateTimetable, la liste des cours probl√©matiques comme s‚Äôils s‚Äôagissait de tronc commun :</p><pre class="language-python line-numbers"><code>

"architecture si", "strat√©gje & si", "people analytics", "it & dynamique organisationnelle"


</code></pre><p>Il conviendrait d'en r√©aliser de nouveaux.</p><h2 id="perspectives-et-conclusion-%7B-%23perspectives-et-conclusion-%7D" tabindex="-1"><a class="header-anchor" href="#perspectives-et-conclusion-%7B-%23perspectives-et-conclusion-%7D"></a> Perspectives et conclusion { #perspectives-et-conclusion }</h2><p>Ce projet a √©t√© tr√®s int√©ressant √† r√©aliser car il m‚Äôa permis de d√©couvrir des outils tr√®s utiles pour la gestion de donn√©es et de me sentir √† l'aise avec des concepts de d√©veloppement complets pour un r√©sulat utilisable par les √©l√®ves de Do_It.</p><p>Je pense que ce projet peut √™tre am√©lior√© en plusieurs points :</p><ul><li>Demander des retours aux utilisateur</li><li>Ajouter des tests unitaires pour garantir la fiabilit√© de l‚Äôalgorithme de persionnalisations des cours</li><li>Ajouter une fonction de mise √† jour automatique du calendrier</li></ul><h2 id="liens-et-documentation-%7B-%23liens-et-documentation-%7D" tabindex="-1"><a class="header-anchor" href="#liens-et-documentation-%7B-%23liens-et-documentation-%7D"></a> Liens et documentation { #liens-et-documentation }</h2><p>[1] Code du projet : <a href="https://github.com/alouradou/SerenaDo_It">https://github.com/alouradou/SerenaDo_It</a></p><p>[2] Testez le projet : <a href="http://node.oignon.ovh1.ec-m.fr/">http://node.oignon.ovh1.ec-m.fr/</a></p><p>[3] Documentation Google API : <a href="https://developers.google.com/workspace/guides/enable-apis#sheets-api">https://developers.google.com/workspace/guides/enable-apis#sheets-api</a></p><style>a.buttonGithub{display:inline-block;padding:15px 30px;background-color:#2ecc71;color:#fff;border-radius:10px;border:2px solid #2ecc71;text-decoration:none;position:relative;overflow:hidden;transition:background-color .3s,transform .3s ease-in-out}a.buttonGithub:hover{background-color:#2ecc71;transform:translateY(-5px);color:#2ecc71}a.buttonGithub span{position:relative;z-index:1}a.buttonGithub::before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background-color:#fff;transition:left .3s}a.buttonGithub:hover::before{left:0}</style></article></main><footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700"><div class="max-w-[1000px] mx-auto px-4"><div class="min-h-[50px] flex justify-center items-center"><p class="text-center">¬©2025 <b><span style="font-family:Consolas,sans-serif">Do-<span style="color:#4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT</p></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]},svg:{fontCache:"global"}},document.addEventListener("DOMContentLoaded",(()=>{MathJax.typeset()}))</script><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">Prism.plugins.NormalizeWhitespace.setDefaults({"remove-trailing":!0,"remove-indent":!0,"left-trim":!0,"right-trim":!0})</script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script></body></html>