<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="robots" content="index, follow">

        <link rel="canonical" href="https://do-it.aioli.ec-m.fr/promos/2023-2024/Ouzoulias-Nicolas/mon/temps-1.2/">

        
        

        <meta name="description" content="Mon second MON pour m&#39;am√©liorer √† l&#39;utilisation de Python pour la gestion de tableaux Excel.">
        <meta property="og:description" content="Mon second MON pour m&#39;am√©liorer √† l&#39;utilisation de Python pour la gestion de tableaux Excel.">
        <meta name="twitter:description" content="Mon second MON pour m&#39;am√©liorer √† l&#39;utilisation de Python pour la gestion de tableaux Excel.">

        
            <meta name="author" content="Nicolas Ouzoulias">
        
        <meta name="keywords" content="do-it, centrale, centrale m√©diterran√©e, ecm, MON, Excel, Python, Openpyxl">

        <link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/favicon.ico" type="image/x-icon">
        <link rel="icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png" type="image/png">
        <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/minimal.png">

        <link href="/assets/stylesheets/main.css" rel="stylesheet">

        <meta property="og:title" content="Automatisation d&#39;Excel avec Python">

        <meta property="og:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta property="og:url" content="https://do-it.aioli.ec-m.fr/promos/2023-2024/Ouzoulias-Nicolas/mon/temps-1.2/">
        <meta property="og:type" content="website">

        <meta name="twitter:card" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta name="twitter:title" content="Automatisation d&#39;Excel avec Python">
        <meta name="twitter:image" content="https://raw.githubusercontent.com/do-it-ecm/do-it/main/src/assets/img/logo/intermediate-text.png">
        <meta name="twitter:url" content="https://do-it.aioli.ec-m.fr/promos/2023-2024/Ouzoulias-Nicolas/mon/temps-1.2/">

        <title>Automatisation d&#39;Excel avec Python</title>

        <!-- Prismjs imports
                - Prism line numbers
                - Prism toolbar
        -->
        <link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet">
        <link id="prism-theme" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <!-- Mermaid import and initialization -->
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js "></script>

        <script defer="">
        // Check if a theme is stored in localStorage. If so, use it, otherwise fallback to the system preference.
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme) {
            document.documentElement.classList.toggle("dark", storedTheme === "dark");
        } else {
            // Use system color scheme if there is no stored theme preference.
            document.documentElement.classList.toggle("dark", window.matchMedia("(prefers-color-scheme: dark)").matches);
        }

        function loadPrismTheme(isDarkMode) {
            const newTheme = isDarkMode ? 'prism-okaidia.min.css' : 'prism-solarizedlight.min.css';
            const newLink = document.createElement('link');
            newLink.rel = 'stylesheet';
            newLink.id = 'prism-theme';
            newLink.href = `https://cdn.jsdelivr.net/npm/prismjs/themes/${newTheme}`;

            newLink.onload = () => {
                // Reapply highlighting after the new theme loads
                Prism.highlightAll();
            };

            const existingLink = document.getElementById('prism-theme');
            if (existingLink) {
                document.head.replaceChild(newLink, existingLink);
            } else {
                document.head.appendChild(newLink);
            }
        }

        function setMermaidTheme(isDarkMode) {
            const theme = isDarkMode ? 'dark' : 'forest';
            mermaid.initialize({
                securityLevel: 'loose',
                theme,
                startOnLoad: true,
            });
        }

        // Toggle dark and light mode and update localStorage accordingly.
        function toggleDarkMode() {
            const dark = document.documentElement.classList.contains("dark");
            const newTheme = dark ? "light" : "dark";
            localStorage.setItem('theme', newTheme);
            document.documentElement.classList.toggle("dark", !dark);
            loadPrismTheme(!dark);
            setMermaidTheme(!dark);
        }

        // On initial load, ensure that Prism and Mermaid are initialized using the current theme.
        const isDark = document.documentElement.classList.contains("dark");
        loadPrismTheme(isDark);
        setMermaidTheme(isDark);
        </script>

    </head>

    <body data-prismjs-copy="üìã" data-prismjs-copy-error="‚ùå" data-prismjs-copy-success="‚úÖ" data-prismjs-copy-timeout="1000" class="bg-neutral-50 text-neutral-950 dark:bg-neutral-900 dark:text-neutral-50">
        <header class="fixed top-0 z-50 w-full border-b-2 border-gray-200 bg-white dark:bg-neutral-900 dark:border-neutral-700">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-between items-center">
                    <a class="mx-2" href="/">Home</a>
                    <button class="hidden sm:block text-neutral-950 dark:text-neutral-50 hover:bg-neutral-700 hover:text-neutral-50 hover:dark:bg-neutral-300 hover:dark:text-neutral-950 transition-colors p-2 rounded-full duration-800 ease-in-out" onclick="toggleDarkMode()">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 dark:hidden stroke-current">
                            <circle cx="12" cy="12" r="5"></circle>
                            <path d="M12 2V4" stroke-linecap="round"></path>
                            <path d="M12 20V22" stroke-linecap="round"></path>
                            <path d="M4 12L2 12" stroke-linecap="round"></path>
                            <path d="M22 12L20 12" stroke-linecap="round"></path>
                            <path d="M19.7778 4.22266L17.5558 6.25424" stroke-linecap="round"></path>
                            <path d="M4.22217 4.22266L6.44418 6.25424" stroke-linecap="round"></path>
                            <path d="M6.44434 17.5557L4.22211 19.7779" stroke-linecap="round"></path>
                            <path d="M19.7778 19.7773L17.5558 17.5551" stroke-linecap="round"></path>
                        </svg>
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="h-5 aspect-square fill-none aspect-square stroke-2 stroke-current hidden dark:block">
                            <path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                    <div class="flex items-center gap-4 sm:gap-6 ">
                        <a class="" href="/cs">CS</a>
                        <a class="" href="/pok">POK</a>
                        <a class="" href="/mon">MON</a>
                        <a class="" href="/projets">Projets</a>
                        <a class="hidden sm:block" href="/promos">Promos</a>
                        <a href="/search">
                            <svg class="h-5 aspect-square stroke-neutral-950 dark:stroke-neutral-300 fill-none stroke-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path>
                            </svg>
                        </a>
                        <a class="hidden sm:block" href="https://github.com/do-it-ecm/do-it" target="_blank">
                            <svg class="h-5 aspect-square dark:stroke-neutral-300 dark:fill-neutral-300" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <main class="mt-[66px] max-w-[1000px] mx-auto px-4" data-pagefind-body="">
            
<article class="relative">
<h1 class="mb-1">Automatisation d&#39;Excel avec Python</h1>
<div class="mb-4">
    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Tags : </div>
            <ul class="flex flex-wrap overflow-auto not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Tags">
                
                    <li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">MON</li>
                
                    <li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Excel</li>
                
                    <li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Python</li>
                
                    <li class="bg-yellow-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Tags">Openpyxl</li>
                

            </ul>

            
            <div class="hidden" data-pagefind-meta="Type" aria-hidden="true">
                
                    
                        <span data-pagefind-filter="Type">MON</span>
                    
                
                    
                
                    
                
                    
                
            </div>
        </div>
    

    
        <div class="px-4 flex flex-wrap items-center">
            <div class="font-bold">Auteur : </div>
            <ul class="flex flex-wrap not-prose list-none my-1 mx-0 px-1 gap-1" data-pagefind-meta="Auteurs">
                
                    <li class="bg-blue-200 rounded-full px-2 text-neutral-950" data-pagefind-filter="Auteurs">Nicolas Ouzoulias</li>
                
            </ul>
        </div>
    

    
        <div class="absolute top-0 right-0">
            <span class="bg-purple-200 rounded-full px-3 py-1 mt-2 mr-2 text-neutral-950" data-pagefind-filter="Ann√©e">
                2023-2024
            </span>
        </div>
    
</div>

<p class="mb-4 text-lg">Mon second MON pour m'am√©liorer √† l'utilisation de Python pour la gestion de tableaux Excel.</p>



    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100 dark:border-purple-800 dark:bg-purple-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-purple-500 dark:stroke-purple-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/promos/2023-2024/Ouzoulias-Nicolas/">Nicolas OUZOULIAS</a><span class="px-1">/</span><a href="/promos/2023-2024/Ouzoulias-Nicolas/mon/">MON de Nicolas Ouzoulias</a><span class="px-1">/</span><a href="/promos/2023-2024/Ouzoulias-Nicolas/mon/temps-1.2/">Automatisation d&#39;Excel avec Python</a>

</div>
</div>




<h2 id="sommaire" tabindex="-1"><a class="header-anchor" href="#sommaire"></a> Sommaire</h2>
<p>I. Introduction</p>
<p>II. Pr√©sentation de <em>openpyxl</em></p>
<p>III. Mise en pratique</p>
<p>IV. Conclusion</p>
<h2 id="i.-introduction" tabindex="-1"><a class="header-anchor" href="#i.-introduction"></a> I. Introduction</h2>
<p>Lors de ce deuxi√®me MON de l'ann√©e j'ai suivi le chapitre 13 du livre <strong>Automate the boring stuff with Python</strong> pour travailler sur les documents Excel depuis Python gr√¢ce √† la biblioth√®que <em>openpyxl</em>.</p>
<p>Ce dernier est disponible <a href="https://automatetheboringstuff.com/2e/chapter13/">ici</a>.</p>
<p>J'ai voulu suivre cette formation car lors de mon stage 2A j'ai principalement travaill√© sur un code Python pour √©tudier des cycles de pression dans des canalisations. Ces derni√®res √©taient initialement stock√©es dans un tableau Excel, j'ai donc d√ª utiliser quelques fois la biblioth√®que <em>openpyxl</em> mais uniquement quelques lignes, je n'ai pas eu le temps de rentrer en d√©tail et de vraiment comprendre le fonctionnement et les bonnes habitudes √† avoir pour optimiser son utilisation.</p>
<h2 id="ii.-pr%C3%A9sentation-de-openpyxl" tabindex="-1"><a class="header-anchor" href="#ii.-pr%C3%A9sentation-de-openpyxl"></a> II. Pr√©sentation de <em>openpyxl</em></h2>
<p>La biblioth√®que python <em>openpyxl</em> est utilis√©e pour la lecture et la modification des tableaux Excel, cette derni√®re facilite l'utilisation et donc l'automatisation de nombreuses t√¢ches</p>
<h3 id="initialisation-et-lecture-des-donn%C3%A9es" tabindex="-1"><a class="header-anchor" href="#initialisation-et-lecture-des-donn%C3%A9es"></a> Initialisation et lecture des donn√©es</h3>
<p><em>openpyxl</em> n'est initialement pas dans Python il faut donc commencer par l'installer.</p>
<pre class="language-python line-numbers"><code>

pip install openpyxl


</code></pre><p>Une fois install√©e et op√©rationnelle il faut √©crire sur quel document Excel nous souhaitons travailler. Pour cela on utilise <code>openpyxl.load_workbook()</code> si le document existe d√©j√† ou <code>openpyxl.Workbook()</code> pour en cr√©er un.</p>
<p>Pour travailler sur un document il faut comprendre comment Python visualise ce dernier. Les deux m√©tohdes pr√©c√©dentes cr√©ent une donn√©e de type <em>worbook</em>, mais ce n'est pas celle-ci qui nous int√©resse, elle sert uniquement √† dire √† Python o√π regarder et quel document lire/modifier.</p>
<p>Un <em>workbook</em> est tout d'abord divis√© en plusieurs <em>sheets</em> (feuilles). Et chaque <em>sheet</em> est divis√© en de multiples <em>cells</em> (cellules).</p>
<p>Une cellule est caract√©ris√©e par :</p>
<ul>
<li>une valeur : <strong>value</strong> (texte, date, nombre,...)</li>
<li>une ligne : <strong>row</strong> (1,2,3,...)</li>
<li>une colonne : <strong>column</strong> (A,B,C,...)</li>
<li>des coordonn√©es : [<strong>column</strong>+<strong>row</strong>] (A7,B12,...)</li>
</ul>
<p>Tout comme pour le document, il faut indiquer √† Python quelle feuille s√©lectionner. Un exemple de d√©but de code sur <em>openpyxl</em> va avoir cette forme :</p>
<pre class="language-python line-numbers"><code>

import openpyxl

table = openpyxl.load_workbook('mon_excel.xlsx')

feuille1 = classeur.active()
feuille2 = table['Sheet2']


</code></pre><p>Ici nous avons deux mani√®res diff√©rentes de s√©lectionner une feuille dans le tableau.</p>
<ul>
<li><code>.active()</code> pour celle qui s'ouvre par d√©faut</li>
<li><code>nom_document['nom_sheet']</code> pour en s√©lectionner une pr√©cis√©ment.</li>
</ul>
<p>Cependant la deuxi√®me m√©thode n√©cessite de conna√Ætre le nom des diff√©rentes feuilles et donc d'avoir le document sous les yeux ce qui est contraignant pour une optimisation. Pour contrer cela on peut utiliser <code>nom_document.sheetnames</code> qui renvoie une liste avec le nom de chaque feuille de <code>nom_document</code>.</p>
<p>Une fois bien initialis√© nous pouvons enfin lire des cellules. Pour cela il faut utiliser <code>.value</code>.</p>
<pre class="language-python line-numbers"><code>

cell1 = feuille1['A7']
cell2 = feuille1.cell(row=7, column=1)

valeur1 = cell1.value
valeur2 = cell2.value


</code></pre><p>Les 2 fa√ßons pr√©c√©dentes permettent de lire et de stocker les valeurs d'une cellule. Ici on a √©videmment <em>valeur1</em> = <em>valeur2</em>.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Note</b></p>
</div><div class="pl-8 mr-8">
<p>NB : Contrairement √† de nombreuses donn√©es comme les listes, les <em>array</em> et les boucles <em>for</em>, les coordonn√©es d'une feuille commencent par 1 et non 0.</p>
</div>
</div>
<p>La seconde m√©thode est plus facile √† utiliser avec des boucles car elle utilise uniquement des nombres et non des lettres, m√™me si le probl√®me est √©vitable gr√¢ce √† <code>get_column_letter()</code> et <code>column_index_from_string()</code>.</p>
<h3 id="%C3%A9criture-et-modification-de-donn%C3%A9es" tabindex="-1"><a class="header-anchor" href="#%C3%A9criture-et-modification-de-donn%C3%A9es"></a> √âcriture et modification de donn√©es</h3>
<p>Maintenant que nous savons comment lire efficacement un tableau Excel nous allons chercher √† le modifier depuis Python.</p>
<p>La modification de la valeur d'une cellule se fait tr√®s facilement √† l'aide une nouvelle fois de <code>.value</code>.</p>
<p>Pour l'exemple nous avons initialement ce tableau :</p>
<p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Ouzoulias-Nicolas/mon/temps-1.2/excel_avant_modif.png" alt="Excel initial"></p>
<p>Nous pouvons donc en utilisant la m√©thode pr√©c√©dent modifier une cellule en particulier comme par exemple la B2 et ainsi avoir :</p>
<p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Ouzoulias-Nicolas/mon/temps-1.2/excel_apres_modif.png" alt="Excel modifi√©"></p>
<p>Cependant notre valeur est d√©sormais √©crite en gras, comment cela se fait-il ?</p>
<p>En effet en plus de simplement modifier la valeur nous pouvons modifier le style. Le code utilis√© pour passer d'un tableau √† l'autre a ici √©t√© :</p>
<pre class="language-python line-numbers"><code>

import openpyxl
from openpyxl.styles import Font

wb = openpyxl.load_workbook('test1.xlsx')
sheet = wb.active
c1 = sheet.cell(row=2, column=2)

c1.value = "Pineapple"
c1.font = Font(bold=True)

wb.save('test1.xlsx')


</code></pre><p>L'importation de la classe <strong>Font</strong> issue de la biblioth√®que <em>openpyxl.styles</em> permet de modifier le style de la police d'√©criture. Le code modifie donc initialement la valeur de la cellule <em><strong>c1</strong></em> gr√¢ce √† la ligne <code>c1.value = &quot;Pineapple&quot;</code> avant de la mettre en gras avec <code>c1.font = Font(bold=True)</code>.</p>
<p>La derni√®re ligne du code quant √† elle permet de sauvegarder les modifications.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100 dark:border-amber-800 dark:bg-amber-950">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 fill-none stroke-2 stroke-amber-800 dark:stroke-amber-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mb-2 mr-8">
<p><b>Note</b></p>
</div><div class="pl-8 mr-8">
<p><strong>Attention</strong> cependant au nom de fichier utilis√© pour la sauvegarde, ici le nouveau document va prendre la place de l'ancien ! Il est donc recommand√© d'utiliser un nouveau nom pour ne pas √©craser les donn√©es et revenir en arri√®re en cas de probl√®me.</p>
</div>
</div>
<p>De nombreux param√®tres sont modifiables gr√¢ce √† <em>openpyxl.styles</em> comme la police, l'alignement, les couleurs,...
Il est √©galement possible de fusionner des cellules et modifier leurs tailles.</p>
<p>L'utilisation de Python pour automatiser les tableaux Excel peut √™tre extr√™mement utile mais il ne faut pas oublier que de nombreuses formules Excel existent d√©j√† et rien ne sert d'√©crire une fonction Python qui peut se faire directement depuis Excel. Par exemple si nous poss√©dons une colonne de nombres et que nous souhaitons sommer ces derniers, il est plus rapide d'√©crire une cellule avec <code>cellule_somme.value = '=SUM(A1:A12)'</code> que d'√©crire :</p>
<pre class="language-python line-numbers"><code>

somme = 0
for i in range(1,12) :
  cell = sheet.cell(row=i, column=1)
  somme+=cell.value

cellule_somme.value = somme


</code></pre><h2 id="iii.-mise-en-pratique" tabindex="-1"><a class="header-anchor" href="#iii.-mise-en-pratique"></a> III. Mise en pratique</h2>
<p>Afin d'utiliser les diff√©rentes m√©thodes vues pr√©c√©demment je vais reprendre le code sur lequel je travaillais lors de mon stage et pour lequel j'ai √† peine utilis√© <em>openpyxl</em>.</p>
<p>Mon code sert √† √©tudier des relev√©s de pression dans des canalisations, les donn√©es initiales que j'avais √©taient donc un tableau Excel avec une colonne de dates et une autre de pressions.</p>
<p>Apr√®s avoir import√© les donn√©es dans Python et apr√®s de nombreux calculs j'obtenais un tableau correspondant √† une matrice que j'affichais gr√¢ce √† la biblioth√®que <em>matplotlib.pyplot</em>.</p>
<p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Ouzoulias-Nicolas/mon/temps-1.2/graphe_python.png" alt="Graphe Python"></p>
<p>Le tableau derri√®re cette matrice est rang√© sous forme d'<em>array</em> dans mon code mais il peut √™tre utile de l'avoir en Excel pour visualiser et le manipuler plus facilement pour les clients.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Cliquez pour afficher la fonction de cr√©ation du tableau Excel</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-python line-numbers"><code>

def convert_excel (matrice, chemin_fichier) :
    """ Permet d'enregistrer une matrice dans un tableau Excel.

        Param√®tre
        ---------
        matrice : np.array
            Matrice Rainflow avec en premi√®re colonne
            et en premi√®re ligne les √©chelles.

        Return
        ------
        None
    """
    # Cr√©er un nouveau classeur Excel :
    classeur = openpyxl.Workbook()
    feuille = classeur.active

    # Parcourir la matrice et ins√©rer les valeurs dans les cellules :
    for i, ligne in enumerate(matrice):

        for j, valeur in enumerate(ligne):
            if i > 0 or j > 0 :
                cellule = feuille.cell(row=i+3, column=j+3)
                cellule.value = valeur
                if i == 0 or j == 0 :
                    cellule.font = Font(bold=True)
    classeur.save(chemin_fichier)


</code></pre></div>
</details>
</div>
<p>On obtient alors le tableau Excel suivant :</p>
<p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Ouzoulias-Nicolas/mon/temps-1.2/matrice_excel1.png" alt="matrice Excel 1"></p>
<p>Afin de le rendre plus visuel nous allons recr√©er une mise en page conditionnelle afin de recr√©er la matrice color√©e obtenue sur Python.</p>
<div class="relative drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-indigo-500 bg-indigo-100 cursor-pointer select-none dark:border-indigo-800 dark:bg-indigo-950">
<details class="group">
<summary class="list-none py-0.5">
<svg class="group-open:hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path>
</svg>
<svg class="group-open:block hidden absolute w-7 h-7 pl-1 pt-0.5 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
</svg>
<div class="pl-8 font-bold inline-block group-open:select-text">
<p>Cliquez pour afficher la fonction de cr√©ation du tableau Excel avec la mise en page conditionnelle</p>
</div>
<svg class="group-open:hidden inline-block pl-3 w-10 fill-none stroke-2 stroke-indigo-500 dark:stroke-indigo-800" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path>
</svg>
</summary>
<div class="mx-8 pb-2 cursor-auto select-text">
<pre class="language-python line-numbers"><code>

def convert_excel (matrice,chemin_fichier) :
    """ Permet d'enregistrer une matrice dans un tableau Excel.

        Param√®tre
        ---------
        matrice : np.array
            Matrice Rainflow 'Amplitude-Moyenne' avec en premi√®re colonne
            et en premi√®re ligne les √©chelles.

        Return
        ------
        None
    """
    # Cr√©er un nouveau classeur Excel :
    classeur = openpyxl.Workbook()

    feuille = classeur.active
    liste_nbr_cycles = []
    # Parcourir la matrice et ins√©rer les valeurs dans les cellules :
    for i, ligne in enumerate(matrice):

        for j, valeur in enumerate(ligne):
            if i > 0 or j > 0 :
                cellule = feuille.cell(row=i+3, column=j+3)
                cellule.value = valeur
                liste_nbr_cycles.append(valeur)
                if i == 0 or j == 0 :
                    cellule.font = Font(bold=True)

                if valeur == 0 :
                    cellule.value = 0

    max_nbr_cycles = max(liste_nbr_cycles)

    for i, ligne in enumerate(matrice):

        for j, valeur in enumerate(ligne):
            if i > 0 or j > 0 :
                cellule = feuille.cell(row=i+3, column=j+3)
                cellule.alignment = Alignment(horizontal = "center", vertical = "center")
                if valeur >= 0.9*max_nbr_cycles :
                    cellule.fill=PatternFill("solid", start_color="CC160C")
                elif valeur<0.9*max_nbr_cycles and valeur>=0.5*max_nbr_cycles :
                    cellule.fill=PatternFill("solid", start_color="CC730C")
                elif valeur<0.5*max_nbr_cycles and valeur>=0.2*max_nbr_cycles :
                    cellule.fill=PatternFill("solid", start_color="E3DF07")
                elif valeur<0.2*max_nbr_cycles and valeur>0 :
                    cellule.fill=PatternFill("solid", start_color="A1E00D")
                else :
                    cellule.fill=PatternFill("solid", start_color="00FF1B")

                if i == 0 or j == 0 :
                    cellule.fill=PatternFill("solid", start_color="919191")

    classeur.save(chemin_fichier)


</code></pre></div>
</details>
</div>
<p><img src="https://raw.githubusercontent.com/do-it-ecm/promo-2023-2024/refs/heads/main//Ouzoulias-Nicolas/mon/temps-1.2/matrice_excel2.png" alt="matrice Excel 2"></p>
<h2 id="iv.-conclusion" tabindex="-1"><a class="header-anchor" href="#iv.-conclusion"></a> IV. Conclusion</h2>
<p>A travers ce MON j'ai pu mieux comprendre la biblioth√®que <em>openpyxl</em> de Python et ainsi √™tre plus apte √† utilier facilement ce langage pour automatiser les tableaux Excel qui sont extr√™mement pr√©sents dans le monde professionel.</p>
<p>J'en ai profit√© pour am√©liorer le code de mon pr√©c√©dent stage et plonger plus en d√©tail dans l'affichage des r√©sultats.</p>
<h3 id="sources" tabindex="-1"><a class="header-anchor" href="#sources"></a> Sources</h3>
<ul>
<li><em>OpenPyxl - a Python library to read/write Excel 2010 xLsx/xlsm files ‚Äî OpenPyXl 3.1.2 documentation</em>. <a href="https://openpyxl.readthedocs.io/en/stable/">https://openpyxl.readthedocs.io/en/stable/</a></li>
<li><em>Automate the boring stuff with Python</em>. <a href="https://automatetheboringstuff.com/2e/chapter13/">https://automatetheboringstuff.com/2e/chapter13/</a></li>
</ul>



</article>

        </main>

        <footer class="min-h-[50px] border-t-2 mt-4 border-gray-200 dark:border-neutral-700">
            <div class="max-w-[1000px] mx-auto px-4">
                <div class="min-h-[50px] flex justify-center items-center">
                    <p class="text-center">
                        ¬©2025 <b><span style="font-family: Consolas, sans-serif;">Do-<span style="color: #4a86e8">It</span></span></b> - D√©veloppement, Management et Gestion de projets en IT
                    </p>
                </div>
            </div>
        </footer>

        <!-- MathJax import and initialization -->
        <script src="https://cdn.jsdelivr.net/npm/mathjax/es5/tex-svg-full.js" defer="">
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']], // Delimiters for inline math
                    displayMath: [['$$', '$$'], ['\\[', '\\]']] // Delimiters for block math
                },
                svg: {
                    fontCache: 'global' // Use global font cache for SVG output
                }
            };
            document.addEventListener('DOMContentLoaded', () => {
                MathJax.typeset(); // Ensures MathJax processes the content after the page loads
            });
        </script>

        <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/normalize-whitespace/prism-normalize-whitespace.min.js">
            Prism.plugins.NormalizeWhitespace.setDefaults({
                'remove-trailing': true,
                'remove-indent': true,
                'left-trim': true,
                'right-trim': true,
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/show-language/prism-show-language.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs/plugins/autoloader/prism-autoloader.min.js"></script>
    </body>
</html>
